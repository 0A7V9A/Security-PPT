Enterprise Vulnerability Management
Alexander Leonov, Ekaterina Pukhareva, Alex Smirnoff

Content
1. A variety of Vulnerability Scanners 2. Experience in the use of Tenable SecurityCenter and Nessus 3. How to make an efficient vulnerability management? 4. Vulnerability Scanner as a valuable asset 5. Beyond scanners

A variety of Vulnerability Scanners

A variety of Vulnerability Scanners
Some problems
· When the scan is finished, the results may already be outdated · False positives · Per-host licensing
Knowledge base · How quickly vendor adds new vulnerability checks? · No scanners will find all vulnerabilities of any software · Some vulnerabilities may be found only with authorization or
correct service banner · You will never know real limitations of the product

A variety of Vulnerability Scanners
Nessus vs. Openvas
All CVEs: 80196 Nessus CVE links: 35032 OpenVAS CVE links: 29240 OpenVAS vs. Nessus: 3787;25453;9579

A variety of Vulnerability Scanners
Nessus vs. Openvas

2673 OpenVAS plugins

All CVEs: 80196 Nessus CVE links: 35032 OpenVAS CVE links: 29240 OpenVAS vs. Nessus: 3787;25453;9579
All NASL plugins: OpenVAS: 49747 Nessus: 81349

38207 OpenVAS plugins and 50896 Nessus plugins 6639 Nessus plugins

Why?
· Old ul era ilities · Vendor forgot to add links to CVE id · Vulnerabilities in plugins (N: WordPress VideoWhisper) · Do 't support Lo al soft are N: ope Mairie · Stopped adding new vulnerabilities (N: vBulletin, O: Solaris)

In other words
·Vulnerability Scanner is a necessity ·Don't depend too much on them ·Scanner does not detect some vulnerability --
it's YOUR problem not your VM vendor ·Choose VM solution you can control ·Have alternative sources of Vulnerability Data (vulners.com, vFeed)

Sometimes a free service detects better

Vulners Linux Audit GUI
· Linux OS vulnerability scan · Immediate results · Dramatically simple https://vulners.com/#audit

Vulners Linux Audit GUI
·RedHat ·CentOS ·Fedora ·Oracle Linux ·Ubuntu ·Debian

Vulners Linux Audit API

curl -H "Accept: application/json" -H "Content-Type: application/json" -X

POST -d '{"os":"centos","package":["pcre-8.32-15.el7.x86_64", "samba-

common-4.2.3-11.el7_2.noarch", "gnu-free-fonts-common-20120503-

8.el7.noarch", "libreport-centos-2.1.11-32.el7.centos.x86_64", "libacl-

2.2.51-12.el7.x86_64"],"version":"7"}' https://vulners.com/api/v3/audit/audit

+ Agent Scanner

Experience in the use of Tenable SecurityCenter and Nessus
Architecture

Experience in the use of Tenable SecurityCenter and Nessus
Architecture

Experience in the use of Tenable SecurityCenter and Nessus

· Fixing · Accepting risks

Scan:

Discovery

· External and Internal

Finding a live host perimeters

Remediation Fix the problem

Assessment What assets?

· What time for fixing?

Analysis

· Risks?

What to fix first?

Scan for specific assets:
· Workstations, Network Servers
· What CVSS score?

Experience in the use of Tenable SecurityCenter and Nessus
Reporting and dashboards

Experience in the use of Tenable SecurityCenter and Nessus
Compliance checks
Checking the PCI DSS requirements and others
Nessus .audit files (built-in or highly customized plug-ins)
- Operation systems (SSH, password policy, local accounts, audit, etc.)
- Databases (privileges, login expiration check, etc.)
- Network devices (SSH, SNMP, service finger is disable, etc.)
- Etc.

Custom VM Reporting
Graphs: · MS Critical + Exploitable · MS Critical · MS Other · Windows Software
Tables: · Legend
· Top vulnerable hosts · Top vulnerabilities

Experience in the use of Tenable SecurityCenter and Nessus
Homemade Ticketing

Experience in the use of Tenable SecurityCenter and Nessus
Usage Problems
 Scanners updating by scripts  New plugins  Log-management and monitoring  Harmless pentest  FalsePositive  Authentication Failure

Nessus Agents

Vulnerability Scanner as a valuable asset
Dangerous audit file

Vulnerability Scanner as a valuable asset
Monitoring
Domain + two-factor authentication Role model in SecCenter
Monitoring of using nessus account

Restricting Nessus permissions
Not officially supported May stop working anytime More like security through obscurity rather than efficient protection

Defaults:scanaccount !requiretty Cmnd_Alias NESSUSAA = /bin/sh -c echo nessus_su_`echo [09]*[0-9]` ; *; echo nessus_su_`echo [0-9]*[0-9]` Cmnd_Alias NESSUSXA = ! /bin/sh -c echo nessus_su_`echo [09]*[0-9]` ; *;*; echo nessus_su_`echo [0-9]*[0-9]` Cmnd_Alias NESSUSXB = ! /bin/sh -c echo nessus_su_`echo [09]*;*[0-9]` ; *; echo nessus_su_`echo [0-9]*[0-9]` Cmnd_Alias NESSUSXC = ! /bin/sh -c echo nessus_su_`echo [09]*[0-9]` ; *; echo nessus_su_`echo [0-9]*;*[0-9]` scanaccount ALL = (root) NESSUSAA, NESSUSXA, NESSUSXB, NESSUSXC

What is still wrong
(from NopSec "2016 Outlook: Vulnerability Risk Management and Remediation Trends")

..a d hat's e o d ul era ilit s a i g?
Risk management? Asset management? Threat intelligence? Detecting scanning gaps?
Do ou reall eed e pe si e state of the art solutio ?

There is an alternative
For pentesters
For splunk, big data and fancy tech HUBBLESTACK.IO
For the rest of us

Simple as that
Import all you scans data to the database ..do anything you want!
Monitor changes, create scopes, custom reports, whatever Avoid VM vendor lock-in

Use case: asset management
We do not have critical asset inventory! Wait.. e do. It is alled o itori g Use zabbix data to create asset lists Push back alerts to zabbix

Use case: advanced risk management
Create exploit capabilities description (CVSS sucks!) Add environment data (internal and external scans at least) Add anything you want (threat intel)
No part is mandatory!

