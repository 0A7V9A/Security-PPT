SESSION ID: SEM-M03B
Ransomware spread through various distribution methods from 2018 to 2019
Jin Wook Kim
Team Leader C ERT, W INSCo ., LTD? .      . dm98max@wins21.co.kr

#RSAC

#RSAC
About WINS
         ,  2018~2019,.. .. Wins20182019

#RSAC
Profile of Speaker
Jin Wook Kim | CERT | WINS
· Incident Response, Advanced Threat Hunting, Security Solution Management · Consult of Security strategy, Security Monitoring System Development/Management · Vulnerability/Malware Analysis
          . WINS CERT·
3

#RSAC
Contents of List
Ransomware trends for 2018-2019
1. 2018-2019 Major Malware of Ransom 2. 2018-2019 Major Distribution Methods
2018-2019 result of study for ransomware
1. 2018-2019 Major Vulnerabilities using Attacker 2. Social Network Phishing
Information protection in case of incidents
1. GandCrab v1.0 ­ v5.0 2. How can we prevent the various methods of spread for ransomware ? 3. Block ransomware distribution and activity detection using patterns
How should we do prevent attacks without knowledge about the unknown attacks?
     ,   , ,....,.? . 2....? 
4

#RSAC
One of the Cases to Bypass Security (Hoax)
 2018HoaxHoax'.     '    . 2018'HoHaoxax'
5

#RSAC
The great and expensive security system doesn't notice this at all
      ,            ..?.   . 2?
6

#RSAC
Depend on who manages the Security Solution
10 0 ,, ..   . 100
7

#RSAC
Why don't we try to be an expert?
  ,   .?.  . ?
8

#RSAC
Ransomware trends for 2018-2019
· 2018-2019 Major Malware of Ransom · 2018-2019 Major Distribution Methods
,   2018 2019    . 20182019

#RSAC
2018-2019 Major Malware of Ransom

Spreads of worldwide

Malware Status by Country
South Korea has most of
cerber.

WorldWide China South Korea

China has

most of

Far-East-Asia

GlobeImposter.

has most of

      Gand C rab  GandwCra anbnacry35%., ., . .

World wide resource : Kaspersky 2018-2019 report

KerbeGwraanndnCacraryb35%SouthKoreaandChina resource : WINS

10

#RSAC
2018-2019 Major Distribution Methods
Various Spread Methods of Ransomware
Network Worm AD Malvertising USB and Removable Media Vulnerability exploit Supply-chain-attack Weakness Password
RaaS Drive-By Downloads
RDP Leak Phishing Email
Amount of the ransomware
         D Arcitvieveb-yXDownloadSouthKorSecannerChinaW o rld , WideW.orld.wideresource: Kaspersky2.018-2019 re.port
Active-XDrivebyDownlSocadannerSouthKoreaandChinaresource:WINS
11

#RSAC
2018-2019 the case of the study for ransomware
· 2018-2019 Major Vulnerabilities · Social Network Phishing
       . 

#RSAC
2018-2019 Major Vulnerabilities using Attacker

No

CVE-ID

1 CVE-2017-12149

Vendor/Product Red Hat Jboss

#Lucky #XMRig #Satan

Malware

2

CVE-2010-0738

Red Hat Jboss #Lucky #XMRig #Satan

3

CVE-2015-7501

Red Hat JBoss #Lucky #XMRig #Satan

4 CVE-2017-10271 Oracle WebLogic #MONEROMINER #MIMIKATZ #Lucky

5

CVE-2018-2894

Oracle WebLogic #xmrig #BillGates ddos malware

6

CVE-2019-2725

Oracle WebLogic #Sodinokibi #GandCrab

7

CVE-2017-0146

MS Windows

#WannaCry

8

CVE-2018-8174

MS Windows

#APT10 #Stone Panda #REDLEAVES #UPPERCUT/ANEL #CHCHES

9

CVE-2018-8453

MS Windows

#Sodin #RaaS

10 CVE-2018-4878 Adobe Flash Player #Rig Exploit Kit #GandCrab #Paradise

11 CVE-2018-1273

Pivotal Spring #Satan #Lucky

R1D2   P     , ExC pVloE i-t2 ,0La1n9.d-3in3g96,AtlEaxspSslNioaSintkCitonfluen,ScNeS#,ACE&SCDD,o.S#GandCrab,..  
RSDcPanExploitLandingWebSENxpSloitkitSNS,C&C
13

#RSAC
Social Network Phishing
Which person is the hacker? Do you guess?
Facebook.. . Facebook"
14

#RSAC
Social Network Phishing

Approached by SNS account using a beautiful profile photo.

Make a relationship on Twitter, Facebook wit h someone like CEO, Public officer.

They used to upload gossip, entertainment ne ws for a long time for the trust to guys.

Finally, the attacker sends a message containi

ESTsecurity (https://blog.alyac.co.kr/)

ng a malicious link to the people registered in

his or her contacts.

Each profile and each picture but same Background

20  18           URL/.,RGB. .. . 2"018URL/RGB
15

Social Network Phishing
RGB(Reconnaissance Bureau of the General S taff Department of North Korea) was active o nly at a specific meeting through Facebook, u sing a profile picture of beauty. Also, the North Korean group a community of computer security experts in Korea and maint ains Facebook friends with some representati ves of Korean security companies.
ESTsecurity (https://blog.alyac.co.kr/)
, Sendsm. alwaretofacebook friends

16

#RSAC

#RSAC
Social Network Phishing

RGB(Reconnaissance Bureau of the General S taff Department of North Korea) was active o nly at a specific meeting through Facebook, u sing a profile picture of beauty.
Also, the North Korean group a community of computer security experts in Korea and maint ains Facebook friends with some representati ves of Korean security companies.
Also, a method of spreading malicious code t o unspecified persons, SNS phishing accounts are used, which invariably encourages users t o download applications and has a short acco unt creation cycle.

Not Korean ISP

         .

ESTsecurity (https://blog.alyac.co.kr/)

FacebookFacebookApplicationHacker

17

#RSAC
Social Network Phishing

RGB(Reconnaissance Bureau of the General S taff Department of North Korea) was active o nly at a specific meeting through Facebook, u sing a profile picture of a beauty.
Also RGB(Reconnaissance Bureau of the Gene ral Staff Department of North Korea) joins th e community of computer security experts in Korea and maintains Facebook friends with so me representatives of Korean security compa nies.
Also, a method of spreading malicious code to unspecified persons, SNS phishing accounts are used, which invariably encourages users to download applications and has a short account creation cycle.

Post a malicious App

        ,  .
ESTsecurity (https://blog.alyac.co.kr/)
ApHpalickaetironGoogleFacebookApplication
18

#RSAC
Information protection in case of incidents
· GandCrab v1.0 ­ v5.0 · How can we prevent the various methods of spread for
ransomware ?    ·Bloc1kranso5mwaredistributionandactivitydetectio.n . GandCrabusingpatterns15

#RSAC
GandCrab v 1.0 attack to Europe
Phishing E-mail with GandCrab v1.0 Subject : Receipt Feb-21310 Contents : DOC Attached
https://research.checkpoint.com/gandcrab-ransomware-mindset/
GandCrab           . GandCrab
20

#RSAC
GandCrab Ransomware VS South Korea Vaccine App
Ahnlab released anti gandcrab tool
        .. Ahnlab Anti-VirusGandCrab
21

#RSAC
GandCrab Ransomware VS South Korea Vaccine App
Ahnlab released anti gandcrab tool
Hey ahnlab, score ­ 1:1, 0day exploit for Ahnlab V3 Lite Denial of service.
     V3          .
AhnlabV3
22

#RSAC
Spreads of GandCrab ransomware in S.Korea
Attacker Using Vulnerability Exploit
 GandCrab       . GandCrab
23

GandCrab Ransomware spreads by through

#RSAC

RIG exploit Kit

Rig Exploit Kit 3.0 (Feb. 2018)

Adobe Flash Player Exploit CVE-2018-4878 CVE-2015-8651

  , AdobeRFiglaEsxhpPlolaityeKrit3.0Adobe .  . Adobe FlashPlRaiygeErxploit KGita3n.d0CrabAdobe
24

#RSAC
Spreads of GandCrab ransomware in S.Korea
Attacker Using Phishing E-mail
      . .
25

#RSAC
Phishing E-mail spreads to South Korea with 2.0

Fake Copyright infringement about design (Mar 2018)

JPG and Doc Fake Extension with LNK

Develop 2.0 using 2016's Venus Locker code
http://blog.alyac.co.kr/1601?category=957259
  2.0.  . 2.0VenusLocker
26

#RSAC
Phishing E-mail spreads to South Korea with 3.0

Fake Copyright infringement about design (May 2018)

JPG and Doc Fake Extension with LNK

Hide the malware file(who.exe)

3.0, , (LNK)         . DesktopLN3K.0
27

#RSAC
Spreads of GandCrab ransomware in S.Korea
Attacker Using Web Drive by Download
  Drive-By-Download       . Drive-By-Download
28

#RSAC
Web Drive-by Download & Attacker's Server
· First, Hacker hacked weak web server · Then, modified original php code · Additionally, injected arbitrary php code(via
download malware from attacker server) · Finally, users could head original web page
after downloaded malware.
DBD(Drive-By-Download)            .
Drive-By-Download 
29

#RSAC
Web Drive-by Download & Attacker's Server
Hacker Distributed Ransomware by hacked Server via Oracle's exploit (Nov 2018)
2018http://www.wins21.co.Okrr/ablcolge/blog-main.html,    . 2018Oracle
30

#RSAC
Download v4.0 web faked as Crack Software
Victim found in the Google web search about "Crack merging image to pdf" (Jul 2018)
The normal website was already hacked, and there had a potential threat.
    4.0. . GandCrab4.0phishing
31

#RSAC
Download v4.0 web faked as Crack Software
Victim found in the Google web search about "Crack merging image to pdf" (Jul 2018)
The malicious link in Normal Web page
     . GoogleMMeregrimgimgg
32

#RSAC
Download v4.0 web faked as `North Korea Font file'
Victim found in the Google web search about "North Korea Font download" (Jul 2018)
The normal website was already hacked, and there had a potential threat.
        FONTWeb
33

#RSAC
Download v4.0 web faked as `North Korea Font file'
Victim found in the Google web search about "North Korea Font download" (Jul 2018)
The malicious link in Normal Web page
   . 
34

#RSAC
Download v5.0 web faked as `Free PPT Templete'
Victim found in the Google web search about "Free PPT Templete" (Nov 2018) ( Left : Nov 2018 Right : Jul 2018 )
PPT , 2018 ,. PPT2018
35

#RSAC
Download v5.0 web faked as `Free PPT Templete'
Victim found in the Google web search about "Free PPT Templete" (Nov 2018)
5 malicious link in Normal Web page(Only one malicious Link in the past )
,              . 
36

#RSAC
2019 Lastest update release GandCrab
Hackers are scanning for MySQL servers to deploy GandCrab ransomware (The open directory is hosted using HFS, with a Chinese user interface)
Deliver GandCrab to an international company based in Japan. (The payload fetched from pastebin.com is a COM scriptlet containing obfuscated JavaScript code)
paste,binMySQLC&CC&C.  . GandCpraabstebinMySQLC&C&CC
37

#RSAC
Various Methods of spread for ransomware
How can we prevent the various methods of spread for ransomware ?
          IPS.    . IPS
38

How can we prevent the various methods of spread for #RSAC ransomware ?
 Gathering Cyber Threat Information
gandcrab ioc
 IoC, ,MD5 ,PSCha256,inurl:p.aten(bin).     . IoCMD5ShaG25o6ogleGoogleinurlpatenbin
39

How can we prevent the various methods of spread for #RSAC ransomware ?
 Gathering Cyber Threat Information Searching Result : 8,800 (0.39s)
  IOC(Indicatorof compromise),4IP88002. URL, . GandCrabIOC(Indicatorofc4omproIPmise)2URL8800
40

How can we prevent the various methods of spread for #RSAC ransomware ?
· Malware information
· OSINT
· Cyber Threat Intelligence Portal
       .  . 
41

How can we prevent the various methods of spread for #RSAC ransomware ?
 Tracing cyber threat intelligence
GandCrab C2 GandCrab C2 GandCrab C2 GandCrab C2 GandCrab C2
Tracing C&C IP
    ,        IPIPS. ?.   . GoogleIPIPS? 
42

How can we prevent the various methods of spread for #RSAC ransomware ?
 Detect network traffic that infection clients try to connect c&c server
IPS     HTTPMeHtThToPdGGIFETmethod..POSTMet.hod. . IPSHTTPHTTPMetGhIoFdGETmethodPOSTMethod 
43

How can we prevent the various methods of spread for #RSAC ransomware ?
 Detect network traffic that infection clients try to connect c&c server

Malicious Traffic

Normal Traffic

   GIFC&C~, ... GIFC&C
44

How can we prevent the various methods of spread for #RSAC ransomware ?
 Detect network traffic that infection clients try to connect c&c server
Infected PC A
(xxx.xxx.71.93)
C&C (Attacker's 95.211.144.65)
    PC   . 
45

How can we prevent the various methods of spread for #RSAC ransomware ?
 Detect network traffic that infection clients try to connect c&c server

Infected PC A
(xxx.xxx.71.93)
Infected PC B
(xxx.xxx.5.224)

C&C (Attacker's 95.211.144.65)
46

How can we prevent the various methods of spread for #RSAC ransomware ?
 Detect network traffic that infection clients try to connect c&c server

Infected PC A
(xxx.xxx.71.93)

Infected PC B
(xxx.xxx.5.224)

C&C (Attacker's 95.211.144.65)

Infected PC C
 3 (xxx.xxx.150.34)   .
3
47

How can we prevent the various methods of spread for #RSAC ransomware ?
 Found new c&c Server through internal victim pc traffic
    . 
48

How can we prevent the various methods of spread for #RSAC ransomware ?
 Tracing Internal Infected PC traffic
Infected Client Infected Client Infected Client Infected Client Infected Client
Tracing Internal Infected PC traffic
IPPC.     . PCIP
49

How can we prevent the various methods of spread for #RSAC ransomware ?
 Found new c&c Server through internal victim pc traffic

C&C (81.19.145.153)

Infected PC D
(xxx.xxx.57.98)

C&C (65.254.227.224) C&C (210.245.8.110) C&C (72.10.32.113)

50

How can we prevent the various methods of spread for #RSAC ransomware ?
 Found new c&c Server through internal victim pc traffic

C&C (81.19.145.153)

C&C (65.254.227.224)

Infected PC D
(xxx.xxx.57.98)

C&C (210.245.8.110)

Infected PC E
(xxx.xxx.91.176)

C&C (72.10.32.113)

     C&C    .

C&C (69.65.3.197)

C&C

51

#RSAC
Various Methods of spread for ransomware
Block ransomware distribution and activity detection using patterns
      ,    . 
52

Block ransomware distribution and activity detection #RSAC using patterns
 Raw data(encryption data) of c&c connection traffic
        . . . 
53

Block ransomware distribution and activity detection #RSAC using patterns
 Raw data(encryption data) of c&c connection traffic
54

Block ransomware distribution and activity detection #RSAC using patterns
 Raw data(encryption data) of c&c connection traffic
55

Block ransomware distribution and activity detection #RSAC using patterns
 Raw data(encryption data) of c&c connection traffic
C& C   , . . C&C
56

Block ransomware distribution and activity detection #RSAC using patterns
 Common payload of Raw data(encryption data) of c&c connection traffic
              .

57

Block ransomware distribution and activity detection #RSAC using patterns
 Common payload of Raw data(encryption data) of c&c connection traffic alert tcp any any -> any any (msg:"Win32/Ransomware.GandCrab.Connection"; content:"wfKD6iudumBkmpL8IRr4"; nocase; content:"D8|2F|bFAv|2F|9m"; distance:0; )
 ,2018SnortGandCrab1. 4.  . 2018SnoGratndCrab14
58

Block ransomware distribution and activity detection #RSAC using patterns
 Write a patterns from Common payload of Raw data(encryption data) of c&c connection traffic
    Anti-Virus ()         .
Anti-Virus
59

Actionable IPS       

Recommendations

#RSAC

Perform tasks every week

Perform tasks every day

       /  .     . /

#RSAC
Thank You
61

Reference
http://www.360.cn/n/10567.html https://securelist.com/it-threat-evolution-q2-2018-statistics/87170/ https://www.freebuf.com/articles/paper/194182.html https://blog.alyac.co.kr/2046 https://www.krcert.or.kr/main.do http://www.wins21.co.kr/blog/blog-search.html?find_word=%EB%9E%9C%EC%84%AC https://threatpost.com/top-iphone-supplier-battles-wannacry-infection/134722/ https://thehackernews.com/2018/12/china-ransomware-wechat.html https://www.us-cert.gov/ncas/alerts/AA18-337A [CVE-2019-3396] http://www.wins21.co.kr/blog/blog-sub-01.html?t=31&num=1387
62

#RSAC

