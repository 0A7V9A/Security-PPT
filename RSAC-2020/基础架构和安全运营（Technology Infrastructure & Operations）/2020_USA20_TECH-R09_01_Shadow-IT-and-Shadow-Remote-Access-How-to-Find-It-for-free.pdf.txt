SESSION ID: TECH-R09
Shadow IT and Shadow Remote Access. How to Find It (for free!)

John Strand
Owner Black Hills Information Security @strandjs

#RSAC

#RSAC
Goals
Changes in the vulnerability management landscape The explosion of IoT and what it means to findings shadow IP access Shadow IT attack case studies How to start hunting at scale For free

Presenter's Company

Logo ­ replace or

delete on master slide

2

#RSAC
Changes in Vulnerability Management

We are all real good at fighting security issues of 5-10 years ago
­ Development lead time
­ Management fighting the same things as when they were in the trenches
­ It is "easier"

· Somehow, we stopped well before we should have

Presenter's Company

Logo ­ replace or

delete on master slide

3

#RSAC
Quick Question...

Presenter's Company

Logo ­ replace or

delete on master slide

4

#RSAC
Quick Question...

Presenter's Company

Logo ­ replace or

delete on master slide

5

#RSAC
Far Beyond the Scope of this Presentation...
We need to move beyond simple patch and configuration checks We need to get to threat emulation We need to look at lateral movement We need to focus on post-exploitation We need to do all this some other time Shadow IT...

Presenter's Company

Logo ­ replace or

delete on master slide

6

#RSAC
Egypt, Beau, Joff and my Fridge...

Presenter's Company

Logo ­ replace or

delete on master slide

7

Egypt, Beau, Joff and my Fridge...
No! No!

#RSAC
No!

Presenter's Company

Logo ­ replace or

delete on master slide

8

#RSAC
IoT Case Study: Teamviewer

Presenter's Company

Logo ­ replace or

delete on master slide

9

#RSAC
IoT Case Study: Nuance

Presenter's Company

Logo ­ replace or

delete on master slide

10

#RSAC
IoT Case Study: Hospital in Wyoming

Presenter's Company

Logo ­ replace or

delete on master slide

11

#RSAC
Not.....

Presenter's Company

Logo ­ replace or

delete on master slide

12

#RSAC
An Exception..

Presenter's Company

Logo ­ replace or

delete on master slide

13

#RSAC
Tshark Hunting

Presenter's Company

Logo ­ replace or

delete on master slide

14

#RSAC
Wireshark

Presenter's Company

Logo ­ replace or

delete on master slide

15

#RSAC
Using R

Presenter's Company

Logo ­ replace or

delete on master slide

16

#RSAC
Zeek and User Agent Strings

Presenter's Company

Logo ­ replace or

delete on master slide

17

#RSAC
Real Intelligence Threat Analytics
Finds patterns in large-scale network traffic
­ Well over one Terabyte at a time
Specifically looks for beacons Also, Blacklist checking, DNS views, Long Connections All for free Check it out! https://github.com/activecm/rita

Presenter's Company

Logo ­ replace or

delete on master slide

18

#RSAC
Math!

Presenter's Company

Logo ­ replace or

delete on master slide

19

#RSAC
RITA and Long Connections

Presenter's Company

Logo ­ replace or

delete on master slide

20

#RSAC
RITA and Beacons

Presenter's Company

Logo ­ replace or

delete on master slide

21

#RSAC
Apply!

IoT is exploding

This is actually a compliance requirement
­ NIST 800, CSC, etc.

Start hunting rogue IT

Many tools to use
­ Tshark, R, RITA, Zeek

· Low leval of technical skill required

· However, a high level of curiosity is required

Presenter's Company

Logo ­ replace or

delete on master slide

22

#RSAC
Process
Just as we started with vulnerability management
­ Monthly or quarterly then continuous
The first few times will serve as house cleaning
­ Identify: Beacons, IoT, old operating systems, remote access, DNS misconfigurations, video streaming, browser-based bitcoin mining, etc.
Move towards automated and ongoing anomaly analysis All anomaly analysis requires a clean baseline

Presenter's Company

Logo ­ replace or

delete on master slide

23

Thanks!
Questions?

Presenter's Company

Logo ­ replace or

delete on master slide

24

#RSAC

