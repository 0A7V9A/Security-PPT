SESSION ID: MBS2-W02
Building a Comprehensive IoT Security Testing Methodology

Deral Heiland
IoT Research Lead Rapid7 deral_heiland@rapid7.com @percent_x

#RSAC

#RSAC
The Ecosystem of an IoT Product

#RSAC
What is the Internet of Things (IoT)
3

#RSAC
IoT Ecosystem
· Embedded Hardware · Management & Control Application · Cloud Service APIs and Storage
4

IoT Ecosystem

#RSAC
· Understanding the holistic structure · Help with threat modeling · Understand related security impact · Facilitate security testing
5

#RSAC
IoT Security Testing Methodology Structure

#RSAC
Security Testing Methodology Structure
· 4 key phases
­ Functional ­ Reconnaissance ­ Testing ­ Analysis
· All components of the ecosystem · Focused team
7

#RSAC
Security Testing Methodology Structure

Functional Evaluation

Reconnaissance

Analyzing 8

Testing

#RSAC
Functional Evaluation Phase

Functional Evaluation

Reconnaissance

Analyzing 9

Testing

Functional Evaluation

#RSAC
· Standard setup & deployment · Goal: Understanding IoT product
­ Map out
· Feature · Functions · Components · Communication paths

10

#RSAC
Reconnaissance Phase

Functional Evaluation

Reconnaissance

Analyzing 11

Testing

#RSAC
Reconnaissance
· Open Source Intelligence
­ FCC ID ­ User Manuals ­ Electronic component datasheets ­ Product history ­ CVEs ­ Electronic component vulnerabilities
· Vendor supplied data
12

Testing Phase
Functional Evaluation

Reconnaissance

#RSAC

Analyzing 13

Testing

#RSAC
Cloud & Web API Testing
· Vulnerability testing
­ OWASP top 10 ­ Injection attacks ­ Business logic attacks
· Functional validation
­ Encryption ­ Authentication ­ Session management
· Ecosystem impact
14

#RSAC
Management & Control Application Testing
· Vulnerability · Encryption · Authentication · Data management · Ecosystem impact
15

#RSAC
Network Testing
· Vulnerabilities · Exposed services · Encryption · Ecosystem impact
16

#RSAC
Embedded Hardware Testing
· Chip sets · Physical ports · Debugger access · Access Security
­ Memory extraction ­ Side Channel attacks ­ Inter Chip communication
· Ecosystem impact
17

#RSAC
Firmware Analysis Testing
· Hardcoded default passwords · Encryption keys · Undocumented commands · Hardcoded IP addresses of interest · Hardcoded URLs of interest · Ecosystem impact
18

#RSAC
Radio (RF) Testing
· Protocol versions · Encryption · Pairing processes · Access control · Replay attacks · Ecosystem impact
19

Analysis Phase
Functional Evaluation

Reconnaissance

#RSAC

Analyzing 20

Testing

Analysis

#RSAC
· Security
­ Confidentiality ­ Integrity ­ Availability
· Ecosystem components · Build further testing concepts
21

#RSAC
Security Testing Methodology Structure

Functional Evaluation

Reconnaissance

Analyzing 22

Testing

#RSAC
Applied Methodology & Testing Examples

#RSAC
Enterprise IoT Sensor Technology
24

#RSAC
Embedded Hardware
25

#RSAC
Reconnaissance

Embedded Hardware
27

#RSAC
X

#RSAC
Embedded Hardware
28

#RSAC
Firmware
29

#RSAC
Firmware
30

#RSAC
Consumer Smart Door Lock
Smart Lock
31

#RSAC
Functional Evaluation
· Map out
· Feature · Functions · Components · Communication paths
32

#RSAC
Consumer Smart Door Lock

Mobile Application

Man in the middle proxy intercept
33

Cloud API Services
Web APIs

#RSAC
Consumer Smart Door Lock APIs
· Access features
­ Timed access control ­ Email access invite
· Analysis · Failures
­ Excessive information returned ­ Weak API access security
34

#RSAC
Consumer Smart Door Lock APIs
35

#RSAC
Consumer Smart Door Lock APIs
36

#RSAC
Consumer Smart Door Lock APIs
37

#RSAC
IoT Testing
Building out the Needed Skills and Lab

#RSAC
Basic Entry Level Testing Skills
· Proficient skills
­ Mobile application
· Android · iOS
­ Web service and API ­ Network ­ WiFi
· Endless desire to learn
39

#RSAC
Basic Embedded Testing Lab
· Flash memory readers · Soldering tools · In circuit analysis tools · Magnifiers · Hand tools · A budget for what you don't
know you need yet
40

#RSAC
Training and Exposure
41

#RSAC
How to move forward
Applying IoT ecosystem testing methodologies

#RSAC
Manufactures of IoT
· Implement a product security testing program
­ Internal ­ External ­ Before and after go to market
· Ensure testing is focused across full ecosystem
­ Avoid fragmented testing
· Personnel · Ecosystem
43

#RSAC
Enterprise Consumers of IoT
· Ask questions before buying
­ Do you test products for security?
· How? · Who? · Can you prove it?
· Inventory current deployed IoT
­ Follow up with manufacturer on product history
­ Conduct security testing
· Internal (limited resources) · External (cost versus risk)
44

#RSAC
IoT Security Researchers and IoT testers
· Follow a structured methodology approach
· Always consider ecosystem component interactions
· Expand skill level across all components
45

#RSAC
Questions
DERAL HEILAND
Deral_heiland@rapid7.com @Percent_X
46

