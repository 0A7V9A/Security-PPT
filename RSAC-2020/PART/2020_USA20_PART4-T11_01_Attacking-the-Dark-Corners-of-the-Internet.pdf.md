SESSION ID: PART4-T11
Attacking The Dark Corners of The Internet

Yaniv Balmas
Head Of Cyber Research Check Point Software Technologies @ynvb

Isaac Dvir
Director of Mobile Threat Prevetion Check Point Software Technologies @isaacDvir

#RSAC

#RSAC
CYBER
MISCONCEPTIONS
"The trouble with the world is not that people know too little; it's that they know so many things that just aren't so."
Mark Twain

#RSAC
Somethings have nothing to do with Cyber...

CAMERAS

#RSAC

945

1953

1988

#RSAC
But Who Uses Cameras Anyway?!
News Stations Professional Photographers Surveillance Everyone
6

#RSAC
But Why Canon?!
We love Canon Canon has 40% of the DSLR Camera Market Share Over 20 Million Sold in 2019 alone Used by *many* people Has PTP Support
7

#RSAC
PTP
"Picture Transfer Protocol" Designed at 2001 Originally intended for any picture transfer Today commonly referred to picture transferring over WiFi

#RSAC

#RSAC
Effective Mobile Threats Cost Millions of $$$

#RSAC
Mobile Threat Landscape
In today's world mobile attacks are difficult to implement OS mitigations are very effective A successful attacks very limited Breaching the OS limits costs $$$
11

#RSAC

#RSAC
Here I am Here I am...
The operator sends a special message as soon as it detects a new device on the network
It's been Used to deploy the operatorspecific settings, such as the address of MMS service center
The message format is defined by Open Mobile Alliance

#RSAC
Open Mobile Alliance
Standards body coordinating the mobile industry
Members are equipment & software vendors, and network operators
Board of Directors includes representatives (as of this year) from ARM, AT&T, Ericsson, Intel, Nokia, Orange, Qualcomm, Sierra Wireless & T-Mobile

#RSAC
Standard Mobile Use Case...

#RSAC
Standard Mobile Use Case...

#RSAC
OTA Provisioning
MMS Message Server Browser Homepage
Mail Server Directory Server
Proxy Server And More...

OTA Provisioning
MMS Message Server Browser Homepage
Mail Server Directory Server
Proxy Server
And More...

Authentication
Usually authentication is based on IMSI In some cases ­ no authentication at all Messages do not provide any visual indicator

#RSAC
Breaking the Mobile Misconception

#RSAC
Breaking the Mobile Misconception

USB GSM dongle (~30$) + SIM

Simple Script to build CP PDUs (NowSMS)

+

=

#RSAC

#RSAC
We know everything about Email Based attacks

#RSAC
Email Attacks
Email is leading the attack vectors
­ Malicious Attachments ­ "Drive-By" malicious links ­ Documents (read: Office Macros)
Defiantly not new Certainly not sophisticated
EASY TO DETECT

#RSAC
ACE
Proprietary compression algorithm Created in 1991 Today, mostly unmaintained Supported by WINRAR only (!!!)

#RSAC
WINRAR
File archiver utility for Windows Over 30 supported archive file types Endless trial version \o/ Over 500 Million install base (!!!)

#RSAC

#RSAC
If its been well reviewed, its considered safe

#RSAC
SQLite
SQLite is the most famous Embedded Database A light Database All information is stored on a single SQLite file Has over a TRILLION installations One of the mostly commonly used databases One of the most commonly reviewed databases
30

#RSAC
SQLite Vulnerability Use Case

Issue when loading malicious SQLite Database

· WebSQL · Web API · Queried from JS · SQLite Backend

· CVE 2015-7036 · BH2017 ­ Chaitin · Magellan

#RSAC
SQLite Vulnerability Use Case
Issue when loading malicious SQLite Database

SQLite Vulnerability Use Case
"InfoStealer" Malware Backend

Issue when loading malicious SQLite Database

Privilege Escalation on Windows/Linux
Persistence on Mobile Devices

#RSAC
CVE 2019-8602 CVE 2019-8600 CVE 2019-8577 CVE 2019-8598
...

#RSAC

#RSAC
Application Stores are Bullet Proof

DwJhOGScehwooiOavlimmicoesvihrgtpeKuhlori:6enslnE5aPae2f0tRdnnleea,d0tsyscs0tmS(t0aictengolaiedintrcleeswktra!asalal)csrtferio#mRnSAC nStuemalsbSeMr oSfs aAnnddroid
contacts
aySpSinrupotebfepmuosacisrrlrusimmbameDnastteoehdireovvniinivccesieceystsi!mtetaoling

The Joker Mechanism :
The User installs malicious app with a dropper from the Play Store

Loading of 2nd stage malware
Check country via MCC Use notification listener to grab SMS Register the victim to premium services

Run a RegEx on the SMS content to get the verification code !

The App communicates with Command & Control server to start malicious activity. Launching the 2nd stage of the malware configuration.

#RSAC

#RSAC
1-days in Google Play
A mobile app typically uses dozens of reusable components written. An app may keep using the outdated version of the code even years after the vulnerability is discovered. long-known vulnerabilities may persist even in apps recently published on Google Play The following demo shows the PoC video file from the original CVE-2016-3062 report causing the latest version of VivaVideo app (com.quvideo.xiaoying, over 100 million downloads) to crash.
38

39

#RSAC
Cloud is the end of security vulnerabilities

#RSAC
Azure
Microsoft Cloud Solution Top 3 Cloud Infrastructure World Wide Millions Of Users
41

Just Someone Else's Computer...
Business Process

#RSAC
Patient Data Financial Transactions Business Data

Just Someone Else's Computer...
Business Process

#RSAC
Patient Data Financial Transactions Business Data

#RSAC
Just Someone Else's Computer...
Workload
Workload Workload
Workload Workload

#RSAC
Workload Workload Workload Workload Workload

#RSAC
Workload Workload Workload Workload Workload

#RSAC

Workload

#RSAC
Workload

#RSAC

Workload

Workload

#RSAC

Workload

Workload

#RSAC

Workload

Workload

#RSAC

Workload

Workload

Workload

Workload

Workload

Workload

Workload

#RSAC
Look for The Dark Corners of Your Battle

#RSAC

55
Don't Fall For Rumors

56
New Technology Comes With a Risk

57
Take Your Time to
Review Each New
Device\Technology

58
Apply to Your Risk Model

We will all (most

59

probably) have job

security for a long

time 

#RSAC
THE
END
RESEARCH.CHECKPOINT.COM _CPRESEARCH_

