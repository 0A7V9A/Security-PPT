SESSION ID: PART1-T10
Inside the Takedown of the Rubella Macro Builder Suspect

John Fokker
Head of Cyber Investigations, Principal Engineer McAfee @john_fokker

#RSAC

#RSAC
Speaker
John Fokker Head of Cyber Investigations, Principal Engineer McAfee ATR team @John_Fokker
2

#RSAC
What is a Macro Builder?
And why should McAfee care...

#RSAC

#RSAC
What is a Macro Builder?
Specialized toolkit to weaponize MS office documents
Outsourcing Expertise
­ Macro building ­ Obfuscation ­ AMSI evasion
Facilitating (Spear)phishing on a larger scale.
Middle-man function

#RSAC
MITRE ATTACK Techniques of Threats against Retail

#RSAC
How did it start for us? : Hunting for Gandcrab Ransomware but catching Rubella...
Linking the adversary to their tools

#RSAC
Hunting for Gandcrab ransomware but catching Rubella...
Looking at relationships between cybercriminals on Cyber criminal forums Affiliates research of Gandcrab ransomware One particular affiliate was a user of the Rubella Macro Builder
SprXXXX Customer of Rubella
8

SprXXXX

Rubella

#RSAC

#RSAC
MS Office version in Dutch

#RSAC

#RSAC
So who is Rubella?
Postings ­ A seller on the Notorious Exploit forum.
· We are actively researching
IntGearnedsctrsab Ransomware Affiliates ·­ ORTunabeneatllfaafliluiasteRiasncasollemdwsparirtee-7a7sa-nad-Sies ravciucsetomer of ­ Goliath Loader, 2nd stage Implants ­ Havana Cryptowallet stealers ­ Stolen Credit card and Gift cards ­ Email spoofing software
Monikers (new and old) going back to 2014
­ Rubella, KiXXX, codXXX, MarXXXX

Monikers over time...

Exploit
Member

HackForums
Member

#RSAC
kXXXX_XXXX
Uses skype account

Rubella 2019

Same PDB path &
Moniker leaked in dispute

KiXXXXX 2017

Old Moniker on HF

MarXXXX 2015-2016

#RSAC
Climbing the Criminal Career Ladder

2015

2017

2019

#RSAC
Working the Human element
"Mister Rubella, Is there anything else you would like to add yourself?"

#RSAC
Meet John Doe
John is your average SYS Admin John got fired recently by company X Not a coder nor a skilled hacker
But... John holds a grudge..  ­ Looking for a Macro Builder and RAT tool to infect
his former employer.

#RSAC
Hi
Hi, I saw your stuff online, pretty cool

Rubella

John Doe

#RSAC

how can i help?

I was looking online for a word macro builder and I found your postings. It seems pretty cool, so that is why I added you to my contacts, might come in handy

Rubella

John Doe

#RSAC
Okay good you wish to buy
Maybe, but I have to work on my payload

Rubella

John Doe

#RSAC

Good!! im not selling rubella anymore though I now sell Dryad macro builder http://prntscr.com/X XXXX

But I like what I see in the advert. pretty straight forward.

Rubella

John Doe

Dryad?

#RSAC

Ok. Don't mind me

asking why did you

Its different product But its better than
Rubella

change the name? or is it totally different?

Rubella

John Doe

Ofcourse!

oh wow, you built all this yourself?

#RSAC
Confession!!

Rubella

John Doe

#RSAC

Not really, But I can offer to code a custom bot but it would take
some time and it would require a pretty
big budget For private bot in C

cool!! I am looking for a good RAT tool as payload, do you have any advice?

Rubella

John Doe

#RSAC

Yes NP.

Interesting maybe if I have some more money....

Rubella

John Doe

#RSAC

Dont know Different times

Thank you so much already, been great chatting . I am certainly interested When are you online if I want reach out again?

Rubella

John Doe

cy

k

cya

c u later

#RSAC

Rubella

John Doe

#RSAC
Technical analysis of the Rubella and Dryad Macro Builder
How does it work under the hood

#RSAC
Classic Mistakes...

#RSAC
Linking the PDB paths to more Rubella software

#RSAC
Some files even included his JabberID

#RSAC
Comparing Rubella and Dryad
Both Kits developed in .Net No obfuscation in the actual Toolkit A built-in licensing function
Both Kits have been offered to Malware Ops in order to double check that we offer protection.

#RSAC
Obfuscation recipe
Generating Random Strings, Characters and Numbers
A pinch of Junk Code
Mixing it all together in a Macro
Adding the obfuscation recipe to the McAfee detection cookbook

#RSAC
Arrest, Confession & Discussion
Can early intervention help prevent Cybercrime?

#RSAC
The Arrest

#RSAC
Conclusion and Discussion
Macro builders form an important link in the cybercriminal attack chain.
Stopping a Macro builder (or other facilitating service) will impact the business process of hunderds of cybercriminals.
But.... Rubella has stopped, but at what cost to society?
Would an early intervention program be an solution?
Once of prevention against a Pound of IT Sec and Taxpayers costs..

#RSAC
More information
https://github.com/advanced-threat-research https://www.mcafee.com/blogs/other-blogs/mcafeelabs/mcafee-atr-aids-police-in-arrest-of-the-rubella-and-dryadoffice-macro-builder-suspect/?hilite=%27rubella%27

#RSAC
Thank you
@John_Fokker

