SESSION ID: HTA-R07
Automotive/IoT Network Exploits: From Static Analysis to Reliable Exploits

Jonathan Brossard
Managing Director Moabi @endrazine

#RSAC

#RSAC
Who am I ?
CEO at Moabi (San Francisco, Paris) Security Researcher : Bitlocker, MS IE/Edge, most BIOS Firmwares, SAP. "Inventor" of Hardware Backdooring (Rakshasa, 2011) Firmware Security Pioneer (INTEL-SA-00016) Previously Director of Offensive Security at Salesforce Speaker at Blackhat (x5), Defcon (x3) MS Engineering, MS C.S., PhD candidate
2

#RSAC
Disrupting static analysis for IIoT
128b taint analysis and symbolic execution Built for IIoT / Industrial Processes Scales to 100k+ binaries / day / client Covers entire SSDLC Finds 0days automatically Enables secure supplier relationship
management
3

#RSAC
Return on Experience
4

#RSAC
IIOT static analysis : case study
Auditing GenIVI

#RSAC
Use case : audit of GenIVI
6

#RSAC
Use case : audit of GenIVI
7

#RSAC
Hostapd : overview
8

#RSAC
Hostapd : Pseudo Random Number Generator
9

#RSAC
Hostapd : CVE-2016-17043
In depth analysis

#RSAC
Hostapd : Pseudo Random Number Generator
Use of rand() and random() without seeding PRNGS
Reference: https://cwe.mitre.org/data/definitions /330.html Silently fixed in version 2.6 (2016) Reported to CERT in 03/2019
11

#RSAC
Hostapd : CVE-2016-10743
12

#RSAC
Exploit prototyping
Bridging the gap between static analysis and exploitation

#RSAC
From static analysis to reliable exploit : Witchcraft (WCC)
The binary is ARM How do we verify if the vulnerability exists ? Let's rely on the Witchcraft Compiler Collection (WCC)
14

#RSAC
The Witchcraft Compiler Collection (WCC)
Open Source Software Introduced at DEFCON and BLACKHAT 2016 https://github.com/endrazine/wcc Rapid Cross platform analysis JIT binary translation from ARM to x86_64 thanks to qemu
15

#RSAC
DEMO
Witchcraft Compiler Collection

#RSAC
Pseudo Random Number Generator Failure
Source: https://imgs.xkcd.com/comics/random_number.png
17

#RSAC
Conclusion
Take away

#RSAC
Apply What You Have Learned Today
Next week you should:
­ Update hostapd to latest version
Within six months you should:
­ Identify gaps in your SSDLC to include modern technologies such as static analysis
­ Measure your organization's exposure to firmware vulnerabilities ­ Kickstart a secure supplier relationship management process
19

#RSAC
Thanks for your attention
Get in touch : info@moabi.com

