Embracing  the   Uncertainty  of   Advanced  A5acks   using  Big  Data   Analy<cs  
Eddie  Schwartz   CISO,  RSA  

Certainty?? From  an  AV  Forum  

FEAR

UNCERTAINTY

DOUBT

"Caesar recognized the omens, he just didn't think they applied to HIM." - Nate Silver

Na<on  states  

Organized  crime  

Insiders  

Cyber--terrorists  /   Hack<vists  

Others...  

APT  2:   Exposing  one  China's  most   BIZARRE  cyber  espionage  units  

What  is  the  universe  of  data   that  is  useful  here?  
Source:    Greg  Hogland  

What  level  of  resources  belongs   RIGHT  HERE??  

Monitoring   15%  

Response   5%  

Preven<on   80%  

Monitoring   33%  

Response   33%  

Preven<on   33%  

The  Rise  of  Big  Data  
  

BIG DATA TRANSFORMS
SECURITY

· Comprehensive Visibility · Actionable Intelligence · Agile Analytics · Centralized Incident
Management

Storage  

Storage  

Storage  

Storage  

Storage  

Storage  

Storage  

Storage  

Storage  

Logs  

Full  Packet   Capture  

Other  Stuff  

Event  Management   Search  Tools  

Intel  

Tasks  
Skill  set  required  
Role  of  a  service   provider   Bo5om  Line  

SOC  
·Tool  Administra<on   ·Vulnerability  Scanning   ·Tier  1  Event  Support   ·Break--Fix  
·Intermediate  security   knowledge   ·Good  tool  &  process   knowledge   ·Generic  company   knowledge  
·Can  successfully  be   outsourced  to  an  MSSP  
·Wai<ng  for  a  smack  on   the  head  

CIRC  
·Incident  Inves<ga<on   ·Threat  Intelligence   ·Malware  Analy<cs   ·Response  Coordina<on  
·Deep  threat  knowledge   ·Advanced  technical   capability   ·Inves<ga<ve  experience   ·Deep  company   knowledge  
Tough  to  outsource  as  a   standalone  func<on  
Hun<ng  bad  guys  

Ad  Hoc  

End  User   Bystander  

Creator  

Cyber   Prophet  

Improved  Collabora<on  

Technology  Focused  

Business  Risk  Focused  

Cri<cal  Incident  Response  Center  

Cyber  Threat   Intelligence  
· Open/All  Source  Actor   A5ribu<on  
· A5ack  Sensing  &   Warning  
· Social  Media   · High  Value  Target  (HVT)  

Advanced  Tools,   Tac<cs  &  Analysis  
· Reverse  Malware   Engineering  
· Host  &  Network  Forensic   · Cause  &  Origin  
Determina<on   · Email  opera<ons  

Cri<cal  Incident   Response  Team  
· Eyes--on--Glass   · End  User  Intake   · Event  Triage   · Incident  Containment   · 24x7  Coverage  

Advanced  Specialists  

· Integra<on  &  Content  Development  

· Strategic  Planning  

DISTRIBUTED COLLECTION

EUROPE NORTH AMERICA ASIA

REAL-TIME WAREHOUSE

THE ANALYTICS

Reporting and Alerting Investigation
Malware Analytics
Administration

Complex Event Processing
Free Text Speech
Correlation
Metadata Tagging

Incident Management
Asset Criticality
Compliance

LONG-TERM

LIVE INTELLIGENCE
Threat Intelligence ­ Rules ­ Parsers ­ Alerts ­ Feeds ­ Apps ­ Directory Services ­ Reports and Custom Actions

All  Network  Traffic  &   Logs  
Downloads  of   executables  
Type  does  not   match  
extension  
!  
  

Terabytes of data - 100% of total
Thousands of data points ­ 5% of total
Hundreds of data points ­ 0.2% of total
Create alerts to/from critical assets
A few dozen alerts

· Named  Pipes  -->  OS  Construct  for  Inter--process  Communica<on.   · Can  be  used  as  an  endpoint  for  IPC  across  the  network  (e.g.  \PIPE\ATSVC)   · Process  that  owns  the  Named  Pipe  must  have  NT  AUTHORITY\NETWORK   · OS  interrogates  the  caller's  security  context     · Widely  used;  enumerate  Named  Pipes  with  Mark  Russinovich's  Pipelist:  

Parsing  Named  Pipes  (2)  

Parsing  Named  Pipes  (2)  

Parsing  Named  Pipes  (2)  

Named  Pipes  on  the  Wire.      

Named  Pipes  on  the  Wire.      

Named  Pipes  on  the  Wire.      
OH  HAI   DERE!  

Next  Steps:     · Whitelists  (lsass,  samr,  netlogon,  browser,  spoolss,  
wkssvc,  winreg,  srvsvc,  atsvc,  netlogon,  sql\query)   · External  intel  joins  (IOCs,  etc.)   · What  else  can  we  learn  from  other  standard  Named  
Pipes,  i.e.  detect  services  configura<on.   · UUID  &  SecondaryAddr  mismatch?   · Anonymous  Pipes,  Other  RPC  Connec<on  Modali<es  

Intelligence  

Visibility   Control  

Governance  

Fraud  Preven<on  

Criminals Look Different than Others..

· Velocity · Page Sequence
· Origin · Contextual Information

46  

Proprietary and Confidential To Silver Tail Systems

Threat Modeling
Velocity
Behavior
Parameter Injection
Man in the Middle
Man in the Browser

Threat   Intelligence  

Asset  Intelligence  

Analyst Prioritizations

InvesKgaKons  

Event  Capture  

IT  Info  
Asset  List   Device  Type   Device  Content   CMDBs   Vuln.  Scans  

Biz  Context   Device  Owner   Business  Owner   Business  Unit   Biz  Process   RPO  /  RTO  

CriKcality  RaKng  

Big  Data  
   Asset  CriKcality  
Intelligence   ü  IP  Address   ü  Cri<cality  Ra<ng     ü  Business  Unit   ü  Facility  

Big  Data  

Big  Data  

Big   Data?  
Big  Data  

Big  Data  

Big  Data  
Big  Data  

Big  Data  

Big   Data?  

Big  Data   Big  Data  

Big  Data  

Big   Data?  

Big   Data?  

Big   Data?  

Big   Data?  

Big  
Big  Data  
Data?  

eddie.schwartz@rsa.com   h5p://www.linkedin.com/in/
eddieschwartz/     
Thank  you!  

