SESSION ID: HT-F03
The Etiology of Vulnerability Exploitation

Jay Jacobs
Data Scientist Cyentia Institute @jayjacobs

Michael Roytman
Chief Data Scientist Kenna Security @mroytman

#RSAC

#RSAC
Today's Journey...
Describing the Vulnerability Landscape Measuring the Effectiveness of Vulnerability Remedation What contributes to exploitation?
2

#RSAC
Data Sources
3

#RSAC
Data Sources
7.3 billion exploitation attempts (12 mos.) 2.8 billion scanned vulnerabilities 13 million assets
4

#RSAC
Simplified View of Vulnerabilities

Discovered
Public/Publis hed

Metadata

Description References
CVSS CPE CWE

Vulnerability Sig. Exists

IDS/IPS Sig. Exists

Exploit Exists

Patch Exists

Vulnerability Observed

Exploited in-the-wild
5

Patched IRL

#RSAC
Simplified View of Vulnerabilities

Discovered
Public/Publis hed

Metadata

Description References
CVSS CPE CWE

Vulnerability Sig. Exists
Vulnerability Observed

IDS/IPS Sig. Exists
Exploited in-the-wild

Exploit Exists

Patch Exists
Patched IRL

6

#RSAC
Simplified View of Vulnerabilities

Discovered
Public/Publis hed

Metadata

Description References
CVSS CPE CWE

Vulnerability Sig. Exists
Vulnerability Observed

IDS/IPS Sig. Exists
Exploited in-the-wild

Exploit Exists

Patch Exists
Patched IRL

7

#RSAC
The World of CVEs
8

#RSAC
Things Happen Quick
9

#RSAC
Simplified View of Vulnerabilities

Discovered
Public/Publis hed

Metadata

Description References
CVSS CPE CWE

Vulnerability Sig. Exists
Vulnerability Observed

IDS/IPS Sig. Exists
Exploited in-the-wild

Exploit Exists

Patch Exists
Patched IRL

10

#RSAC
The World of CVEs (counting by CVEs)
11

#RSAC
Published CVEs
12

#RSAC
Published CVEs
13

#RSAC
What about Volume of Open Vulns?
14

#RSAC
Simplified View of Vulnerabilities

Discovered
Public/Publis hed

Metadata

Description References
CVSS CPE CWE

Vulnerability Sig. Exists
Vulnerability Observed

IDS/IPS Sig. Exists
Exploited in-the-wild

Exploit Exists

Patch Exists
Patched IRL

15

#RSAC
Is CVSS used to prioritize IRL?
16

#RSAC
The Vendor Role in Remediation?
17

#RSAC
Top 3 Vendors
18

#RSAC
Top 3 Vendors
19

#RSAC
Top Products going unpatched
20

A Quick aside on remediation times...

#RSAC
Probability of Patching
22

#RSAC
The Case for Auto-Patching
23

How effective is your remediation strategy?

#RSAC
Measuring Remediation Decisions
CVEs with exploits
Efficiency and Coverage
(Precision and Recall)

How many remediated CVEs have published
exploits?

How many CVEs with published exploits have been
remediated?

Efficiency =

Coverage =

What we remediate
25

Measuring Decisions: CVSS 10

CVEs with exploits

How many remediated CVEs have published

exploits?

20,207

67,855

1,510

5,025

What we remediate

Efficiency =
1,51
= 1,5100 +
5,025
23.1% Efficiency
26

#RSAC
How many CVEs with published exploits have been
remediated?
Coverage =
1,51
= 1,5100 +
20,207
7% Coverage

#RSAC

Measuring Decisions: CVSS 10

CVEs with exploits
20,207

67,855

Remediating CVSS 10+ results in:
6,535 CVEs prioritized, 23.1% Efficiency, 7% Coverage

5,025

Is this good?

1,510

What we remediate
27

#RSAC

Measuring Decisions: CVSS 10

CVEs with exploits

Remediating CVSS 10+ results

20,207

67,855

in: 6,535 CVEs prioritized,

23.1% Efficiency, 7% Coverage

5,025

Is this good?

1,510

What if we randomly selected

6,535 CVEs to remediate?

What we remediate
28

#RSAC

Measuring Decisions: CVSS 10

CVEs with exploits

Remediating CVSS 10+ results

20,207

67,855

in: 6,535 CVEs prioritized,

23.1% Efficiency, 7% Coverage

5,025

Is this good?

1,510

What if we randomly selected

6,535 CVEs to remediate?

What we remediate

23% Efficiency, 7.1% Coverage
29

#RSAC
Measuring Decisions: CVSS
30

#RSAC
Vendor-based Strategy
31

#RSAC
Vendor-based Strategy
32

#RSAC
Simplified View of Vulnerabilities

Discovered
Public/Publis hed

Metadata

Description References
CVSS CPE CWE

Vulnerability Sig. Exists
Vulnerability Observed

IDS/IPS Sig. Exists
Exploited in-the-wild

Exploit Exists

Patch Exists
Patched IRL

33

#RSAC
Predictive Model
34

#RSAC
Predictive Model
35

Predictive Model
36

#RSAC
CVSS 7+ to "Balanced"
· Twice the efficiency · Improved Coverage
(53% to 62%)
· A Third of FP · Half the effort

The Etiology of Vulnerability Exploitation

#RSAC
What contributes to exploitation in the wild?
Variables on this side increase overall probability
Variables on this side decrease overall probability
38

#RSAC
What contributes to exploitation in the wild?
Any
Published exploit
39

#RSAC
What contributes to exploitation in the wild?
Vendors (CPE)
40

#RSAC
What contributes to exploitation in the wild?
"tags"
(descriptions)
41

#RSAC
What contributes to exploitation in the wild?
References Products
CVSS
42

#RSAC
What contributes to exploitation in the wild?

If nothing else is present, 0.1% chance of exploitation

If there is a published exploit, in metasploit: 40% chance

43

#RSAC
What contributes to exploitation in the wild?

...AND has a CVE reference from MS: 81% chance

If there is a published exploit, in metasploit: 40% chance

44

#RSAC
What contributes to exploitation in the wild?

...AND has a CVE reference from MS: 81% chance

If there is a published exploit, in metasploit: 40% chance

...AND exploitDB published the exploit: 16%
45

#RSAC
What contributes to exploitation in the wild?

MS Ref Symantec Metasploit

Linux (prod) Acrobat Excel Drupal "ASP"

Mac OS X ElliotDB
Safari
46

"double free memory"
"authenticated" "SQLi" "directory traversal"

#RSAC
Predicting Probability: "well calibratedPr"edictions here are
slightly underestimating probability
Tight confidence, well calibrated, 80% of vulns are predicted at < 5%
Predictions here are slightly over-estimating probability
47

#RSAC
Apply What You Have Learned Today
Next week you should:
­ Look at your own vulnerability efforts, what are you using beyond CVSS? ­ Investigate how you are tracking open and closed vulnerabilities.
In the next month:
­ Start collecting exploit(ed) vulnerabilities from your own sensors.
Within six months you should:
­ Calculate and track your own Coverage, Efficiency and Capacity ­ Compare your strategy to other prioritization strategies ­ Look for more research coming soon!
48

SESSION ID: HT-F03
The Etiology of Vulnerability Exploitation

Jay Jacobs
Data Scientist Cyentia Institute @jayjacobs

Michael Roytman
Chief Data Scientist Kenna Security @mroytman

#RSAC

