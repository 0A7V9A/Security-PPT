SESSION ID: HTA-R09
Reverse Engineering Attribution: The Man Behind the Man Behind the Curtain

Jayce Nichols
Senior Director, Intelligence Research FireEye

John Miller
Director, Intelligence Analysis FireEye

#RSAC

#RSAC
Sometimes, appearances shape reality

#RSAC
What's the "real story" on cyber false flags? What should I do about it?

Attribution Analysis Today

#RSAC
What factors are considered in attribution analysis?

Group activity together
 Tools | malware, certificates...

Identify the culprit
 Infrastructure | IPs, domains....

 TTPs | lures, exploits...

 Online identity | social media, email...

 Identifiers | passwords, registrants...  Targets | dissidents, politicians...

 Infrastructure | domains, netblocks...  Linguistics | code comments, typos...

 Metadata | PDB strings, doc authors...  Pattern of life | timezone, holidays...

#RSAC
How Hard Is Misattribution, Really?

How Hard Is Misattribution, Really?

#RSAC
if you can....

Use malware tied to previous operations

How Hard Is Misattribution, Really?

#RSAC
if you can....

Manipulate code metadata

How Hard Is Misattribution, Really?

#RSAC
if you can....

Use documented TTPs

How Hard Is Misattribution, Really?

#RSAC
if you can....

Create a confusing targeting picture

How Hard Is Misattribution, Really?

#RSAC
if you can....

Avoid dumb mistakes

Fundamental Challenges to Attribution Analysis

#RSAC
Cyber threat intelligence can be a bit like this

#RSAC
Cyber threat intelligence can be a bit like this

#RSAC
Attribution publication cuts both ways

#RSAC
Threat actors can see the breadcrumbs too

#RSAC
When is the simplest explanation wrong?

#RSAC
Attribution makes headlines

Why Misdirect Attribution Analysis?

#RSAC
Why misdirect attribution analysis?
Decrease target's prioritization of incident
Reduce risk for sensitive operations
Create pretext for desired action

Attribution Deception Happens

#RSAC
Attribution deception happens!

#RSAC
Attribution deception happens!
"[A US bank] is believed to have become the latest victim of a cyber-attack launched by a group pledging retaliation for the controversial Innocence of Muslims video that has triggered anger and violence across the Muslim world. A group calling itself Izz ad-Din al-Qassam Cyber Fighters has claimed responsibility..."
WHERE DID THIS NEWS STORY COME FROM?
ANSWER: ATTACKER PROPAGANDA

#RSAC
Attribution deception happens!

U.S.
"Tools with a
Web history"

China
"Blind and silence"

Russia
"Reflexive control"

#RSAC
Attribution deception happens!
25

#RSAC
Attribution deception happens!
 (Likely) targeting Japan: C:\xingxing\snowball\Intl_Cmm_Inteface_Buld_vesion2.6\IMGJPS.pdb  C:\share\moscow\work\upgraded\zark20rk-add support for
httpdownloader\server\bin\zark20rk.pdb
 Targeting South Korea: " Windows" and RU-EN PE resources
26

Application and Takeaways

#RSAC
Application: SOC Analyst or Lead
What should I do differently as someone who is on the front lines of defense for my organization?
Evaluate current alert triage process against deception scenarios
­ Be careful about blindly ignoring alerts below a certain threshold ­ Think critically about your alert process; if you were an attacker, how could
you exploit it?
Don't just ignore "commodity" by default
­ Treat links to targeted threats as high priority, but remember that opportunistic compromises can still be damaging
­ Are your defenses set up to detect post-compromise activity or lateral movement?
28

#RSAC
Application: Incident Responder
What should I do differently as I investigate intrusions? Beware the smoking gun!
­ If your findings hinge on one key piece of evidence, reexamine your assumptions
Rule out alternative explanations before moving on
­ Consider the possibility that a different adversary is reusing TTPs ­ Threat actors evolve; make sure your mental model is open to new
information ­ Before wrapping up, consider: would you be done if you suddenly found
out that a different threat actor was responsible?
29

#RSAC
Application: Intelligence / Threat Analyst
What should I do differently as someone who analyzes the threat landscape for my organization?
Clearly identify, and attempt to disprove, your own hypotheses
­ Analyze means, motive, and opportunity ­ Identify lynchpin assumptions and data ­ Know common pitfalls in reasoning ­ cognitive biases ­ and when specialized
analytical techniques can help avoid them
Be impossible to misunderstand
­ It should not be reasonably possible for a reader or listener to misunderstand your conclusions, or your level of confidence in your conclusions
­ A consumer (with time to actually consume) should never have to come back to you for explanation of your reasoning
30

#RSAC
Application: Business Leader
What should I do differently as someone who makes strategic business decisions?
Know the lines where attribution accuracy matters
­ What actions would significantly cost the business if the threat was misunderstood?
­ What bad outcomes for me could be highly desirable to a specific adversary? Which might be taboo for that actor?
Have your teams prepare & practice for what they would do
­ Ensure your teams are taking the steps appropriate to their roles ­ In the heat of the moment, your team may not recognize cases where
attribution matters unless they've worked through those in advance
31

Thank you
Jayce Nichols
Jayce.Nichols@FireEye.com

John Miller
John.Miller@FireEye.com

Appendix

Attribution: How It's Done

Case sampling

WannaCry, report 1

IP/Domain Registration

WannaCry, report 2

Bangladesh SWIFT hack

Taiwan SWIFT hack

APT39



ME targeted attacks

Crypto exchange targeting

Ukraine / NotPetya

LuckyMouse

VPNFilter

Iran disinformation



DNC hack

Putter Panda



Domestic Kitten

APT37

APT38



Triton



APT32

Online Identity

Targeting

Compile Pattern of

Times

Life

Code Overlap





















































TTP Overlap

     


#RSAC

C2 Infra

Geopolitics

Financial Records

Linguistics

Who Benefits?

EXE Metadata































 







 

Suspected Deception: How It's Done

Case sampling

Linguistic Engineering

Cloud Atlas



Artifact Metadata


Malware Reuse Code Overlap 

Targeting

C&C Infrastructure


Wild Neutron





DPRK / Lazarus





CyberCaliphate



CyberBerkut

Yemen Cyber Army

Duqu 2.0



TigerMilk

Turla



Iranian activity



TRITON



"Crouching Yeti"



"Dancing Salome"



APT29

USG Zeus





Olympic Destroyer



TTP Overlap
  

False Front Impersonation
    



#RSAC

