SESSION ID: SPO2-T08
Using the Cloud to Secure Versus Securing the Cloud

Tom Corn
SVP/GM Security Products VMware @therealtomcorn

#RSAC

Confidential  ©2019 VMware, Inc.

2

Confidential  ©2019 VMware, Inc.

3

Roman period

Confidential  ©2019 VMware, Inc.

4

Medieval period

Confidential  ©2019 VMware, Inc.

5

Early modern period

Confidential  ©2019 VMware, Inc.

6

Roman period

Roman period

Medieval period
Innovation focused on reacting to fires

Confidential  ©2019 VMware, Inc.

Early modern period
7

Escalating cost of fires

Innovation focused on reacting to fires

Confidential  ©2019 VMware, Inc.

8

Philadelphia
18TH CENTURY

Confidential  ©2019 VMware, Inc.

9

Philadelphia
18TH CENTURY

Confidential  ©2019 VMware, Inc.

10

Innovation focused on reacting to fires

Confidential  ©2019 VMware, Inc.

11

18th Century fire prevention approaches

Confidential  ©2019 VMware, Inc.

Chimney sweeps

Transferring coals properly
12

Modern fire prevention approaches

Building regulations and codes

Confidential  ©2019 VMware, Inc.

Flame retardant paints and
materials

Safe liquid storage

Fire proof homes
13

Confidential  ©2019 VMware, Inc.

14

An Ounce of Prevention

Confidential  ©2019 VMware, Inc.

15

Reactive Versus Preventive Cyber Controls
Firefighting versus fire prevention
Reactive
(E.g., AV,, Deception, HIPS, EDR)
Preventive
(E.g., Patching, Segmentation, App Control, Encryption)

Confidential  ©2019 VMware, Inc.

16

Where do we Invest and Innovate?
Reactive versus preventive cyber controls
Reactive
Preventive

Confidential  ©2019 VMware, Inc.

17

What has the Bigger Impact on Risk?
Reactive versus preventive cyber controls
Reactive
Preventive

Confidential  ©2019 VMware, Inc.

18

Cloud Workload Protect Controls Hierarchy
Gartner Market Guide for Cloud Workload Protection Framework

Figure 1. Cloud Workload Protection Controls Hierarchy, © 2018 Gartner, Inc.

AV
Deception HIPS with Vulnerability Shielding Server Workload EDR Behavioral Monitoring
IaaS Data at Rest Encryption
Exploit Prevention / Memory Protection

Less Critical
Optional Server Protection Strategies
Important, but often provided outside of CWPP

Application Control / Whitelisting System Integrity Monitoring / Management

Core Server Protection Strategies

Network Firewalling, Segmentation and Visibility

No arbitrary code No email, web client

Hardening, Configuration and Vulnerability Management

Admin Privilege Management

Change Management

Log Management

Foundational Operations Hygiene

Restricted Physical and Logical Perimeter Access

Source: Gartner, Market Guide for Cloud Workload Protection Platforms, Neil MacDonald, March 26th 2018. Gartner does not endorse any vendor, product or service depicted in its research publications, and does not advise technology users to select only those vendors with the highest

ratings or other designation. Gartner research publications consist of the opinions of Gartner's research organization and should not be construed as statements of fact. Gartner disclaims all warranties, expressed or implied, with respect to this research, including any warranties of

Confidential  ©2019 VMware, Inc.

merchantability or fitness for a particular purpose. This graphic was published by Gartner, Inc. as part of a larger research document and should be evaluated in the context of the entire document. Charts/graphics created by VMware based on Gartner research.

19

What Would it Take to Rethink Prevention?
Shift the focus from infrastructure to applications

Compute Network
Confidential  ©2019 VMware, Inc.

Apps

Data

20

An Infrastructure-Centric Approach
Perimeter

Confidential  ©2019 VMware, Inc.

21

An Infrastructure-Centric Approach
Perimeter

Network

Confidential  ©2019 VMware, Inc.

22

An Infrastructure-Centric Approach
Perimeter

Network

Compute

Confidential  ©2019 VMware, Inc.

23

An Application-Centric Approach
Understand the composition, topology and behavior of your application

Dining Room Bedchamber Bedchamber

Kitchen Study

Parlor Library

Confidential  ©2019 VMware, Inc.

24

An Application-Centric Approach
Understand the composition, topology and behavior of your application

Dining Room Bedchamber Bedchamber

Kitchen Study

Parlor Library

Confidential  ©2019 VMware, Inc.

25

An Application-Centric Approach
Use that understanding to drive how you lock and monitor

Dining Room Bedchamber Bedchamber
Confidential  ©2019 VMware, Inc.

Kitchen Study

Parlor Library

Family
26

Principle of Least Privilege

"Every program and every privileged user of the system should operate using the least amount of privilege necessary to complete the job."

Professor Jerome Saltzer, MIT Communications of the ACM

Confidential  ©2019 VMware, Inc.

27

Attacker advantage
Confidential  ©2019 VMware, Inc.

Defender advantage
28

Attacker advantage

Focus on Infrastructure

Defender advantage

Compute

Storage

Network

Confidential  ©2019 VMware, Inc.

29

Attacker advantage

Focus on Threats

Defender advantage

Compute

Storage

Network

Confidential  ©2019 VMware, Inc.

30

Attacker advantage

Focus on the Application
Defender advantage

Compute Storage Network

Confidential  ©2019 VMware, Inc.

31

Confidential  ©2019 VMware, Inc.

32

Application

?

Automation

Intrinsic

Confidential  ©2019 VMware, Inc.

33

The Unique Properties of Clouds

Confidential  ©2019 VMware, Inc.

34

Leveraging the Unique Properties of Virtualization

Application

Automation

Intrinsic

What was Provisioned

What is Running

Confidential  ©2019 VMware, Inc.

What does that look like?
36

Application Automation Intrinsic

Confidential  ©2019 VMware, Inc.

37

Compute

Network

VM Manifest

Confidential  ©2019 VMware, Inc.

38

Confidential  ©2019 VMware, Inc.

Learn

Provisioning Context

Application Verification Cloud

Runtime Learning

App Scope

Confidential  ©2019 VMware, Inc.

Learn
Confidential  ©2019 VMware, Inc.

Workload

AppD Monitor

Leverage the virtual infrastructure

Protected zone

Monitor Lock

Adapt

Adapt

Learn
Confidential  ©2019 VMware, Inc.

Lock

Adapt

Compute

Network

VM Manifest

Confidential  ©2019 VMware, Inc.

43

s
Confidential  ©2019 VMware, Inc.

Confidential  ©2019 VMware, Inc.

45

Confidential  ©2019 VMware, Inc.

46

Confidential  ©2019 VMware, Inc.

Hacker
47

Confidential  ©2019 VMware, Inc.

Hacker
48

Confidential  ©2019 VMware, Inc.

Hacker Hacker
49

Shared Services

Hacker

Confidential  ©2019 VMware, Inc.

50

North / South

EnSDteerrirvvpeicrneise FFiirreewwaallll

East / West

Confidential  ©2019 VMware, Inc.

51

How effective is this in real world situations?
52

Christopher Key CEO & Co-Founder Verodin
53

VERODIN PLATFORM

Enables customers to prove the effectiveness of the cybersecurity controls
within their production environment

Moves cybersecurity from a "magic black box" to a quantifiable business function

VERODIN PLATFORM

Enables customers to prove the effectiveness of the cybersecurity controls
within their production environment

Moves cybersecurity from a "magic black box" to a quantifiable business function

CONTROL EFFECTIVENESS / CONFIGURATION ASSURANCE

OPTIMIZATION

RATIONALIZATION

KNOWN GOOD BASELINE

VERODIN PLATFORM

Enables customers to prove the effectiveness of the cybersecurity controls
within their production environment
CONTINUOUS VA L I D AT I O N

Moves cybersecurity from a "magic black box" to a quantifiable business function

CONTROL EFFECTIVENESS / CONFIGURATION ASSURANCE

OPTIMIZATION

RATIONALIZATION

ENVIRONMENTAL DRIFT DETECTION

KNOWN GOOD BASELINE

MANY MORE

APPLICATION SETUP

DB Tier Host
Windows Server 2012 R2
DB Tier

App Tier Host 1
Windows Server 2016

TCP

TCP

3306

80

App Tier Host 2
Windows Server 2016

Web Host RHEL 7

App Tier

Web Tier

Verodin Actor

Verodin Actor

External Windows
Server 2016
External Verodin Actor
Linux
Verodin Actor

MITRE ATT&CK VISIBILITY

MITRE ATT&CK VISIBILITY

MITRE ATT&CK VISIBILITY
EXECUTION TECHNIQUES
 Host CLI ­ Defense Evasion, Execution: RegAsm Bypass  Host CLI ­ Defense Evasion, Execution: rundll32.exe  Host CLI ­ Defense Evasion, Execution, Persistence, Privilege Escalation: New Service  Host CLI ­ Execution, Credential Access: Remote Execution of Mimikatz using PaExec  Host CLI ­ Execution, Exfiltration: HTTP Exfil/Upload of PCI Data using Powershell  Host CLI ­ Execution, Exfiltration: HTTP Exfil/Upload of PCI Data using cU

MITRE ATT&CK VISIBILITY
PERSISTENCE TECHNIQUES
 Host CLI ­ Persistence: Scheduled Task  Host CLI ­ Defense Evasion, Execution, Persistence, Privilege Escalation: New Service

MITRE ATT&CK VISIBILITY
PRIVILEGE ESCALATION TECHNIQUES
 Host CLI ­ Defense Evasion, Execution, Persistence, Privilege Escalation: New Service

MITRE ATT&CK VISIBILITY
DEFENSE EVASION TECHNIQUES
 Host CLI ­ Defense Evasion, Execution: RegAsm Bypass  Host CLI ­ Defense Evasion, Execution: rundll32.exe  Host CLI ­ Defense Evasion, Execution, Persistence, Privilege Escalation: New Service  Host CLI ­ Defense Evasion: Removal of Network Share Connection  Host CLI ­ Credential Access, Defense Evasion: Mimikatz W/ UPX Packing (2.1.1)  Host CLI ­ Credential Access, Defense Evasion: Mimitaz W/ String Change

MITRE ATT&CK VISIBILITY
CREDENTIAL ACCESS TECHNIQUES
 Host CLI ­ Credential Access: Mimikatz (2.1.1)  Host CLI ­ Credential Access: Mimikatz W/ 10MB padding (2.1.1)  Host CLI ­ Credential Access, Defense Evasion: Mimikatz W/ UPX Packing (2.1.1)  Host CLI ­ Credential Access, Defense Evasion: Mimitaz W/ String Change  Host CLI ­ Execution, Credential Access: Remote Execution of Mimikatz using PaExec

MITRE ATT&CK VISIBILITY
DISCOVERY TECHNIQUES
 Host CLI ­ Discovery: Enumerate Local Administrators

MITRE ATT&CK VISIBILITY
LATERAL MOVEMENT TECHNIQUES
 Host CLI ­ Lateral Movement: Copy Mimikatz using Mapped Network Drive

MITRE ATT&CK VISIBILITY
EXFILTRATION TECHNIQUES
 Host CLI ­ Execution, Exfiltration: HTTP Exfil/Upload of PCI Data using Powershell  Host CLI ­ Execution, Exfiltration: HTTP Exfil/Upload of PCI Data using cU

MITRE ATT&CK VISIBILITY

EVALUATION METHODOLOGY
Three-phase testing approach to establish and prove against known baseline

E VA L U AT I O N R E S U LT S PHASE-1:
NSX DISABLED AD DISABLED

E VA L U AT I O N R E S U LT S PHASE-2:
NSX PREVENT AD DETECT

E VA L U AT I O N R E S U LT S PHASE-3:
NSX PREVENT AD PREVENT

Christopher Key CEO & Co-Founder Verodin
78

Benjamin Franklin

Confidential  ©2019 VMware, Inc.

79

Unconventional Thinking Often Comes From

Unconventional Sources

Confidential  ©2019 VMware, Inc.

80

Unconventional Thinking Often Comes From Unconventional Sources

Confidential  ©2019 VMware, Inc.

81

Where Can You Learn More?

Watch

Experience

"Three Things the Security Industry Isn't Talking About (but Should Be)"
Thursday, Mar 07 04:00 P.M. - 04:25 P.M. Pat Gelsinger, Chief Executive Officer, Vmware Shannon Lietz, Director, Intuit

See these strategies in action at:
VMware Booth: North Hall #5655
VERODIN at Booth #4214

Learn
Learn more at www.vmware.com/enterprisesecurity-solutions
vmware.com/go/servicedefined-firewall
https://www.verodin.com

Confidential  ©2019 VMware, Inc.

82

SESSION ID: SPO2-T08
Using the Cloud to Secure Versus Securing the Cloud

Tom Corn
SVP/GM Security Products VMware @therealtomcorn

#RSAC

