SESSION ID: LAB2-T08
Bad Intelligence: Or How I Learned to Stop Buying and Love the Basics

Heather Gantt-Evans
Cyber Threat Management Ernst & Young LLP

Brett Rogers
Cyber Threat Management Ernst & Young LLP

Larry Lipsey
Cyber Threat Management Ernst & Young LLP

#RSAC

#RSAC
Define Cyber Threat Intelligence (CTI)

IS

ISN'T

DOES

The collection, analysis and production of information about
adversaries used to make a decision and/or take action

Crystal ball Magic 8 ball Oracle of Delphi Pretty dashboard

Strengthens network defense posture in timely, specific, measurable and
impactful ways

2

#RSAC
Bad intelligence
3

Where is the breakdown?
Years-long training pipeline Many information silos Granular attribution Many highly specialized resources Thousands of offices Collect everything Support everyone
4

#RSAC
Staffing struggles and turnover Lack "internal intelligence" Small return on effort Over-budget intelligence programs Integration failures Data overload / heavy vendor reliance Over-scoped mission

#RSAC
Story time
STARTUP
5

#RSAC
Key tenants
1 Threat priorities 2 Customer scope 3 Actionable integration and feedback 4 Manual minimal viable product (MVP)
6

Pics or it didn't happen

Threat Landscape Assessment

Collection Plan

Integration & Workflows

#RSAC
Reporting

7

How do we start?

Idea/Vision

Market Research

Customer/Product Validation

Increases the defensibility of the network Research the threats (competitors) Identify target customers and how to meet needs with MVP Build out roadmap to accomplish vision Begin delivery of intel products to in-scope customers Collect feedback with focus on actionability Iteratively scale MVP to align to roadmap and feedback

8

Scale and Grow

Develop/Update Roadmap
Collect Feedback

Product (re)Launch

#RSAC

#RSAC
Agenda

Introduction Group exercise 1: Market Research Group exercise 2: Customer/Product Validation part 1 Group exercise 3: Customer/Product Validation part 2 Next Steps and Apply Q & A

25 mins 25 mins 25 mins 25 mins 10 mins 10 mins

9

#RSAC
Group exercise 1
Time: 12 minutes table prep, 8 minute debrief to the room Instructions:
At each table, group together and leverage the following artifacts from President Business' Worldwide Conglomerate (PBWC) to populate the provided risk register with ratings and determine PBWC's highest risk threat scenario.
1. Business background and high value asset list 2. List of threat scenarios produced from a recent threat landscape
assessment 3. Risk rating criteria

#RSAC
Group exercise 2
Time: 12 minutes table prep, 8 minute debrief to the room Instructions:
Within "Group Exercise 2" handout, discuss and try to fill in the blanks across the three columns. Examples are provided. Afterwards, please select one Primary and
Secondary intelligence customer. Be prepared to present your team's decision and logic.
Tip: Consider customers' ability to impact network defense.

Group exercise 2 answers

Group
Physical/Supply Chain
Security Operations

CTI Provided Support
Analysis regarding cyber threats to facilities or distribution channels
All-source analysis to drive continuous network monitoring, response, defense and threat hunting

Red Team

Collaborative effort to create realistic threat scenarios for testing

Vulnerability Management

Analysis used to validate and prioritize vulnerability risk

Architecture/IT

Analysis regarding emerging threats to infrastructure

Executive Board

Trends and metrics analysis highlighting cyber threats with impacts to revenue

Business Information Security Trends and metrics analysis highlighting cyber

Officers

threats with impacts to business operations

Enterprise/Third Party Risk Analysis regarding current cyber threats to the

Management

enterprise and vendors/external partners

Data Protection

Analysis of adversary intent/capabilities to target high value data

Enabled Defensive Capabilities
Use of ad-hoc actions to protect facilities and distribution channels
Use of ad-hoc actions to protect the network through: blocking, alerting, investigating, temporarily restricting and monitoring items of interest
Ability to simulate the tactics, techniques and procedures of relevant threat actors and identify associated vulnerabilities
Prioritized out-of-cycle/emergency patching
Prioritized implementation of controls and architecture designs to improve the long-term defensibility of the network
Prioritized security investments aligned to cyber risk reduction
Business Information Security Officers can prioritize controls to protect business operations
Ability to update risk assessment frameworks, refine enterprise security standards, policies and procedures, and more thoroughly assess/control risks posed by vendors
Better targeted controls and policy designed to protect sensitive data

12

#RSAC
Primary Customer
(daily/weekly cycle)
Security Operations
Second Customer
(monthly/quarterly cycle)
Vulnerability Management

#RSAC
Group exercise 3
Time: 12 minutes table prep, 8 minute debrief to the room Instructions:
At each table, group together and leverage the threat landscape assessment (TLA) and customer validation matrix to develop a collection plan.
Tip: Consider your organization's ability to collect given people and technology constraints.

#RSAC

Group exercise 3 answers

Threat Landscape Priority Intelligence Assessment Scenario Requirement (PIR)

Specific Information Requirement (SIR)

Indicator

Collection Task

Defensive Action (DA) Task

Operations Owner

e
PUBLIC ASSET DISCLOSURE
A threat actor identifies design specifications of your services by researching publicly available case studies, interviews, or success stories.
Attackers then proceed to locate an existing vulnerability/ exploit for the identified assets and attempts to initiate an attack.

Intelligence

Joint

Operations

Leverage the Red Team to

1.1. What exploits/tactics Observed vulnerability or will be leveraged against the missing control in the
organization's network? enterprise network

Confirm or deny the presence of associated vulnerabilities in the
enterprise network

validate presence of emerging vulnerabilities not currently scanned for
by vulnerability

management tools

Red Team

1. How will adversaries identify
and leverage vulnerabilities or
exploits in the organization's environment?

1.2. What are the known, unpatched, vulnerable software on the
organization's production networks for which exploits
are publicly available?
1.3. How do adversaries identify exploitable vulnerabilities in the
organization's network?

Vendor vulnerability reporting; OSINT reporting
Unusual uptick in ping test, traceroutes and
scanning

Identify vulnerabilities affecting internal systems/tools

Scan the production network to identify existing vulnerabilities

Identify or report Leverage NIDS/NIPS to

reconnaissance activity identify an increase in

in the enterprise network traffic across the

network

enterprise network

Vulnerability Management Team
Security Operations Team

1.4. Are third party vendors exposed to new
vulnerabilities or exploits?

Vendor vulnerability reporting; OSINT reporting

Confirm or deny vendor applications are in compliance with
organizational standard

Conduct random risk assessment of select vendor applications

Enterprise/Third Party Risk Management Team

Note: Additional collection plan inputs for consideration include measures of effectives, frequency of collection and collection tool/source.

14

Next Steps and Apply
Applying what we learned

What comes next?

Idea/Vision

Market Research

Customer/Product Validation

Increases the defensibility of the network Research the threats (competitors) Identify target customers and how to meet needs with MVP Build out roadmap to accomplish vision Begin delivery of intel products to in-scope customers Collect feedback with focus on actionability Iteratively scale MVP to align to roadmap and feedback

16

Scale and Grow

Develop/Update Roadmap
Collect Feedback

Product (re)Launch

#RSAC

But can't a TIP do all of this for me?

Ticketing Systems

Indicator Feeds
(OSINT or purchased)
SIEM and Log Sources
("Internal Intelligence" based on threats targeting
YOUR network)

Indicator Relationship Visualization Tool

Unstructured Data Visualization Tools/ Analytics Platforms

Robust Intel Providers
(Reports, RFI support, IOCs,
etc.)

Indicator Repository

Database for Unstructured Data
(Threat report and program knowledge management
repository)

Stand-alone OSINT Report Aggregators with Visualization

Indicator Research Tools

IOCs Reports

17

Automation Platforms

#RSAC

Apply and artifact handout

Threat Landscape Assessment

Collection Plan

Integration & Workflows

#RSAC
Reporting

18

#RSAC
Summary
Discovered an end to end framework developed for costeffective, custom integration of intelligence. Learned how to implement custom workflows for the most valuable threat intelligence integration. Walking away with real analytical artifacts and become confident in application to your business.
19

#RSAC
Q & A
Burning questions now, tomorrow, next month or next year?
Email us anytime at:
Heather Gantt-Evans heather.gantt@ey.com
Brett Rogers brett.rogers@ey.com
Larry Lipsey larry.lipsey@ey.com
20

Appendix: Handout artifacts
Taking it back to the business

CTI operating model

DATA

PROCESS*

Example Sources

Threat intelligence
feeds Technical
logs Social media Open source news Asset Inventory

Collect

Deliver

Intelligence requirements

Analyze

Produce

#RSAC

PRODUCT
Recommended Actions delivered via:
· CTI Alerts · CTI Reports · Requests for Information (RFI)
Responses
Intelligence
Cyber Threat Intelligence = the collection, analysis and production of information about adversaries
used to make a decision and/or take action that strengthens defense posture

CONSUMER
Primary (Daily/Weekly)
Secondary (Monthly/ Quarterly)

*People Requirements: 2-4 dedicated analysts depending on organizational size and intelligence mission scope
22

Example CTI workflow
RFI Lifecycle Process

New RFI Ticket

Opened

Assigned

In-Progress

Complete

RFI Ticket Closed

Intelligence Lifecycle Process
Collection

Automation*

Internal Information
External Information

Collection Process
(Collect)

AAdddd MMeerrggee DDroropp

Enrich Scripts

New Ticket
Tracked Ticket
Dead Ticket

Enrich Process (Analyze)
EOL

*Automation is not an initial requirement but adds to operational efficiency and production.

Delivery
Production & Reporting

Production

Process

Tracking

Queue

EOL

(Produce)

23

#RSAC

Example threat scenario:
Public asset disclosure

Likelihood
3

Potential Impact
3

Risk Rating
9

Threat Scenario

 A threat actor identifies design specifications for the [ORGANIZATION NAME] services or clients by researching publicly available case studies, interviews or success stories. Attackers then proceed to locate an existing vulnerability/exploit for the identified assets and attempts to initiate an attack.

Supporting Evidence

 Public documents on the [ORGANIZATION NAME] which provides a description of HVA listed in the [ORGANIZATION
NAME] Success Story, may provide attackers with insights on relevant architecture during a campaign.  Open source news reporting regarding a vulnerability on a public facing [ORGANIZATION NAME] Webmail page.  Security monitoring historic alerts.  Applicable enterprise risk management risk register entries.

Likelihood

 Likely, public disclosure of vulnerabilities occurs frequently and an attacker would need to correlate these disclosures to company assets in order to initiate this threat event.

Impact to Organization

 Medium to Critical ­ Impact would vary depending on the internal classification of the system impacted by the vulnerability and if the attacker was able to pivot to other systems by exploiting the vulnerability.

Collection Objectives

 Exposure of enterprise network details aligned to vulnerabilities impacting [ORGANIZATION NAME] systems and
applications.  Evidence of exploits and threat tactics capable of leveraging network vulnerabilities.

Corresponding PIR

 How will adversaries identify and leverage vulnerabilities or exploits in the [ORGANIZATION NAME] environment?

Intelligence Gathering

Initial Exploitation

Command & Control

Privilege Escalation

Campaign Conclusion

External Reconnaissance

Attack development

Initial Attack

Establish Foothold

Enable Persistence

Enterprise Recon

Move Laterally

Escalate Privilege

Gather Data

Steal Data

Maintain Persistence

1. Intelligence Gathering Attacker searches for press releases, white papers, case studies or interviews that identify company assets used internally or by clients.

2. Attack Attacker leverages CVEs related to identified assets in Metasploit to create a commoditized payload for the potentially vulnerable asset.

3. Spread of malware Malware may be spread via a spearphishing email to the employee who disclosed the asset or, if the asset is externally facing, attackers may attempt to exploit directly.

24

4. Data Exfiltration/Destruction Attacker leverages access to target environment to exfiltrate data or maintain access until further actions are required.

#RSAC

#RSAC

Example collection plan

TLA Scenario

Priority Intelligence Requirement (PIR)

Specific Information Requirement (SIR)

Indicator

Collection Task Ops Owner Collection Tool(s) Collection Frequency

Intelligence

Operations

ID unique

1.1. Are there instances of an

ID string character character string searches matching searches (SSN, CC,
SSN/Credit DOB, ACCT #'s,

Security Monitoring

adversary searching for data Card/Visa number etc.)

ENTERPRISE NETWORK AS A VECTOR

strings similar to a date of birth sequences; ID string search

(DOB) or SSN?

Observed account gaps

files and directory to PII systems

discovery activity

Confirm ACL's

Threat Hunting
IAM

ID new sysadmins

Attackers determine your

by department

organization stores critical PCI, PII, or data related to
intellectual property in a cloud environment.
The attackers then attempt to

1. What indications and warnings suggest adversaries
are targeting PCI/PII information hosted in the enterprise environment?

1.2. What internal teams or sysadmins will adversary target due to placement & access to

compromise your enterprise

PCI/PII ?

High volume of phishing against a particular team or
sysadmin

and maintain an accurate personnel inventory Confirm/Deny vulnerabilities for systems in sysadmins scope

GRC
Vulnerability Management

through any means necessary

of responsibility

and pivot through assets.

ID tactics for

IDS/IPS
IDS/IPS IAM platform CRM platform
Vulnerability Scanner

Weekly Quarterly

targeting internal Threat Open source or

PCI/PII

Intelligence vendor reporting

teams/sysadmins

Measure of Effectiveness (MOE)
Joint
Anomalous behavior detection increased by
30%
Phishing attempts to sysadmins decreased by
15%

Confirm/Deny

1.3. Is there an unusual

Modified pattern on system

amount of system login failure timestamps log login failures

Active Defense

attempts?

files

ID system login

Security

failures

Monitoring

Note: "Defensive Action (DA) Task" column omitted to allow room for additional columns that can be leveraged in a collection plan.

Defensive Actions are not required to be in the collection plan but should be incorporated in all RFI responses, CTI alerts and CTI reports.

25

IDS/IPS, SIEM analytics
AD, NAC, VPN, Wireless

Weekly

Anomalous login activity detection increased by
20%

