From Susceptible to ATT&CK
A threat hunting story
November 12, 2019

Background
From St. Louis, Missouri
7 years in Information Security
IR / Digital Forensic Lab / Threat Intelligence / Design and Architecture /
Security Operation Center
Blue teamer at heart!

2

NOVEMBER 12, 2019

Agenda
3

Mitre ATT&CK doesn't need to be complex

What is threat hunting?

Phase 1 ­ before ATT&CK

Phase 2 ­ after ATT&CK

Q&A

NOVEMBER 12, 2019

Mitre ATT&CK
doesn't need to be complex
4

NOVEMBER 12, 2019

What is threat hunting?
What is threat hunting?
Definition:
Process of proactively and iteratively searching through systems to detect and isolate advanced threats that evade existing security solutions.
5

CREATE
Hypotheses

INFORM & ENRICH
Analytics

Threat Hunting
Loop

INVESTIGATE
Via Tools & Techniques

UNCOVER
New Patterns & TTPs

NOVEMBER 12, 2019

What is threat hunting?
Genesis of the program 1 We're in a good spot 2 Attended my first Defcon 3 Opportunity to do more!
6

NOVEMBER 12, 2019

Phase 1 ­ Before ATT&CK
Phase 1 ­ Before ATT&CK

7

NOVEMBER 12, 2019

Phase 1 ­ Before ATT&CK
Phase 1 ­ Before ATT&CK

Created deployable package to pull data
from hosts

Mainly pulled execution and autorun data
Slow!
~1000 hosts
per month

Moderately successful

8

NOVEMBER 12, 2019

Phase 1 ­ Before ATT&CK
Full-time? They said: "Show Me!"

©2019 Mastercard. Proprietary and Confidential

9

NOVEMBER 12, 2019

Phase 1 ­ Before ATT&CK
What do we do now?

New Program
10

Competing Priorities

PowerShell Remoting

NOVEMBER 12, 2019

Phase 2 ­ After ATT&CK
to the rescue!
Specific tactics At scale Low resource cost Covers major OS
11

NOVEMBER 12, 2019

©2019 Mastercard. Proprietary and Confidential

Phase 2 ­ After ATT&CK
Running enterprise-wide
Collecting host data from
30,000
hosts each month from both Windows and Macs
12

Little resource investment
Now responsible for finding
15%
of malware infections in 2019 in our environment
NOVEMBER 12, 2019

©2019 Mastercard. Proprietary and Confidential

Phase 2 ­ After ATT&CK
Summary
Created successful threat hunting program Minimal staff and resourcing required Doesn't need to be complicated Take advantage of the information provided
13

NOVEMBER 12, 2019

©2019 Mastercard. Proprietary and Confidential

