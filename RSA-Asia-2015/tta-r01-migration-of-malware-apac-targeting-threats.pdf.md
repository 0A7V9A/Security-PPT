SESSION ID: TTA-R01
Migration of Malware
APAC Targeting Threats

Tal Darsan
Threat and Intelligence Group Technical Lead IBM Security Systems

George Tubin
Program Director, Marketing IBM Security Systems @georgetubin

#RSAC

Agenda
 Dyre  Tsukuba  Now What?

Presenter's Company

Logo ­ replace on

master slide

2

#RSAC

#RSAC
Malware Popularity - 2014
 During 2014 there were 4 malware families that dominated the US financial threat landscape:
 Zeus  Bugat  Dyre  Neverquest
 Other malware families showed a declining number of attacks:
 Spyeye (and Tilon)  Qadars (the new Carpberp)  Tinba
3
Presenter's Company Logo ­ replace on master slide

#RSAC
Dyre Malware ­ 2014 Malware Numbers
4
Presenter's Company Logo ­ replace on master slide

#RSAC
Dyre Malware ­ Making Headlines
5
Presenter's Company Logo ­ replace on master slide

#RSAC
Dyre 2014 Milestones

June
First reports of attacks against US/UK targets

October
US Department of Homeland Security
Dyre Alert

December
Attacks against Targets in Australia
and China

Presenter's Company Logo ­ replace on master slide

September
Attack against salesforce.com

October
Attacks against Romanian, German
and Swiss Banks

November
Over 100 firms targeted

#RSAC
Dyre Malware ­ Global Distribution
Presenter's Company Logo ­ replace on master slide

Dyre Malware ­ Moving Out of the Cloud

Banking Website

MANUAL ATTACKS

Phishing / Criminal Device Use stolen credentials

Remote Control Tools Ride the session

Landing Page
- Redirect - Overlay Pharming

Login Page

My Information

Steal Credentials

Steal Personally Identifiable Information
Man-in-the-Browser Malware

AUTOMATED ATTACKS

Money Transaction
Automated Transaction

Presenter's Company Logo ­ replace on master slide

#RSAC

#RSAC
Anatomy of A Dyre Attack

#RSAC
Dyre Malware ­ Anatomy of an Attack

Phishing Email

Fake Banking Website

Banking Website

1
Victim's device gets infected with malware

2
Navigation to online banking website

3
Dyre diverts user to fake website

4
Credentials and PII are sent
to criminal

5
Login to online banking

6
Money transfer to
mule account

Presenter's Company Logo ­ replace on master slide

Dyre Phishing Emails
Presenter's Company Logo ­ replace on master slide

#RSAC

#RSAC
Fake website: Can you tell them apart?
A B
Presenter's Company Logo ­ replace on master slide

#RSAC
Fake website: Can you tell them apart?
A B
Presenter's Company Logo ­ replace on master slide

#RSAC
Dyre operators know as much about the user as you do
Example of data pulled by Dyre from infected device

User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0

Dyre collects...

==Programs==

· OS attributes · Browser attributes · Installed programs · Services · Passwords over secure
connection

Presenter's Company Logo ­ replace on master slide

Device Forging
Presenter's Company Logo ­ replace on master slide

#RSAC

#RSAC
Dyre toolkit compromises data used for detection

COMPROMISED
Remote Access Tools Device Spoofing

Device and Connection

Login Activity

Transactional Activity

COMPROMISED
Session Spoofing Proxy Usage

Presenter's Company Logo ­ replace on master slide

Engineered to Mimic Legitimate Activity

#RSAC
When combatting Dyre remember

Dyre bypasses anti-virus software
Infected customers will be diverted to a fake website
During an ATO attack, the criminal can "forward" authentication requests to the legitimate user
Dyre operators know as much about the user device as you do
Dyre toolkits can compromise session / device data
Presenter's Company Logo ­ replace on master slide

Segments of your customer base will be infected
Credentials will be compromised
Authentication can be compromised
Device ID is not effective
Inaccurate detection by traditional risk engines

Defending against Dyre attacks
Online Banking Endpoint Protection

#RSAC
ATO Detection

1
Victim's device gets infected with malware

2
Navigation to online banking website

Presenter's Company Logo ­ replace on master slide

3
DNS routing diverts user
to fake website or
proxy

4
Credentials and PII are sent
to criminal

5
Login to online banking

6
Money transfer to
mule account

Tsukuba

#RSAC

Banking Trojan Phishing in Japanese Waters

#RSAC
Tsukuba Malware
 Tsukuba is Japan's science city, also known for it's race course  It is also the name of a malware discovered by Trusteer researchers  The malware is focused on Japanese victims  The malware boosts advanced security evasion techniques
Presenter's Company Logo ­ replace on
master slide 20

Tsukuba's Technical Core

#RSAC

and Defense Mechanism

Tsukuba's Technical Core and Defense

#RSAC

Mechanism

 Installation upon cookies and browsing history  C&C servers are only reachable when using Japanese IP  Abusing Microsoft Windows certutil.exe and powershell.exe  Infected bots counter @ easycounter.com  Implements Anti research and Anti VM techniques  Browser proxy script (PAC) Installation  Fake root certificate Installation  Interactive Webfakes  Revert Mechanism
Presenter's Company Logo ­ replace on
master slide 22

#RSAC
Tsukuba's Installation flaw

Presenter's Company Logo ­ replace on master slide

VM

#RSAC
Defense Mechanism
 To evade research environments and proxy detection tools, Tsukuba looks for a list of running processes to avoid, and if one is indeed found, the malware will not complete the installation of all of its components:
 VboxService  VboxTray  Proxifier  Prl_cc  Prl_tools  Vmusrvc  Vmsrvc  Vmtoolsd
Presenter's Company Logo ­ replace on
master slide 24

Secure Proxy Browsing and Geolocation

#RSAC

Detection

 Only victims browsing from Japanese IPs will be let though to the Trojan's custom social engineering zones
 Tsukuba registers a fake root certificate in order to browse to malicious pages through its own rogue proxy.
 It sets up a root certificate on the PC with the exact same name as the original; typically, that name is: "VeriSign Class 3 Public Primary Certification Authority ­ G5"

Presenter's Company Logo ­ replace on
master slide 25

#RSAC
Tsukuba's PAC Installation
 Tsukuba performs HTTP-GET requests fetching the proxy PAC file
 The PAC file comes obfuscated to avoid security tools detection
Presenter's Company Logo ­ replace on
master slide 26

#RSAC
Tsukuba's PAC Installation (Cont.)  Deobfuscating the PAC file  PAC files reveals target list of 1 social network
and 20 Japanese Banking websites
Presenter's Company Logo ­ replace on
master slide 27

Tsukuba's Interactive Web-Fakes

#RSAC

 An example from Tsukuba's arsenal is a fake counter, likely designed to rush the victim to act, with detailed instructions on what to do next:

Presenter's Company Logo ­ replace on
master slide 28

#RSAC
Tsukuba's Interactive Web-Fakes (Cont.)  After victims enter their credentials, the pop-ups
proceed to ask the victim for personal details and to upload clear images of their official documentation and passport.
Presenter's Company Logo ­ replace on
master slide 29

#RSAC
Closing Thoughts

Keys To An Effective Solution

Real Time Intelligence · Global: identify threats
any time, anywhere for all channels · Integrated: fully integrated to leverage threat data across channels

Advanced Fraud
Prevention

Seamless Experience
· Transparent: minimize "action items" to user
· Automated: minimize "action items" to staff
Presenter's Company Logo ­ replace on master slide

#RSAC
Accurate Analysis · Focused: root cause · Impactful: prevent,
detect, mitigate and remediate
Adaptive Controls · Intelligent: build with
the "unknowns" in mind · Dynamic: rapidly
updatable software

#RSAC
Apply What You Have Learned Today

 Next week you should:  Identify the risks your organization faces due to evolving web fraud methods
 In the first three months following this presentation you should:  Quantify and prioritize the risks associated with customer web sessions and transactions  Develop a plan to mitigate identified risks
 Within six months you should:  Select a fraud prevention system that mitigates identified risks, while causing minimal operational and customer impact  Continue to assess the changing threat landscape and associated risks

Presenter's Company

Logo ­ replace on

master slide

32

Statement of Good Security Practices: IT system security involves protecting systems and information through prevention, detection and

#RSAC

response to improper access from within and outside your enterprise. Improper access can result in information being altered, destroyed,

misappropriated or misused or can result in damage to or misuse of your systems, including for use in attacks on others. No IT system or product

should be considered completely secure and no single product, service or security measure can be completely effective in preventing improper use

or access. IBM systems, products and services are designed to be part of a lawful, comprehensive security approach, which will necessarily

involve additional operational procedures, and may require other systems, products or services to be most effective. IBM DOES NOT WARRANT

THAT ANY SYSTEMS, PRODUCTS OR SERVICES ARE IMMUNE FROM, OR WILL MAKE YOUR ENTERPRISE IMMUNE FROM, THE

MALICIOUS OR ILLEGAL CONDUCT OF ANY PARTY

www.ibm.com/security
© Copyright IBM Corporation 2015. All rights reserved. The information contained in these materials is provided for informational purposes only, and is provided AS IS without warranty of any kind, express or implied. IBM shall not be responsible for any damages arising out of the use of, or otherwise related to, these materials. Nothing contained in these materials is intended to, nor shall have the effect of, creating any warranties or representations from IBM or its suppliers or licensors, or altering the terms and conditions of the applicable license agreement governing the use of IBM software. References in these materials to IBM products, programs, or services do not imply that they will be available in all countries in which IBM operates. Product release dates and/or capabilities referenced in these materials may change at any time at IBM's sole Predsisecnrtetri'osnCobmaspeadnyon market opportunities or other factors, and are not intended to be a commitment to future product or feature availability in any Lwoagyo.­IrBeMpla, ctheeonIBM logo, and other IBM products and services are trademarks of the International Business Machines Corporation, in the United Stamtaesst,eor tshliedrecountries or both. Other company, product, or service names may be trademarks or service marks of others.

