SESSION ID: TTA-R08
Good Bot, Bad Bot, Ugly Bot. Battle of the Bots!

John Ellis ­ 
Chief Strategist, Cyber Security (APJ) Akamai Technologies @zenofsecurity

#RSAC

#RSAC
About me
 Kiwi (New Zealander)  20+ years experience in IT security (trained sheep to hack)  Have worked in defence, telecommunications and banking  Consider myself a student, but love to share what I know  9 years in Singapore, and see we're still trying to find the Asian
solution to the Asian problem (talk to me afterwards if you want to know more).  Still `trying' to learn Mandarin....might one day get there
2

#RSAC
Cyber `buzz' bingo

Cyber IoT TTPs APT BOT

SaaS

Threat Intel

Cloud

BOYD

Cyber Kill Chain

Innovation

Big Data

Breach

Signal to noise Cross-Platform

SMAC

Next-gen

China

Data Driven

Thought Leaders

Cyber Attack

Game Changer

PaaS

Cyber Crime

Hacktivist

#RSAC
What is a bot?
A software application that automates tasks that are simple and structurally repetitive at much higher rates or precision than a human.

Bot trends & environment
Good

#RSAC

Bad Bots

Account for 29% of all

website visits

22% fraud activity

Bad

3.5% Hacking tools

Aggregator, media bots

Search engine, crawlers, spider bots

44% Human Partnertbroatfsfic

Vulnerability scanner, Site

performance bots

Sp5a6m%boBtsot traffic
Scraper bots

3% scrapers Hacker, Fraud bots

0.5% Spammers DDoS bots

Good Bots

Account for 27% of all

website visits

Source: Incapsula / Akamai

Good bots
Marketing
Vulnerability Scanners

Search engine optimization (SEO)

#RSAC

Performance analysis tools

Bad bots
Fraud
Malware Spam (it ain't ham)

Vulnerability scanners
Scrapers (your competitors)
DDoS attacks
Did I mention malware?

#RSAC

#RSAC
Ugly `naughty' bots

Scrapers

Want to know everything about you

Too Friendly

Price Aggregators
Crawlers Malicious? Maybe, Maybe not

#RSAC
SPAM Bots

Target marketing

Improve SEO
9

Malware distribution

Fraud

#RSAC
Scraper Bots (an example)
Scraping Service / Tools
Aggregator Website
10

#RSAC
Commercial Scraping Services / Tools
kimono
11

The BOT evolution

Desktop

Server

Cloud

#RSAC

Mobile

Internet of Things (IoT)

12

#RSAC
DDoS Bots
DDoS attacks instances plotted over time Q113-Q115
Source: Akamai SOTI Security Report Q1 2015
13

#RSAC
Top 10 Source Countries for DDoS Attacks

China
1.4 billion people

German 17.3%

642 million8Ip.t3ae8loy%ple online

Over 50% of syst6Ien.9md3i%as infected with virus1e2Us.1.S8.%

Russia 5.95%

9 oUu.tK.10 Windows systeSmpasinpirated

6.17%

7.29%

70% of WKionrdeaows systems never patched

6.23%

France

6.03%

14

China 23.45%

#RSAC
DDoS 4 Bitcoin (DD4BC)

Who, What, Where & How

Who are the targets?

 DD4BC (DDoS For Bitcoins)  Online ransom group  Not ransomware  No other attribution  Publicly available DDoS toolkits &
rented botnets in the underground

4% 7%
15%
74%

Banking & Credit Unions Gaming Media & Entertainment Payment Processing

15

#RSAC
Great Canon (GC) of China
 An in-path system, capable of injecting traffic and directly suppressing traffic
 Acting as a full "man-in-Cthoedi-ng error provides clue as to how to detect middle" for targeted flowasnd filter traffic. Example of cat and mouse game
 `Harnesses' legitamate web browsing traffic for attack capability and capacity Targets of http get flood DDoS attack
Source: https://citizenlab.org/wp-content/uploads/2009/10/ChinasGreatCannon.pdf
16

#RSAC
Value of a hacked PC (Brian Kerbs)

Phishing site Malware download site Warez / Piracy server Child pornography server
Spam site

Web Server

Bot activity

Spam zombie DDoS extortion zombie
Click fraud zombie Anonymization proxy Captcha solving zombie

Webmail spam Stranded aboard scam Harvesting email accounts Harvesting associated
accounts
Online gaming characters Online gaming goods PC game licenses OS licence keys

Webmail

Spam zombie

Account

DDoS extortion zombie credentials

Click fraud zombie

Virtual

goodCsAapntocnhyamsiozlavtiinognzpormoxbyie

Financial credentials

Ebay / paypal fake auction Online gaming creds Skype / VoIP creds Website / FTP creds
Client side encrypt certs
Bank account data Credit card data Stock trading account data Mutual fund account data

Facebook Twitter Linkedin Google+

Reputation hacking

Hostage attacks

Email account ransom Fake antivirus Ransomware
Web cam extortion

Source: http://krebsonsecurity.com/2012/10/the-scrap-value-of-a-hacked-pc-revisited/
17

#RSAC
Using Botnets to access market insights

Investors

Legal return on investment Illegal access to information

Managers / Analysts

Legion / infantry / operators

Source: Interpol

18

#RSAC
Account checkers and Fraud

How does this evil deed typically happen?

1

Builds tools server

2

Cultivate list of open proxies

3

Acquire compromised logins

4 Check / alter compromised accounts

5

Make fraudulent purchase

 COAArAattttptobaatiadcmtcaklkcyepeiknrcrsreshomleruimscsaskyteiostmovhbeafeotrdwaivweifaiyteneylitdbhbohietfypastsoorerhoofvirpltsexvhpiiesetneotgrsed /

 UOsaapductspodrccoreelheeuasnnbnssteuspocs.flrlrwteoheiexttdhpiveetrihcosnetiomitraifasalthllonosrdoewfsmdrtoairinonkmfeougrmtsweaitieitohsn.

 
 

p...caPssuMAtcOcTnRephoreluhluucerrneneeroarleaoocccldoccdcfderaoeutfnehmxuerixhcitentuodachdntiytnelitannesoreletita?ryictegdiehsgcacsusasksgehgnrolathnsetiItaoesfhnauatPm.prtnddasucvstceldahketeeeaeinlbieneeosswrrrnboyd,dre'lgdgstaoesgtaenaihreirs,pcsnnrkttobeenebedhoksiuatouirekaelnpesmstreintbtahneisoito,scyntsaenedpktmt.giocisoleahtmynekarodtlyfaehmatosrdafnfiurkevioasrrcspaesaoutanf.idacdloklamm,adraabtnarnhnlesenddse,ds

 Lascfdurieotfrefttidlhcaaluietdcslrtckutfasorcracdtuhrradiincpifneotsfaromn...rdamterioeaansatytidootoynutsrtaeonfsogproort.

Source: https://www.akamai.com/us/en/multimedia/documents/infosec/akamai-security-and-compliance-account-checkers-and-fraud.pdf
19

#RSAC
Account checkers and Fraud
20

#RSAC
How to manage em' BOTS

#RSAC
Block, Mitigate or Manage?
Blocking BOTS causes them to go underground, mutate and harder to detect
Not sure if bot......or
Management strategies vary depending on the nature of the BOT and it's goal
Stupid human?

#RSAC
TTPs for the Good, Bad and Ugly

Reduce Impact

Terminate with extreme prejudice

Aggressiveness

Welcome Bots

Client Validation

Desirable

Degrees of Desirability

Undesirable

BOT Response Methods

#RSAC
Solution Landscape (what can you buy)
From a technology perspective:

Slow BOT/ Serve Alt./
etc.

HTML Obscuring/
Rewriting

BOT Obfuscation

CAPTCHA

Alert/ Deny

Cloud WAFs On Prem WAFs

Avoid data theft and downtime by extending the security perimeter outside the data-center and protect from increasing frequency, scale and sophistication of web attacks.
Cloud BOT Mgt.

No BOT Detection

Rate Based Detection

Cross Customer Header/IP Based Tracking

BOT Detection Methods

Cross Customer Fingerprint Based Tracking Advanced BOT Evasion Traps

#RSAC
Cooking your BOT management program

Detection

Avoid data theft and downtime by extending the security perimeter outside the data-center and protect from increasing frequency, scale and sophistication of web attacks.

Learnings

Mitigation

#RSAC
Bot Detection Methods
 Client reputation  Client and browser fingerprinting  HTTP header anomaly detection  JavaScript Injection  JS BOT evasion traps  Behavioral Analysis

#RSAC
Bot Response Methods
 IP blocking  Geo blocking  Rate controls  Web Application Firewall Rules  Obfuscation for HTML, JS, URL and Form  Serve slow, stale, alternate, tar pit  CAPTCHA challenge

#RSAC
Bot Learnings
 BOT scoring, categorization and trends
 Crowd sourcing of new BOTS www.botopedia.org
 Resource usage by BOT
 Input into evolving your detection and mitigation tactics
 Understand the cost of your mitigation strategies

#RSAC
7 Key Ingredients to Succeed (today)
1. Scale your defenses with a Cloud WAF
Extend your perimeter beyond your site
2. Reverse Proxy
Automatically drops traffic not on port 80 or port 443
3A.voGideod-abtaastehdefbtlaonckdindgowntime by extending the
secRuerfuitsye preeqruimestestferormocuutsstiodmeert-hseeledctaetdal-iscteonf cteournatrnieds protect from increasing frequency, scale and
4s.opVhaislitdicaatetioangaoifnwstekbnaotwtancklsis.t of attackers
Positive or negative security model (black or white lists)
5. Rate Controls
Block requests that are too fast or too slow (anomaly scoring)
6. Data driven WAF
WAF rules continuously refined based on visibility into web
7. Caching
Dynamic and static caching to serve requests

#RSAC
Looking ahead
 Good Bots are an essential part of our Internet ecosystem  It's an arms race, and you need to have a clear strategy  If you don't have a WAF....get one!!!  Threat intel (bingo) is vital in understanding. Learn from others  Now you've got a strategy, have a plan and rehearse it!  It's hard...but understand what normal looks like (try..please)  Think active defense...be smart in how you operate

#RSAC
Friend or Foe? You need to decide

#RSAC
I would like to thank
 Mike Smith (Akamai APJ Security CTO)  Patrick Laverty (Akamai CSIRT)  Mike Kun (Akamai CSIRT)  Dave Lewis (Akamai Global Security Advocate)  ....and Akamai's customers and competitors (they keep me honest)  
32

