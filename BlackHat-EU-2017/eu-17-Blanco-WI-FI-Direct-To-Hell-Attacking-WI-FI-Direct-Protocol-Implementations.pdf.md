Wi-Fi Direct to Hell
Andrés Blanco

Andrés Blanco 6e726d@gmail.com @6e726d
Whoami
Interests and expertise include network security, reverse engineering, and privacy. I enjoy playing with IEEE 802.11 security.

What?
Wi-Fi Direct specification defines the architecture and protocols to facilitate device-to-device connectivity based on the IEEE 802.11 infrastructure mode.

· Wi-Fi Direct can be use by an attacker to access a device.
· Devices supporting the protocol extends the IEEE 802.11 attack surface.
Why?
· There are several vendors that have implemented the protocol in an insecure way.

Wi-Fi Alliance
· WPS (Wi-Fi Protected Setup) · Wi-Fi Display · Wi-Fi Direct · Hotspot 2.0

Wi-Fi Direct
2010 2011 2012 2013 2014 2015 2016 2017
First public release of the technical specification
https://www.wi-fi.org/discover-wi-fi/wi-fi-direct

Wi-Fi Direct
2010 2011 2012 2013 2014 2015 2016 2017
13280 Wi-Fi Direct certified products
https://www.wi-fi.org/discover-wi-fi/wi-fi-direct

Wi-Fi Direct
· P2P Discovery · P2P Group Operations · P2P Legacy Support

Infrastructure Mode

STA

STA

AP

STA

BSS

STA

STA

BSS
Ad Hoc Mode

Wi-Fi Direct

STA

STA

STA

BSS

Wi-Fi Direct

STA

STA

AP

BSS

STA
BSS

Wi-Fi Direct
STA
BSS

802.11 Discovery

802.11 Discovery

P2P Discovery

P2P Discovery

P2P Discovery

P2P Discovery

P2P Group Formation

P2P Group Formation

TL-WN722N

Interface Requirements

wpa_cli

android

kismet

airodump-ng

wig

Monitor P2P Devices

HP Printers

HP Printers

HP Printers

Samsung Printers

Samsung Printers

Samsung Printers

Samsung Smart TV

Samsung Smart TV

WD TV Live

WD TV Live

WD TV Live

Android

Android
Firmware Kernel
User Space
wpa_supplicant
android framework

Android

Android

Availability
https://www.flickr.com/photos/ell-r-brown/

Confusion
https://www.flickr.com/photos/wwward0/

Weakest Link
https://www.flickr.com/photos/smithser/

Bridge
https://www.flickr.com/photos/lennykphotography/

Attack Surface
https://www.flickr.com/photos/fearless_fred/

Questions

https://github.com/6e726d/BHEU17

6e726d@gmail.com

@6e726d

