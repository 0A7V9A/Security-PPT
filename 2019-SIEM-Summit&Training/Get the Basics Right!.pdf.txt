Get The Basics Right! Improving detection capabilities with SIEM
SIEM Summit & Training 2019

Balaji Nakkella
November 1, 2018 Vancouver, BC

Get The Basics Right!

Slide 2 of 39

Rakesh Kumar Narsingoju

November 1, 2018 Vancouver, BC

Get The Basics Right!

Slide 3 of 39

Get The Basics Right! What/How to choose?

Get The Basics Right!

Slide 4 of 39

Get The Basics Right! The Magic Quadrant

Get The Basics Right!

Slide 5 of 39

Get The Basics Right! Buying a SIEM - What we have

Get The Basics Right!

Slide 6 of 39

Get The Basics Right! Deployed SIEM - Expectation vs Reality

Get The Basics Right!

Slide 7 of 39

Get The Basics Right! Key Elements
Threat Intel

Assets

Crown Jewels

Rules

Log sources

Identities
Get The Basics Right!

Slide 8 of 39

Get The Basics Right! Key Challenges
1. Assets ­ what to protect 2. Crown Jewels ­ Protecting a pawn vs Protecting a king 3. Identities ­ who are your players 4. Data Sources ­ what to log 5. Rules ­ what to detect 6. Threat Intel ­ whom to rely on

Get The Basics Right!

Slide 9 of 39

SIEM Deployment Checklist A holistic view

Get The Basics Right!

Slide 10 of 39

Improving detection capabilities using SIEM SIEM Deployment Life Cycle

 Neither industry nor vendor specific

 Non exhaustive

Plan

 Detection centric

Evolve

SIEM

Deploy

Enhance

Get The Basics Right!

Slide 11 of 39

SIEM Deployment checklist Phase #1: Plan

 Start with Governance, Risk Management and Compliance

Business Risks

Regulatory Risks

 Review existing Security Controls

Risks

Preventive Detective Corrective

(Business/Regulatory)

Get The Basics Right!

Slide 12 of 39

SIEM Deployment checklist Phase #1: Plan

 Use of Cyber Security Framework(s)

 Identify and Review existing frameworks

 Implement

 Control/ Program/ Risk Frameworks

 PCI DSS, ISO, CIS, NIST etc. to start with

 Shortlist use cases

Risk

Use case name

Description

Log source

Get The Basics Right!

Slide 13 of 39

SIEM Deployment checklist Phase #1: Plan

 Finalize log sources and their logging levels

Log source

Logging level

 Shortlist Threat Intel feeds
 Relevance  Variety (IPs, Hashes, URLs, Domains)  Output format(s)
 Shortlist and finalize SIEM products based on requirements
 In-house skillset
 Select Ticketing tool, if required

Get The Basics Right!

Slide 14 of 39

SIEM Deployment checklist Phase #2: Deploy
 SIEM Architecture Design based on organization's network architecture  Implementation of approved design  Data onboarding
 Add context to raw logs  Parse ­ Verify ­ Ingest
 Threat Intel feed integration
 Test ­ Deploy
 Use case development
 Develop ­ Test ­ Deploy
 Ticketing system integration
Get The Basics Right!

Slide 15 of 39

SIEM Deployment checklist Phase #3: Enhance
 Use case Tuning - False positive reduction
 Scripts  Security expertise and processes  Analytics
 Additional detection tools
 IPS/IDS (Cisco, PA, FortiGate, Fidelis, Juniper, Checkpoint,...)  Endpoint Detection & Response (CrowdStrike, Carbon Black, FireEye,...)  Email protection (Proofpoint, IronPort, Symantec,...)  AV solutions (McAfee, SEP,...)  Vulnerability Scanners (Qualys, Nessus,...)  Web Proxy(Bluecoat, Websense,...)
Get The Basics Right!

Slide 16 of 39

SIEM Deployment checklist Phase #4: Evolve

Deloitte Omnia ­ In house AI driven Product development team

IAM Analytics

APM

Get The Basics Right!

Slide 17 of 39

SIEM Deployment checklist Attack Path Modelling
 Become more proactive in your strategy and increase the ability to stop attacks even before they occur
 Provides current state and scenario-based analysis of threats and control failures on technology assets
 Leverages AI to drive recommendations that provide a variety of options for remediation and risk mitigation while showing how each action affects your risk score

Get The Basics Right!

Slide 18 of 39

SIEM Deployment checklist APM ­ Key Differentiators
Predict vulnerable entry points and the path of least resistance
Identify vulnerable technology assets leading to increased risk exposure to an attack
Automate remediation through integration with orchestration solution

Visualize a path an attacker might use to traverse the network
Prioritize a remediation strategy through risk ranking
Develop simulated attack path models through scenario analysis

Get The Basics Right!

Slide 19 of 39

SIEM Deployment checklist IAM Analytics - AI Enabled RBAC
 IAM Analytics is an Artificial Intelligence enabled solution that closely monitors how end users consume the IAM recommendations.
 We utilize an intuitive GUI that prompts key business context to end users, delivering a phenomenal user experience.
 Our state of the art advanced analytics engine is powered with closed loop feedback mechanism to enable Machine Learning as we scale operations and is configurable based on your preferences.

Get The Basics Right!

Slide 20 of 39

SIEM Deployment checklist Current pain points vs IAM Analytics Benefits

Lack of a sustainable role maintenance process potentially resulting in inappropriate access
Human analysis of complex data patterns may lead to sub-optimal role definitions
Time-consuming and manual role definition/maintenance processes result in low operational efficiency

Enhanced logical view of access to help ensure that the right people have the right access
Improved user experience in the organization's IAM platform, injected with logical and business context
Increased operational efficiency, including reduced administrative effort across business and technology lines

Get The Basics Right!

Slide 21 of 39

Scenario #1
Prioritized Asset and Identity Inventory

Get The Basics Right!

Slide 22 of 39

Prioritized Asset and Identity Inventory Know "Who" and "What" to protect

Get The Basics Right!

Slide 23 of 39

Prioritized Asset and Identity Inventory Alert Fatigue
Old school technique:
Assign severities to use cases One to one mapping of Severity to Priority Minimize SLA breaches
Drawbacks:
 SLA breaches/ Higher dwell times
How do we address?

Get The Basics Right!

Slide 24 of 39

Prioritized Asset and Identity Inventory First Things First approach

Legend: C-Criticality, S-Severity, P-Priority
Get The Basics Right!

Slide 25 of 39

Prioritized Asset and Identity Inventory The *hidden treasure!

Asset Inventory

Hostname IP

MAC

Owner

*Critical

Category OS

(C/H/M/L)

Identity Inventory
Username Email

Business Unit

*Role

Domain

Others

Get The Basics Right!

Slide 26 of 39

Prioritized Asset and Identity Inventory Benefits
 Event enrichment ­ False Positive reduction  Effectively handle alert fatigue  Prioritized alerts ­ Reduce dwell time

Get The Basics Right!

Slide 27 of 39

Scenario #2 Health Monitoring

Get The Basics Right!

Slide 28 of 39

Health Monitoring Scenario

Get The Basics Right!

Slide 29 of 39

Health Monitoring Scenario
Why?
 Reporting vs. Non reporting ­ Compliance  Avoids potential true positive miss ­ Security
General approach
 Level of detail till log collector(s)
Limitations
 Visibility only to Aggregator/Collector level

Get The Basics Right!

Slide 30 of 39

Health Monitoring Scenario

Get The Basics Right!

Slide 31 of 39

Health Monitoring Scenario

Get The Basics Right!

Slide 32 of 39

Health Monitoring Solution
What if we proceed to the host/log source level?
 Different sources have different logging frequencies  Use cases at source level impacts SIEM productivity
Solution
 Configure alerts for P1 sources  Schedule Daily/Weekly reports for P2/P3 sources
Benefits
 Reduced downtime  No Alert fatigue

Get The Basics Right!

Slide 33 of 39

Scenario #3 Identifying blind spots

Get The Basics Right!

Slide 34 of 39

Identifying blind spots Example
List of use cases Sources Sending Many DNS Requests High Volume Email Activity to Non-corporate Domains by User Multiple Authentication Failures Suspicious Domain/IP Communication Unusual Geolocation of Communication Destination Emails with Look alike Domains Web Uploads to Non-corporate Sites by Users Unusual Volume of Network Activity Detect Use of cmd.exe/ps.exe to Launch Script Interpreters Detect USB Usage/insertion Hosts Sending To More Destinations Than Normal

Get The Basics Right!

Slide 35 of 39

Identifying blind spots Enrich

Use case
Sources Sending Many DNS Requests
High Volume Email Activity to Noncorporate Domains by User Multiple Authentication Failures
Suspicious Domain/IP Communication
Unusual Geolocation of Communication Destination Unusual Volume of Network Activity
Web Uploads to Non-corporate Sites by Users Emails with Look alike Domains
Detect Use of cmd.exe/ps.exe to Launch Script Interpreters Detect USB Usage/insertion

Threat Category
Insider Threat, Advanced Threat Detection Insider Threat, Advanced Threat Detection Insider Threat, Advanced Threat Detection Insider Threat, Advanced Threat Detection Insider Threat, Advanced Threat Detection Insider Threat, Advanced Threat Detection Insider Threat
Advanced Threat Detection
Advanced Threat Detection
Insider Threat

Hosts Sending To More Destinations Than Normal

Advanced Threat Detection

Kill Chain Phase
C2, Action on Objectives Action on Objectives None None None None Action on Objectives Delivery Exploitation Installation, Delivery Reconnaissance
Get The Basics Right!

Slide 36 of 39

Identifying blind spots Transform

Kill Chain Phase APT

Insider Threat

Reconnaissance

Hosts Sending To More Destinations Than Normal

Weaponization

Delivery

Emails with Look alike Domains

Detect USB Usage/insertion

Exploitation Installation

Detect Use of cmd.exe/ps.exe to Launch Script Interpreters

Detect USB Usage/insertion

Command & Control Actions on Objectives
None

Sources Sending Many DNS Requests

Sources Sending Many DNS Requests

Sources Sending Many DNS Requests, High Volume Email Activity to Non-corporate Domains by User
Multiple Authentication Failures, Suspicious Domain/IP Communication, Unusual Geolocation of Communication Destination, Unusual Volume of Network Activity

Sources Sending Many DNS Requests, High Volume Email Activity to Non-corporate Domains by User, Web Uploads to Non-corporate Sites by Users Multiple Authentication Failures, Suspicious Domain/IP Communication, Unusual Geolocation of Communication Destination, Unusual Volume of Network Activity

Get The Basics Right!

Slide 37 of 39

Identifying blind spots Model | List ­ Enrich ­ Transform

Reconnaissance

APT

Weaponization

Delivery

Exploitation

Installation

Command & Control

Actions on Objectives

Insider Threat Data protection others

Get The Basics Right!

Slide 38 of 39

Thank You!
Balaji Nakkella - linkedin.com/in/balajinakkella/ Rakesh Kumar Narsingoju - linkedin.com/in/rakesh-narsingoju

Get The Basics Right!

Slide 39 of 39

