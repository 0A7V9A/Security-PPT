SESSION ID: CRWD-T11
Hide and Seek: How Threat Actors Respond in the Face of Public Exposure
#RSAC

Kristen Dennesen
Senior Intelligence Analyst FireEye, Inc. @FireEye

#RSAC
Show of Hands
Have you ever been directly involved in a public white paper or blog about a threat actor?

#RSAC
Show of Hands
Do you use vendor white papers or blogs to develop better situational awareness about threats to your organization?

#RSAC
Research Question
How do threat groups respond when their operations are exposed in public reporting?

#RSAC
Bottom Line Up Front
Public exposure is a major trigger for behavioral change

#RSAC
Apply
By the end of this presentation you'll be able to...
Evaluate the impact of a blog or white paper on an adversary's future operations

Road Map
Photo: Ryan Cadby @ryancadby on Flickr

#RSAC
Introduction Key Concepts Case Studies Call to Action

#RSAC
A Tug of War

Intelligence collection vs.

Computer network defense

Photo: William James ca. 1920 City of Toronto Archives

#RSAC
Why Does Exposure Matter?
Public spotlight creates a flashpoint of awareness of a group's ops, TTPS
Security vendors sprint to detect publicized activity Net defenders more likely to hunt in their networks for evidence of a group, employ new IOCs or detection methods
Exposure triggers public awareness and increases threat groups' risk of detection/discovery.

#RSAC
Why Does Exposure Matter ­ Big Picture
What ethical boundaries and obligations do security researchers face? Are we cultivating better OPSEC in the actors we expose? What is the best way to share? Mission vs. Marketing

#RSAC
Key Concept
Threat Shifting
"Response from adversaries to perceived safeguards and/or countermeasures, in which the adversaries change some characteristic of their [operations] in order to avoid and/or overcome those safeguards/countermeasures"
-- NIST Special Publication 800-30: Guide for Conducting Risk Assessments

#RSAC
Threat Shifting in Nature
Evolution to reduce the risk of predation
Mimickry: Heliconius butterflies mimic wing coloration patterns to signal toxicity to predators

#RSAC
Threat Shifting in Information Security
Examples of Threat Shifting
Evolution of banking Trojans from clumsy keyloggers to highly flexible webinject offerings Adoption of Powershell and WMI for lateral movement and backdoor functionality

#RSAC
Four Domains for Adaptation
Threat shifting occurs across four domains:

TIMING

TARGETS RESOURCES

Image Sources: Public Domain @o5com on Flickr; Andrew Magill @amagill on Flickr

PLANNING & METHODS

#RSAC
Trigger Points for Threat Shifting
Exposure Remediation
Detection

A caveat...

#RSAC
Our observations are based on FireEye's visibility.

#RSAC
Research Question
How do threat groups respond when their operations are exposed in public reporting?

#RSAC
They know.
Threat groups are often keenly aware of research & reporting on their operations.

#RSAC
They know.
APT28 signals they are aware of security researchers' blogs (and none too pleased...)
July 2015 blog on APT28 spear phishing campaign that leveraged a Java zero-day Within 1 day, APT28 updated DNS info for domain hosting exploit to point to TrendMicro's IP space
* APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium

#RSAC
Keenly aware of research and reporting
Threat Actors Read the News, Too.
APT1: Major interruption to APT1's operations
Careto/Mask: "...after the post was published, the Mask operators shut everything down within about four hours"
APT3 aka UPS: Changed tactics on the fly in direct response to FireEye blog

#RSAC
Keen awareness: APT29

APT29 aka the Dukes, CozyDuke, TEMP.Monkey, Cozy Bear
Security researchers likely analyzing samples; probing staging server

July 7, 2015
Phish sent: National Endowment for Democracy lure

July 14, 2015
Payload files deleted from compromised server

July 3, 2015
Downloader compiled

July 8, 2015
Phish payload submitted to VT

July 14, 2015

#RSAC
Not only are they keenly aware...
Some actors actively
seek to MANIPULATE
public perception.

#RSAC
Public reports can be deeply disruptive to a threat group's operations... or not.
Incentives matter.

#RSAC
FIN4: Cybercriminals Playing the Market
FIN4: Targeted 100+ organizations in seek of information that would convey a stock trading advantage

#RSAC
Can't Take the Heat: FIN4 Halts Operations
FIN4 REPORT PUBLISHED
Dec. 1, 2014

Summer 2014
· Incident response at victims · Similar TTPS and targets

Summer ­ Fall 2014
· FIN4 actively targeting new victims
· Adds dozens of new targets in week prior to public report

FIN4 DISCONTINUES OPS
Dec. 2014
· FIN4 appears to shut down entirely

#RSAC
APT28: Collecting Intelligence for a State Sponsor
APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium
APT28: global intelligence collection operation targeting information tightly aligned w/ Russian government interests.

#RSAC
APT28: Keep on Truckin'

APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium

20+

Reports examining APT28 TTPS Oct. 2014 ­ Oct. 2015

Timeline of APT28 Exposures

Public report examining APT28's operations

#RSAC
APT28: Keep on Truckin'
APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium
In spite of repeated exposure APT28 has sustained operations

Timeline of APT28 Exposures

Public report examining APT28's operations

APT28: Keep on Truckin'
APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium

December 2014
· Streamlined redirection scripts
· Employed campaign identifiers

March 2015
· Password reset theme employing bit.ly
· Links configured to look like legit Google URLs

#RSAC
August 2015
· Abuse of Yahoo OAuth service to enable phishing
· Phishing e-mails point to legit Yahoo URL

Timeline of APT28 Exposures

New Phishing Tactic Observed

#RSAC
Incentives Matter.
Opportunistic vs. Requirements Driven

#RSAC
Public reports are a common trigger for retooling

#RSAC
APT12: "Darwin's Favorite APT Group"
APT12 aka DNSCALC, IXESHE, CALC Team, DynCalc, Numbered Panda

· Jan. 31, 2013: New York Times exposes APT12 intrusion in their environment
- Exposure triggered brief pause in activity and immediate changes in TTPs
· June 6, 2014: APT12's RIPTIDE aka Etumbot backdoor is the subject of a comprehensive white paper
- White paper triggered rapid shift in toolset.

New York Times -- Jan. 31, 2013

#RSAC
APT12 Retools After RIPTIDE White Paper
APT12 aka DNSCALC, IXESHE, CALC Team, DynCalc, Numbered Panda
June 2014
Arbor Networks Paper on RIPTIDE aka Etumbot

RIPTIDE aka Etumbot, Shoco

HIGHTIDE

5/6/13

11/22/13

6/10/14

12/27/14

7/15/15

1/

#RSAC
APT12 Retools After RIPTIDE White Paper
APT12 aka DNSCALC, IXESHE, CALC Team, DynCalc, Numbered Panda
June 2014
Arbor Networks Paper on RIPTIDE aka Etumbot

RIPTIDE aka Etumbot, Shoco

WATERSPOUT HIGHTIDE

5/6/13

11/22/13

6/10/14

12/27/14

7/15/15

1/

#RSAC
Operation SMN -- Axiom Group Interdiction
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda
More than an exposure effort:
- Coalition sought to eradicate specific `high value' tools and make it more expensive for APT17 to operate
- Coordinated action was accompanied by public materials to aid detection and educate victims
Operation SMN coalition went into the effort with eyes wide open:
- Acknowledged from outset that APT17 was skilled, equipped to adapt and would very likely retool

#RSAC
Operation SMN sought to KNOCK OUT APT17'S high value tools such as HIKIT

#RSAC
Before and After Operation SMN
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda

HIKIT

6-May-13

22-Nov-13

August 2014
Last observed HIKIT compile date

10-Jun-14

27-Dec-14

Legend Timespan Observed (based on malware sample compile times)
15-Jul-15

#RSAC
Before and After Operation SMN
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda

HIKIT
6-May-13

September 28, 2014
Last observed sample created on victim host

22-Nov-13

10-Jun-14

27-Dec-14

Legend Timespan Observed File created on victim host
15-Jul-15

#RSAC
Before and After Operation SMN
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda
October 2014
Operation SMN Public Action
HIKIT

6-May-13

22-Nov-13

September 28, 2014

Last observed sample created on victim host

z

10-Jun-14

27-Dec-14

Legend Timespan Observed File created on victim host
15-Jul-15

#RSAC
Before and After Operation SMN
October 2014
Operation SMN Public Action

HIKIT

6-May-13

22-Nov-13

10-Jun-14

z
27-Dec-14

15-Jul-15

#RSAC
Before and After Operation SMN
October 2014
Operation SMN Public Action

RAYGUN HIKIT

MUGBRAIN

6-May-13

22-Nov-13

10-Jun-14

z
27-Dec-14

15-Jul-15

Before and After Operation SMN

HIGHNOTE

RAYGUN

HIKIT

BLACKCOFFEE aka ZoxPNG

LONEAGENT aka Fexel PHOTO aka Derusbi

SOGU aka PlugX, Kabas

MUGBRAIN

October 2014
Operation SMN Public Action SCARYMOVIE
SIDEWINDER HIGHNOON aka Winnti

6-May-13

22-Nov-13

10-Jun-14

z
27-Dec-14

#RSAC 15-Jul-15

#RSAC
Before and After Operation SMN
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda
October 2014
Operation SMN Public Action
LONEAGENT aka Fexel

Legend

Timespan Observed

2

5/6/13 (based on malware sample
compile times)

11/22/13

6/10/14

z
12/27/14

7/15/15

#RSAC
Before and After Operation SMN
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda

LONEAGENT aka Fexel

October 2014
Operation SMN Public Action
February 2015
APT17 begins consistently armorizing LONEAGENT samples

Legend

Timespan Observed

2

LONEAGENT5w//6R/C41C3rypto

11/22/13

6/10/14

z
12/27/14

7/15/15

#RSAC
Before and After Operation SMN
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda
Quick retooling and adaptation

#RSAC
As part of retooling, threat actors can turn on a dime

APT3 Modifies Attack Following Release of Operation

#RSAC

Clandestine Wolf

APT3 aka UPS, Gothic Panda

Clandestine Wolf Blog
June 23, 2015

One Day Later
APT3 continued, with modifications:
Created new phishing emails
Removed mechanism to profile end user systems
Modified filenames of files used for exploitation
Altered shellcode
Compiled new payloads with updated C2; increased obfuscation

#RSAC
The path of least resistance rules.
"If it ain't broke, don't fix it."

#RSAC
APT17: Hiding in Plain Sight Redux
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda

May 2015 FireEye and Microsoft coordinate takedown of BLACKCOFFEE Technet abuse; Report technique publicly

C2 Location
"@MICR0S0FT" <encoded C2 location> "C0RP0RATI0N"

#RSAC
APT17: Hiding in Plain Sight Redux
APT17 aka Axiom, DeputyDog, Tailgater Team, Hidden Lynx, Voho, Group72, AuroraPanda
August 2015: Modified BLACKCOFFEE variant
targeting JP organizations
C2 Location
"lOve yOu 4 eveR" <encoded C2 location> "Reve 4 uOy evOl"

#RSAC
When needed, threat actors will add more resources to get the job done

#RSAC
APT28: Keep on Truckin'

APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium

20+

Reports examining APT28 TTPS Oct. 2014 ­ Oct. 2015

Timeline of APT28 Exposures

Public report examining APT28's operations

#RSAC
APT28: Keep on Truckin'

APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium

April 2015
· CVE-2015-1701 Windows local privs. escalation vuln
April 2015
· CVE-2015-3043 Adobe Flash Zero-Day

July 2015
· CVE-2015-2424 Microsoft Office Zero-Day
July 2015
· CVE-2015-2590 Java Zero-Day

October 2015
· CVE-2015-7645 Adobe Flash Zero Day

Timeline of APT28 Exposures

Zero Day

#RSAC
APT28: Keep on Truckin'
APT28 aka Pawn Storm, Sednit, Sofacy, Fancy Bear, Strontium

Image Source: Wellness GM @wellness_photos on Flickr

APT28 continues to
develop new tools
· March 2015: new variant of CORESHELL
· Dec. 2015: New Backdoor · Jan. 2016: New Launcher

#RSAC
In Summary...

Hide and Seek: How Threat Actors Respond in

#RSAC

the Face of Public Exposure

Key Takeaways
Threat actors are often keenly aware of reporting on their operations
Exposure can disrupt an actor's operations... if the incentives are right.
Public reporting triggers retooling
Actors may abandon tools or develop new ones. The path of least resistance is often king.
Sometimes, actors solve the problem by adding resources: time, money, tool development

Hide and Seek: How Threat Actors Respond in

#RSAC

the Face of Public Exposure

Exposure is a balancing act
Security researchers must continually weigh the benefits of public awareness against possible disruptions to detection and loss of visibility.
When executed well, exposure benefits victims, network defenders and the security community at large.

#RSAC
Questions to Ask

When evaluating whether exposing an adversary is the best course of action:
- What impact do we want to have on the adversary?
- How will exposure help/hurt victims and likely future targets?
- How will exposure impact `big picture' concerns like law enforcement efforts?
- Will exposure degrade our ability to detect and respond to future activity?

When evaluating how a threat actor will likely respond when their operations are exposed:
- How adaptive and capable is the group?
- Groups with a flat toolset and low adaptive capability are more likely to be disrupted
- How determined are they to maintain access to specific targets?
- What shifts to targeting, timing, resourcing & TTPs is the actor likely to make?

#RSAC
Thank you

