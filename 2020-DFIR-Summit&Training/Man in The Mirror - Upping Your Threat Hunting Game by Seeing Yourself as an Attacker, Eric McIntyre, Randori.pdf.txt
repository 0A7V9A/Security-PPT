MAN IN THE MIRROR
Upping Your Threat Hunting Game By Seeing Yourself Like An Attacker.
July 2020
www.randori.com/DFIR

ERIC MCINTYRE
DIRECTOR OF R&D
www.randori.com/DFIR

Hi, I'm Eric.
I'm Eric McIntyre, Director of R&D at Randori. Previously, I served as a security researcher at Kyrus Tech, where I worked for six years leading teams supporting clients in the national and commercial security spaces. I love landing exploits, running, and exploring the outdoors.
Follow: @pwnpnw | @RandoriAttack

outline

01

The Beginning and The End

02

Flipping the Script

03

Think Like an Attacker

04

Take Action

www.randori.com/DFIR

outline

01

The Beginning and The End

02

Flipping the Script

03

Think Like an Attacker

04

Take Action

www.randori.com/DFIR

The Point

First...
- I'm not a threat hunter.
- I'm not here to teach you how to threat hunt.
- I'm here to tell you how we hack companies at scale and explain the attacker's perspective.
- When I say red in this talk, I mean adversary.
www.randori.com/DFIR

And Finally...
- You can't hunt what you don't detect.
- Understanding how attackers think will make you a better threat hunter.
- Better prediction leads to effective prioritization leads to optimization of resources and reduction of risk.

outline

01

The Beginning and the End

02

Flipping the Script

03

Think Like an Attacker

04

Take Action

www.randori.com/DFIR

Red has to be right once. Blue Has TO be RIGHT ALL THE TIME.
www.randori.com/DFIR

Red has to be right once. Blue Has TO be RIGHT ALL THE TIME.
WRONG.
www.randori.com/DFIR

Blue Has TO be RIGHT ONCE. Red has to be right ALL THE TIME.
IRL.
www.randori.com/DFIR

Kill Chain

Reconnaissance

Persistence

Defense Evasion

Lateral Movement

Exploitation

Command and Control

Reconnaissance

Collection and Exfiltration

www.randori.com/DFIR

Advantage Blue
- Every action I take is a opportunity to get caught
- You know the playing field
- Getting caught is expensive
www.randori.com/DFIR

Advantage Red
- I know your tools - You lack control - Time is on my side
www.randori.com/DFIR

outline

01

The Beginning and the End

02

Flipping the Script

03

Think Like an Attacker

04

Take Action

www.randori.com/DFIR

THIS TALK IS ABOUT HOW YOU CAN optimize your defenses.
BY THINKING LIKE AN ADVERSARY.
www.randori.com/DFIR

Kill Chain

Reconnaissance

Persistence

Defense Evasion

Lateral Movement

Exploitation

Command and Control

Reconnaissance

Collection and Exfiltration

www.randori.com/DFIR

EXTERNAL RECONNAISSANCE
www.randori.com/DFIR

EXTERNAL RECONNAISSANCE
www.randori.com/DFIR

EXTERNAL RECONNAISSANCE
www.randori.com/DFIR

EXTERNAL RECONNAISSANCE
www.randori.com/DFIR

EXTERNAL RECONNAISSANCE
www.randori.com/DFIR

Six Factors of Temptation
ENUMERABILITY
Precision of detection
WEAKNESS
Known disclosures and exploits
CRITICALITY
Importance of function
APPLICABILITY
Level of adoption
POST-EXPLOITATION POTENTIAL
Usefulness after compromise
RESEARCH POTENTIAL
Ease of development
www.randori.com/DFIR

ENUMERABILITY Precision of Detection
Detecting an exact version, patch level, and configuration
Detecting a major and minor version
Detecting only the software name
www.randori.com/DFIR

Public/Private WEAKNESS Known Disclosures and Exploits
Critical, reliable, unauthenticated remote code execution with PoC
Local privilege escalation, post-authentication
Possible information disclosure vulnerability
www.randori.com/DFIR

Criticality Importance of Function
Services that inherently define a critical security boundary
Services infrequently, but possibly on a security boundary
Services not commonly on a security boundary
www.randori.com/DFIR

APPLICABILITY Level of Adoption
A ubiquitous service found in most enterprises
A service found in limited segments
An unusual service with few users
www.randori.com/DFIR

POST-EXPLOITATION POTENTIAL Usefulness After Compromise
Well-known environment where few defenses exist
Common environment with likely defenses
Esoteric or highly defended environment
www.randori.com/DFIR

Research POtential Ease of Development
Tooling, research, PoCs, and exemplars exist
Some prior research, but may lack development tools
Difficult to obtain hardware, no tools, no prior research
www.randori.com/DFIR

Six Factors of Temptation
ENUMERABILITY
Precision of detection
WEAKNESS
Known disclosures and exploits
CRITICALITY
Importance of function
APPLICABILITY
Level of adoption
POST-EXPLOITATION POTENTIAL
Usefulness after compromise
RESEARCH POTENTIAL
Ease of development
www.randori.com/DFIR

outline

01

The Beginning and the End

02

Flipping the Script

03

Think Like an Attacker

04

Take Action

www.randori.com/DFIR

Take Action

If You Believe This...
 You can't hunt what you don't detect.
 Understanding how attackers think will make you a better threat hunter.
 Better prediction leads to effective prioritization leads to optimization of resources and reduction of risk.

ATchtieonnDso This...
 UtilUitzielibzleacak bbloaxckdibsocxovdeirsycotvoery see eynoguirnea.ttack surface like an attacker.  Utilize a black box discovery
 Gainenagninaet.tacker's perspective.
 RankUtyioluirzetaargbeltasckanbdox discovery prioernigtiinzee. them based on risk, accounting for both temptation (likelihood) and impact.
??

www.randori.com/DFIR

www.randori.com/DFIR

