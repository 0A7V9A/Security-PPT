 
 2013




liyongbin@xiaomi.com : 4374755 Blog http://noops.me/  https://github.com/xiaomi-sa


 -    
Q & A
www.xiaomi.com

 

2013Q1

 
iphoneandroid  
60% ­ 80% 


 -    
Q & A
www.xiaomi.com

 

BTS

DNS

BSC

SGSN

///

IP

GGSN

CNC CTC

 

 

:-D  
GPRS EDGE
3G


171.2 kbps 384 kbps > 2 Mbps

() 
PING: EDGE 300+ / GPRS 600+ > 2s > 2s RTT > 3s <5k





21.4 kb/s

~ 16 kb/s

48 kb/s

~ 25 kb/s

>250 kb/s

-

(×_×) 

72% 
GPRS/EDGE

   Connect reset by peer


 -    
Q & A
www.xiaomi.com



a  b  c DNS d TCP

CDN  DNSHTTP / keepalived


 -    
Q & A
www.xiaomi.com


1. 2. 3. 4.

 

 

1. 



 ­ 
+ 2 Ping RTT 

Jinan CNC

Ping traceroute wget JS 

­ 
 · DC · 98%+
 · TCP

1

2

 

  

 




· 12 ·  · GADVPN+  
 

 ­ 

1



VPN

PING/TCP



UDP 

Frontend

2 Backend

  TCP


1. 2. 3. 4.

 

 

2. 



 ­ HTTP DNS

Bucket list

Channel Json 

SMART DNS

HTTP DNS

  IP 

 ­ eDNS+

eDNS



 

Google DNSPublic DNS IP DNS server IP http://noops.me/?p=653

http_redirect
Nginx + Geo http_code_302  Local DNS


1. 2. 3. 4.

 

 

3. 



 ­ 
   

 ­ TCPXM
TCPXM/ 
http://noops.me/?p=594 https://github.com/xiaomi-sa/tcpxm

 ­ TCPXM
TCPXM ISP  
 


1. 2. 3. 4.

 

 





 



IP   

IP 

 


 ­ BOSH





51.00%

23.70%

23.24%

18.60% 15.30%

BOSH 
Bidirectional-streams Over Synchronous HTTP (BOSH)  HTTP - 



38k100ms
95%
35%
20116 20136


3s
95%
40%
20116 20136

Thanks!

