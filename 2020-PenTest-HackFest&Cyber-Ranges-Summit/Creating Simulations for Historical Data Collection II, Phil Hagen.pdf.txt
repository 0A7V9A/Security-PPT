MAKING A FORENSIC DATA SET
[OR AN APPLE PIE] FROM SCRATCH

CREATING SIMULATIONS FOR HISTORICAL DATA COLLECTION: A DFIR SPIN
PHIL HAGEN
SANS DFIR

"IF YOU WISH TO MAKE AN APPLE PIE FROM SCRATCH, YOU MUST FIRST INVENT THE UNIVERSE."
-- CARL SAGAN

TRAINING VS. SIMULATION ENVIRONMENTS

Skill Refinement
· Create an artificial, controlled, safe environment to train on specific skill set
Needed to maintain proficiency, tool familiarity

Operational Modeling
· Create environment to replicate a specific mission or comprehensive skill set
Needed to ensure mission success

Vastly different ­ yet equally critical ­ training requirements

FORENSIC DATA SETS REQUIRE OPERATIONAL REALISM
· Digital Forensics and Incident Response is the business of showing what really happened!
· If the training environment or data set is the product of shortcuts, they will show!
· "Simple" system actions create hundreds of artifacts
· "Cheating" results in an unrealistic training environment and inconsistent evidence · Can mislead students!

CORE REQUIREMENTS FOR FORENSIC DATA SETS

Real objective

Specific, objective list of adversary activities and artifacts to be generated

Real environment Full domain, antivirus, user-facing services, administrator actions

Real background Email activity, web browsing, Sharepoint, projects, business operations

Real time

No compressed or accelerated time (Can't fake millions of timestamps!)

Real participants Human actors for key actors, consistent across entire timeline

Real adversaries Emulate actions (and mistakes) of those you want to prepare for

BACKGROUND TEXTURE
· Not practical to hire an entire workforce · Use NPC/bot actors to generate believable data volume...
but not important content
· Email, browsing, Office documents · "Just enough" realism but don't
waste too much effort

SRL V2: FOR508 AND FOR572 CAPSTONE SCENARIO

Extensive and realistic data creation scenario
· Government contractor/Intellectual property theft by state-level actor

· Planning and environment build (2-3ppl)

18 Mo

· Active (human) character engagement (5-7ppl)

3-4 Mo

· Attack timeline (2-3ppl + 5-7ppl from above)

2 Mo

· Incident response and Capstone lab development

1 Mo

(And ongoing)

SRL2 EVIDENCE GENERATED
· Over 8TB raw data (~6TB disk, ~2TB network) · ~120GB selected for each course
· Triage data collection for some systems, full disk for others · Selected pcap files, NetFlow, and logs
· New artifacts and behaviors being found every week · Unified planning, scenario build, and attack execution
opens opportunity for Joint Capstone at selected events

LESSONS LEARNED THE HARD WAY

No second takes: Everything is live improv
· Mistakes will occur ­ prepare and recover
Play the part: Any action must occur in character
· System administrators, business decisions, infrastructure changes, IR, etc.
Have backup plans for critical artifacts
· What if the phishing email is blocked?
Plan minute details of attack and document WHY
· Perusing victim's recent folder via RDP to model attacker "habit discovery"
DOCUMENT EVERYTHING: Maintain attack log alongside the plan
· Don't rely on automated logging ­ a note may be better than screen recording
This is a HUGE investment: Make it last
· Choose artifacts, attack methodologies and behaviors, scenarios that will endure

QUESTIONS?
JOIN ME ON SLACK IN THE #HALLWAY-PHIL-HAGEN-TIM-CONWAY CHANNEL!

ENGINEER THE ENVIRONMENT SO YOU CAN BUILD A SEQUEL...
SRL IS STILL ALIVE LOOK FOR FOR608 IN A THEATER CLASSROOM NEAR YOU

