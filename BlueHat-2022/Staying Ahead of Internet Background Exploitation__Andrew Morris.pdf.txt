STAYING AHEAD OF INTERNET BACKGROUND EXPLOITATION
Andrew Morris

Andrew Morris | Staying Ahead Of Internet Background Exploitation
ANDREW MORRIS
Founder and CEO GreyNoise Intelligence @Andrew___Morris andrew@greynoise.io
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
1. Intro & Background 1. Part I - What Is The Problem? 2. Part II - Our Solution To The Problem 1. Part III - Things We've Observed 2. Summary & Recap
BLUEHAT IL 2022

PART 1 - THE PROBLEM

Andrew Morris | Staying Ahead Of Internet Background Exploitation
IN PLAIN TERMS...

Every other month, a really bad vulnerability is identified, disclosed, weaponized, and exploited at scale around the internet, in some piece of common perimeter-facing software and nobody has any idea what to do about it.

35% of initial infections, according to IBM
"Scan-and-exploit" top infection vector in 2020
Scanning and exploiting vulnerabilities jumped up to the top infection vector in 2020 with a 35% share, surpassing phishing which was the top vector in 2019.
Source: https://www.ibm.com/security/data-breach/threat-intelligence

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
ALL THE CELEBRITY VULNERABILITIES

Andrew Morris | Staying Ahead Of Internet Background Exploitation
HERE'S WHY WE'RE HERE

 Vulnerability
research has
evolved  Tooling and
development has improved
 Attack surface has
increased

 Mass scanning
has evolved  Tooling is better
(Masscan, Zmap,
etc)
 Recyclable IPs are a
thing (cloud)
 The Internet is
literally faster

Mass scanning + vulnerability research
= mass exploitation dying to happen

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
HACKING IN THE 90's
We used to think about bad guys hacking systems on the internet following this pattern:

Identify Target

Find Vulnerabilities

Operate

BLUEHAT IL 2022

Scan Target, Enumerate,
Profile

Exploit Vulnerabilities

Profit

Andrew Morris | Staying Ahead Of Internet Background Exploitation
HACKING IN THE 20's
Today more closely resembles an assembly line:

Identify Target a viable
Vulnerability

Compromise Lots of Hosts

Trade Accesses or Operate

BLUEHAT IL 2022

Scan Target Internet

Exploit Deconflict Accesses

Profit

Andrew Morris | Staying Ahead Of Internet Background Exploitation
THREAT MODEL CREEP

To quote Bruce Potter at some point a few years ago:

But now:  $ASSET can increasingly refer to 0.0.0.0/0

 $ACTOR does $ACTION to $ASSET resulting in $OUTCOME because $MOTIVATION

 SOMEONE does AN EXPLOIT to THE ENTIRE INTERNET resulting in SHELLS AND CHAOS

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
WHAT IS INTERNET BACKGROUND NOISE?
On a daily basis, every individual routable IP on the Internet sees:
~3,000 unsolicited pings from... ~1,000 distinct IP addresses
Each /24 receives about 46mb of unsolicited network data from ~200,000 IP addresses from SYNs alone
Why so much scanning?  BAD: Credential stuffing, proxy checking, brute forces, exploit vulnerabilities, etc  GOOD: Web search, asset discovery, third party risk, security research
The internet is just really noisy, man.
BLUEHAT IL 2022

Internet scanning of the internet by source IPv4 address, Jan-21 to Feb-22. Each pixel in this photo is a group of 256 IPs.; the "brightness" of each pixel is how many IPs in that group have been observed by GreyNoise.
Source: GreyNoise Intelligence

Andrew Morris | Staying Ahead Of Internet Background Exploitation

SOME SOURCES OF "BENIGN" INTERNET BACKGROUND NOISE

 Alpha Strike Labs  GoogleBot
 BinaryEdge.io  Project Sonar  Bitsight
 Censys  ShadowServer.org
 cyber.casa  ONYPHE  InterneTTL
 BingBot  Yandex Search Engine
 Cortex Xpanse  ipip.net  Shodan.io
 IPinfo.io

 Cloud System Networks  Net Systems Research
 OpenIntel.nl  Facebook Crawler  AdScore
 Ahrefs  Intrinsec
 DomainTools  CriminalIP  BLEXBot
 Arbor Observatory  Technical University of Munich
 Mail.RU  Palo Alto Crawler  Petalbot

 Caida  LeakIX
 Quadmetrics.com  Archive.org  Moz DotBot
 RWTH AACHEN University  VeriSign
 Bit Discovery  Project25499  Applebot
 CyberGreen  ESET
 FH Muenster University  Knoq  Mojeek
 SecurityTrails  University of Colorado

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
2004
"[A] telescope monitoring a single IP address (a /32) the average time to observe a host at 10 addresses per second is over 13 years and the time to observe
with 95% likelihood is over 40 years."

BLUEHAT IL 2022

http://www.cs.unc.edu/~jeffay/courses/nidsS05/measurement/moore-telescopes04.pdf

Andrew Morris | Staying Ahead Of Internet Background Exploitation
2013
"[Masscan] can scan the entire Internet in under 5 minutes, transmitting 10 million packets per second, from a single machine."

BLUEHAT IL 2022

https://github.com/robertdavidgraham/masscan

Andrew Morris | Staying Ahead Of Internet Background Exploitation

APACHE PATH TRAVERSAL

 Sept 29, 2021:  Patch submitted

 Oct 03, 2021:  GreyNoise observes first internet-wide vuln scan

 Oct 04, 2021:  Apache version update, patch is GA
 Oct 05, 2021:  Apache discloses vulnerability to CVE
BLUEHAT IL 2022

https://www.greynoise.io/blog/a-patchy-server-greynoise-observes-path-traversal-and-remote-code-execution-in-apache-http

Andrew Morris | Staying Ahead Of Internet Background Exploitation
WILL CVE-BLAH-BLAH BE "MASS EXPLOITED"?

Remotely exploitable?
YES

Simple to exploit or public POC?

Running on the internet?

YES

YES

Widely deployed?
YES

The CVE is likely to be mass exploited

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
WHO EXPERIENCES THE PAIN?

Defenders  "Are you kidding me?
Another one? Again?"
Software Vendors  "This makes people
afraid to run our software"

Cyber Security Vendors  "This is either an
opportunity to make money, OR this makes us look like idiots"
Hosting Providers  "Please stop popping
boxes from our network, we can't handle any more FBI calls or abuse complaints"

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
WHY IS THIS PROBLEM HARD?

BLUEHAT IL 2022

Trust  Lots of data is bad  Lack of filtering and quality assurance means nobody is willing to make automated decisions based on someone else's data
Money  Accidentally blocking revenue-generating users

Speed  There is a "time-to-getsomething-useful-to-say"  There is a "time-to-say-it"  If both do not happen prior to an attack hitting the perimeter, you lose the race`
Scale issues

Andrew Morris | Staying Ahead Of Internet Background Exploitation

NEXT TIME THE SH*T HITS THE FAN?

BLUEHAT IL 2022

 "Whack-a-mole"-style short term blocking has surprisingly good results.  Reduces successful attacks by 70%, but needs to be fast  Hunting is more straightforward but obviously this means the compromise has already occurred
 More collective defense, more info sharing from vendors and groups who have good data

 Fewer well-intentioned security researchers and vendors spraying exploits around
 Assume every service on your perimeter can suddenly become vulnerable on very little notice

Andrew Morris | Staying Ahead Of Internet Background Exploitation

TL;DR

Super bad vulnerabilities are coming out every other month, bad guys exploit them at scale, and it's a differently flavored dumpster fire every time
Stopping the vulns from existing seems unlikely, so let's try to detect and block before it hits a network we care about

BLUEHAT IL 2022

PART II - OUR SOLUTION TO THE PROBLEM

Andrew Morris | Staying Ahead Of Internet Background Exploitation
WHO'S TRACKING VULN EXPLOITATION
IN THE WILD?
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
CVES EXPLOITED IN THE WILD

GreyNoise
201

AttackerKB
639

US CISA
377

March 2020-Present
BLUEHAT IL 2022

June 2020-Present

Nov. 2021-Present
*United States Cybersecurity Infrastructure & Security Agency

Andrew Morris | Staying Ahead Of Internet Background Exploitation

ONE WAY TO SOLVE THE PROBLEM

 Deploy a huge network of sensors across the internet
 "Listen" to internet background noise (scans/probes) and internet background exploitation

 Make the sensors look like lots of different software
 Fingerprint every exploit request we find
 Temporarily block offenders BEFORE an attack lands on the perimeter

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
GREYNOISE ORIGIN STORY
Years ago, someone with a lot of money and a lot of weird problems wanted to know if the computers they were running on the internet were seeing a "normal" amount of scans, or an undue amount of attention. I became obsessed and here we are years later: GreyNoise.
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation

GREYNOISE TL;DR

 Thousands of sensors - we operate thousands of sensors (kinda like honeypots) across the globe  Centrally managed  Distributed and geographically
diverse
 What they masquerade as is
programmable
 Every host is ephemeral
 Billions of events - as of March 2022 we're processing and storing several billion events per day

 Tagging - we add and maintain signatures on exploit, actor, and other patterns using an internally developed tagging engine and DSL
 Use cases - GreyNoise is useful for several use-cases; one of the increasingly popular use-cases is protecting orgs from opportunistic compromise
 Free data - we give away an insane amount of free data. Seriously.

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
CHALLENGES

Speed

Provider

OpSec

Cost

Automation

Geography

Data / Scale

Masqueraders / Fakers

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
SPEED CHALLENGES
 Staying "in front of" the exploit is hard  We only have a few minutes maximum to go from:
 Malicious traffic hitting the first few sensors..  ...classifying the traffic as XYZ exploit...  And finally pushing a "block decision"  It isn't enough to classify traffic correctly; you have to classify correctly in time.
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
SELECTING PROVIDERS

BLUEHAT IL 2022

 Major cloud providers are easy  AWS, Google, Azure, DigitalOcean...
 Language barriers  Automation maturity  Infrastructure reliability  Cost  GeoIP is fakeish  No colos

Andrew Morris | Staying Ahead Of Internet Background Exploitation
ELEVATING CLOUD PROVIDERS

BLUEHAT IL 2022

 AWS is the standard for maturity  API/Deployment Automation  Minimum viable features  Cost
 Smallest instance  Many IPs to one instance  Reliability

Andrew Morris | Staying Ahead Of Internet Background Exploitation
COST CHALLENGES

BLUEHAT IL 2022

 Lacking financial automation  Pre-payment model  Remember to top up...
 IPs per host  One IP per host is expensive  Many IPs to one host is "expensive"  Indirect automation and complexity costs

Andrew Morris | Staying Ahead Of Internet Background Exploitation
AUTOMATION CHALLENGES

BLUEHAT IL 2022

 Find the lowest common denominators for deployment and automation  Templating/code generation  Custom Terraform providers  "metacloud"
 Testing is *really* hard  No common standard

Andrew Morris | Staying Ahead Of Internet Background Exploitation
RELIABILITY CHALLENGES
 Unreliable APIs  Unreliable infrastructure  Latency  Debugging across multiple providers
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
GEOGRAPHICAL CHALLENGES

BLUEHAT IL 2022

 Do you have sensors in X country?  GeoIP is fake... sometimes  Ambiguous regions
 No colos  Dependant on
 Automation maturity, cost, reliability  Do you know how hard it is to find cloud hosting providers in
most areas of the world???
 Once you hit a critical mass you can do cool stuff like... identify all IPs that are specifically scanning Israel's IP space...

HERE ARE ALL THE IPS SPECIFICALLY SCANNING/CRAWLING/ATTACKING ISRAEL'S IP SPACE, & NOBODY ELSE'S
https://api.greynoise.io/datashots/bluehat/israel.csv

Andrew Morris | Staying Ahead Of Internet Background Exploitation
OTHER CHALLENGES

BLUEHAT IL 2022

 Account freezes  Russia, Ukraine, China  Photo verification (sorry Greg)  Vetting process  Flagged for churning sensors
 Typical big data/scaling challenges  Shout out to the masqueraders

PART III - THINGS WE'VE OBSERVED

Andrew Morris | Staying Ahead Of Internet Background Exploitation
CASE STUDIES
 CVE-2021-41773, Apache Path Traversal  CVE-2021-38647, OMIGOD  CVE-2021-26084, Atlassian Confluence OGNL Injection  CVE-2021-44228, Log4Shell
BLUEHAT IL 2022

APACHE PATH TRAVERSAL
(CVE-2021-41773)

BLUEHAT IL 2022

https://www.greynoise.io/blog/a-patchy-server-greynoise-observes-path-traversal-and-remote-code-execution-in-apache-http

Andrew Morris | Staying Ahead Of Internet Background Exploitation
TIMELINE

September 29, 2021 Patch Submitted

October 04, 2021 Apache version update, patch is GA

BLUEHAT IL 2022

October 03, 2021 GreyNoise observes first internet-wide vuln scan

October 05, 2021 Apache discloses vulnerability to CVE

OPPORTUNISTIC EXPLOITATION/SCANNING ONE DAY BEFORE MAJOR
POC RELEASE

OMIGOD
(CVE-2021-38647)

BLUEHAT IL 2022

BLUEHAT IL 2022

BLUEHAT IL 2022

BLUEHAT IL 2022

BLUEHAT IL 2022

ACCIDENTAL "EXPLOITATION" 4 MONTHS BEFORE PUBLICLY
KNOWN

CONFLUENCE OGNL CVE-2021-26084
BLUEHAT IL 2022

OPPORTUNISTIC EXPLOITATION/SCANNING IN
LESS THAN 4 HOURS AFTER TOOLING RELEASED

Andrew Morris | Staying Ahead Of Internet Background Exploitation
LOG 4J
 Interestingly, the first
huge wave came from exclusively Tor nodes
 Most attempts at the
start were just stuffing the Log4Shell string in random places.
 Shortly after, custom
product-specific payloads
BLUEHAT IL 2022

"scanning != exploiting" except when scanning == exploiting,
like with Log4j

Security companies and researchers who exploit vulns with good intentions make this worse
while trying to be helpful

On any given day, 73% of IPs responsible for opportunistic scan/exploit noise were seen the
day before.
Only 27% are "new".

Andrew Morris | Staying Ahead Of Internet Background Exploitation
WEIRD STUFF
 Spoofed noise storms  Bad guys acting like security companies that scan the internet  Upstream blocks  Just like bad guys, security companies think they're super
sneaky   Printjacking
BLUEHAT IL 2022

FINAL THOUGHTS

Andrew Morris | Staying Ahead Of Internet Background Exploitation
BLOCKING NOISE
Whack-a-mole shows a surprising amount of promise
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
"WHACK A MOLE" EXPERIMENT

Hypothesis:
 Blocking extremely fresh internet
background exploitation IPs will meaningfully increases the amount of time it takes for a vulnerable host on the internet to be compromised

Method:
 Stand up two identical
vulnerable hosts, open to the internet, running poorly credentialed services
 SSH and telnet  admin/aSdmin  root/admin  Measure time to first
compromise; total number of compromises

BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
"WHACK A MOLE" RESULTS

Unblocked Host Mean Time to Compromise
19 Minutes
 32 compromises/day  206 compromise attempts/hour

Blocked Host Mean Time to Compromise
4 Days 6 Hours
 4 compromises/day  35 compromise attempts/hour

BLUEHAT IL 2022

Tiny fast IP blocklists (whack-a-mole) are gross but they work better than you'd expect

Andrew Morris | Staying Ahead Of Internet Background Exploitation
STAYING AHEAD OF THE NEXT LOG4J
There is relatively little we can do to prevent the next Log4J, but we can make it suck less by centralizing information and providing ready-use real-time block lists
BLUEHAT IL 2022

GreyNoise Community Trends

Andrew Morris | Staying Ahead Of Internet Background Exploitation
GREYNOISE COMMUNITY TRENDS
This is live right now: https://greynoise.io/
BLUEHAT IL 2022

Andrew Morris | Staying Ahead Of Internet Background Exploitation
CONCLUSION
 Internet mass exploitation is quantifiably getting worse. I expect this to continue.
 A huge, distributed, sensor system such as GreyNoise is effective at reducing opportunistic
compromises
 Running this huge sensor network has challenges but they're all addressable
 Instead of hoping another Big Bad Vuln doesn't happen, let's prepare for when it does
BLUEHAT IL 2022

THANK YOU!

