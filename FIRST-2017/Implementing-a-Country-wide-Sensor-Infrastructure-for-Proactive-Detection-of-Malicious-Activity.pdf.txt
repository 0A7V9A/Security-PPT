Implementing a country-wide sensor infrastructure for proactive detection of
malicious activity
Rildo Souza

Regarding the RNP
· Brazilian National Research and Education Network (RNP).
· Created in 1989.
· Implemented the first Latin American fiber network in 2005.

Regarding CAIS

· Coordination CSIRT of Brazilian research and education network since 1997.
· CAIS works in detection, resolution and prevention of network security incidents.

Security Vulnerability
handling

Security Incident Handling

Information Security
Awareness
CSIRT Development

Motivations to create a network CAIS Sensor
· Highly diversified environment, networks, technologies and maturity of customer's security teams.
· Increasing our capacity to detect malicious activities. · Understanding and support better the security actions from our clients .

CAIS Sensor Requirements

What is CAIS Sensor ?

How does the CAIS Sensor analyze traffic ?

How does the CAIS Sensor analyze traffic ?

How does the CAIS Sensor Works ?

Sensor (Suricata)

Master Server
+

Engine (Suricata)

Engine (Suricata)

Engine (Suricata)

+ Query

What does the Master Server do ?

Master Engines(Suricata)

· Sensor management · Sensor's system updates management · Statistics on malicious activities detected · Information about sensor's "health" · System general administration

Regarding Engines(Suricata)

Engines(Suricata)

· Friendly user interface · Plug and play · Less technical knowledge required · Low maintenance and support
· Send detections by email · Send statistics and status data · Update requests

The CAIS Sensor (Screenshots)
Main menu
Quick access tasks

Quick Information dashboard

The CAIS Sensor(Screenshots)

Engine(Screenshots) ­ Installation Menu
· Network interface configuration. · Select network pickup interface. · Put the token. · Restart Services.

Implementation of CAIS Sensor
27 RNP Points of Presence 17 Customers 44 Sensors Installed

Statistics ­ Average Analyzed Traffic

Statistics
Malicious activity flow
9%
91% Incoming Outgoing

Most attacked ports

Statistics - Main types of malicious activity detected

DDoS Attempts(protocol xdmcp) DDoS Attack (protocol NTP) Malwares DDoS Attack (protocol SNMP)

702,345 535,204 236,985 102,478

Statistics ­ Types of detected events

Statistics - Botnets

nicaze.net PCRat/Gh0st Beacon

Zeus Kelihos Feodo DealPly

XcodeGhost Bladabindi/njrat
Palevo

Next Steps
· Optimize reports · Integrate with other sources (URLs blacklist, IPs blacklist, others) · Increase number of sensors in educational institutions and RNP customers · Finalize and expand the partnership model

Questions ?

Thank You !
The Brazilian Academic and Research Network
Rildo Souza Security Analyst rildo.souza@rnp.br

