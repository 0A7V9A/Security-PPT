
----
 
2015/07/09 





201410 JOE""

www.antiy.com

2

.
APT2013

.
APT2013



. 

Fanny 2008-2011



DoubleFantasy 2004-2012



TripleFantasy 2012-

win32m.sys

 

nls_933w.dll 

 

 

EquationLaser 2001-2003



MSNA DT.EXE

EquationDrug 2003-2013



MSDIRECTX.EXE MSCFG32.EXE SVCHOST32.EXE MSCFG32.DLL SVCHOST32.DLL
UNITAY.DLL MSNDSRV.SYS MSSVC32.VXD
INSTV4.BAT INSTV3.BAT

API C&C







Rootkit

DNS





  
VFS



  

/  

C&C ----------------Win Sockets
WinLnet WinHTTP





 





...

GrayFish 2008-
MSCFG32.DLL MSCFG32_KS.DLL
MSNDSRV.SYS NETVT.SYS HRILIB.SYS INSTV4.BAT
DESERTWINTERD RIVER.SYS



  BIOS
MB R

 WINDOWS  

VBR



Windows OS Loader

 

Windows Kernel

nto skrnl



Windows Logon









 

EQUATION
 0day       

 19
  " ver1    "

Hangover

8

67

41

27

7

3

42

24

42

81



0day

 ver2

ver3

ver2

 ver4

ver1

ver3

90 Rootk3i7t



Method_A

Method_B

Windows

127 Method_A+B

ver2 ver1

ver3 ver4

118899

Method_C

Method_D

16

13

ver1

ver2

29



www.antiy.com

345
5

.

 IDS
­  ­ 
 
­  ­ 
 
­  ­  ­ 

www.antiy.com

6

.
     
  AV
""  

 , ....., , 
----

www.antiy.com

7

.
 
­  ­ 0dayshellcode
 2013932.b
­  
­ a.  ­ b.  ­ c. 
 932.BAV

.

Email MPS

1

SMTP

2

Inbound

CMS
3
MVX
6

Callback Server

Outbound HTTP
4

5
Web MPS

Multi-vector blended attack

1 ­ Email with weaponized pdf 2 ­ Executed in MVX (Email MPS) ­ phish suspected 3 ­ Web MPS notified via CMS 4 ­ Callback over HTTP to C&C server 5 ­ Callback detected by Web MPS and blocked 6 ­ End user defended from multi-vector attack
FEPE
FireeyePPT

.
  ->
  AV PE 

 PE  

  ""  

Fireeye

www.antiy.com

10

.

www.antiy.com

FE ·  ·  ·  ·  ·  · 
Fireeye
 ·  · 
11


           

HT 0day
www.antiy.com

12

AV.

AV-


13

.

 APT 

   













APT

 

 

 





 

 



 









 








www.antiy.com

15

.
  
  
 


   

  
  





 

 

 
 




 





 









Symantec Symantec 
----XP



 


www.antiy.com

19

"Camberdada"
An Easy WinUsing SIGINT to Learn about New Virues|Project Camberdada



2007

2014

An Easy WinUsing SIGINT to Learn about New Virues|Project Camberdada  The Duqu 2.0 Technical Details  
www.antiy.com

21




  

   







www.antiy.com

 

22


 "" ""
  
   
  

www.antiy.com

23


www.antiy.com Weibo.com/seak

