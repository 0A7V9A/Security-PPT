Routopsy
Modern Routing Protocol Vulnerability Analysis and Exploitation Tyron Kemp and Szymon Ziolkowski

# about us
Szymon Ziolkowski
- Hacking corporates for over 3 years - Likes Application Security - Enjoys writing code - @TH3_GOAT_FARM3R

Tyron Kemp
- Four years network security experience - Three years pentesting experience - @tkempheks - alert(1)

- Security Analysts at OCD/SensePost team - We wants to be your ( network) neighbour*

1. Vulnerability Identification 2. Initial Attempts at Exploitation 3. Impact and Challenges 4. The Routopsy Toolkit

Dynamic Routing Protocols(DRP) First Hop Redundancy Protocols (FHRP)

DRP EIGRP OSPF
RIP BGP

FHRP HSRP VRRP GLBP

+

if not authentication: do_attack()

if authentication == true:
if password == cleartext: do_attack()
else: do_attack()

if authentication == true: if password == cleartext: do_attack()
else: hash = get_password_hash() # using EtterCap password = crack_hash(hash) # using John the Ripper if hash_cracked == true: do_attack(password)
else: do_attack()

R1# sh run | s ospf router ospf 1
network 0.0.0.0/0 area 0

R1# sh run | s ospf router ospf 1
network 0.0.0.0/0 area 0
R2# sh run | s ospf router ospf 1
network 192.168.10.0/24 area 0 network 192.168.20.0/25 area 0

$ cat romana/publisher.conf protocol static romana_routes {
{{range .Networks}} route {{.}} reject; {{end}} }
protocol ospf OSPF { export where proto = "romana_routes"; area 0.0.0.0 { interface "*" { type broadcast; }; };
}

$ cat romana/publisher.conf protocol static romana_routes {
{{range .Networks}} route {{.}} reject; {{end}} }
protocol ospf OSPF { export where proto = "romana_routes"; area 0.0.0.0 { interface "*" { type broadcast; }; };
}

Specifics get preference *

1. Extract protocol configuration 2. Configure a router 3. Profit

Routopsy

Learning new routes. Traffic interception & redirection.

DRP to learn new routes DRP to inject a route Redirect traffic

Route injection to perform traffic interception & redirection on a local subnet

DRP to redirect traffic destined for hosts in a local network segment

Gateway takeover for person in the middle attacks.

FHRP to PiTM all gateway traffic

Remember, specifics get preference

Collect syslog

Playground
DRP.yml

FHRP.yml

Takeaways
Network protocol security is critical It is possible to meaningfully show impact Securing and detecting is simple

Thank You
tyron.kemp@orangecyberdefense.com szymon.ziolkowski@orangecyberdefense.com github.com/sensepost/routopsy twitter.com/sensepost

CREDITS: This presentation template was created by Slidesgo, including icons by Flaticon, and infographics & images by Freepik.
Please keep this slide for attribution.

