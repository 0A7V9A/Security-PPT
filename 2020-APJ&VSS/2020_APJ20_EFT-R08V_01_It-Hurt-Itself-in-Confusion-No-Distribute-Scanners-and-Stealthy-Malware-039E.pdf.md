SESSION ID: EFT-R08
It Hurt Itself in Confusion: No distribute scanners and stealthy malware

Mathieu Gaucheler
Cybersecurity Analyst Blueliv @shibasec

Liv Rowley
Threat Intelligence Analyst Blueliv @OLRowley

#RSAC

#RSAC
Agenda
No Distribute Scanners 101 Overview of Different NDS Services NDS in the Cybercriminal Landscape Key Points

#RSAC
Case Study: Scan4You & Dyncheck

Scan4You
"VirusTotal-for-Crooks" 2009-2017 30,000 registered users 14 year prison sentence

#RSAC
Credit: Krebs on Security

#RSAC
DynCheck
Top no distribute scanner (NDS) in 2020 Appeared in 2016 Static & dynamic scans

#RSAC
No Distribute Scanners 101

#RSAC
What are NDSs?
Standalone websites Scan files against dozens of antivirus products No feedback loop Marketed to cybercriminals

Upload file to the NDS

Processing by the back-
end

NDS generates a
report

#RSAC

#RSAC

#RSAC
DynCheck settings panel

#RSAC
Overview of Different NDS Services

#RSAC
Antivirus 101: static VS dynamic
Static analysis
­ String detection ­ Format analysis ­ Entropy analysis
Dynamic analysis
­ Monitoring ­ Process memory
analysis ­ Emulation

#RSAC
Static Scan

#RSAC
Static Scan

#RSAC
Dynamic Scan

#RSAC
Dynamic Scan

Overview of NDS
Surveyed NDS: 9 All offered API access Static scans offerings are much more common

#RSAC
Static scanners Dynamic & static scanners

#RSAC
Possible static scanners architecture

#RSAC
Possible dynamic scanner architecture

#RSAC
What are the pricing models?

#RSAC
How are NDS services advertised?
"At ScanHaven, you can scan your file on 39 fully licensed anti-viruses which include DAILY automated database updates"
- ScanHaven ad

#RSAC
The role of NDSs in the criminal landscape

#RSAC
NDS used directly by malware developers

#RSAC
When are NDS used in a malware life

Development

Advertisement

Exploitation

#RSAC
How to use a report to improve one's malware?

Test your malware

Remedy the cause
of detection

Analyze the output

Identify the cause
of the detection

#RSAC

#RSAC
From Avira's website:
"It infects the MBR (Master Boot Record) of the running system. If the Trojan is executed, it overwrites the MBR on the hard drive before the original MBR is stored in a second section"
"It makes a copy of itself in the following folder: %Userprofile%\Local Settings\Temp\x2z8.exe"
"Also, it drops a clean file in this folder:%Userprofile%\Local Settings\Temp\fpath.txt"

#RSAC
Crypters

#RSAC
Using an NDS to advertise your malware

KPOT

Borr

Oski DiamondFox

#RSAC
Using an NDS to monitor the AV editor's response
Periodic scans
Domain check

#RSAC
NDS integrated into crimeware tools

#RSAC
NDS integrated in crypters
Using an NDS API - automation - integration in other tools

#RSAC
NDS being used by other NDS
Some NDS rely on another NDS for their backend:

#RSAC
Key Points

#RSAC
Key Points
AV is not the panacea against malware
­ Antivirus doesn't stop all threats, and threat actors are monitoring what we're doing
Monitoring the NDS landscapes allows us to identify important players and services in the cybercriminal ecosystem
­ Allows researchers & LE know where to invest resources
Scan results shared by malware authors can help defenders identify and prioritize new and potent malware

#RSAC
Questions?

#RSAC
Thank you!
mathieu.gaucheler@blueliv.com liv.rowley@blueliv.com

