YOU'VE GOT 99 PROBLEMS AND A BUDGET'S ONE

Rebekah Brown | @PDXBek
Threat Intelligence Lead at Rapid7
But before that...
· Gunnery Sergeant United State Marine Corps · Chinese Crypto linguist and Network Warfare Analyst · Policy Developer · Liaison to State and Local Governments · Threat Intelligence in the private sector
1

Why are budgets such a problem?
2

We are living in a material world...
· Feeds - $$- $$$$ · Platform - $$$- $$$$ · Reports - $$-$$$$ · Analyst on Demand - $$$ · Social Media Analysis - $$- $$$$
3

2015 Global Study on IT Security Spending & Investment ­ Ponemon Institute
· 50% security budget is stalled or declining · 19% IT security leadership has a say in resource allocation · 37% of investments in security investments did not meet expectations · Many organizations do not have the budget to even stay in compliance
with regulations
4

Frugal Girl's Guide to Threat Intelligence
· Solid Foundation - FREE · Open-source Feeds ­ FREE* · Open-source Platforms ­ FREE* · Open-source reports ­ FREE · Community Tools ­ FREE* · Smart friends - PRICELESS
6

7

That all sounds well and good... but how?
Find the problems

Adjust as needed

COMMUNICATE

Identify solutions

Gather feedback

Implement

8

· CERT-UK and the Centre for the Protection of National Infrastructure
· https://www.cpni.gov.uk/advice/ cyber/Threat-Intelligence/
· Strategic · Operational · Tactical · Technical
9

Security Functions
·Risk and Priority Assessment ·Situational Awareness ·Threat Identification and Alerting
10

Strategic Intelligence

Operational Intelligence Tactical Intelligence

Technical Intelligence

Risk and Priority Assessment

Assess threats facing similar Assess whether ongoing

businesses.

attacks would impact

Source: DBIR, industry

business operations.

reports, annual reports

Source: News, industry

reports, internal reports

Evaluate threats have been seen in the past and how to best respond and prioritizing intel. Source: Log Data, internal reports

Identify what technologies should be in place to counter the most likely threats. Source: industry reports, internal reports

Situational Awareness Understand the implications Understand current or

Identify TTPs or indications of Technical details of threats,

of emerging or high profile planned campaigns and how a threat and determine how including exploitation of a

threats or vulnerabilities. to respond

to alert and respond.

vulnerability.

Source: News, blogs,

Source: News, blogs,

Source: News, Blogs,

Source: News, Blogs,

Industry reports

Industry reports, forums, industry reports

industry reports

social media

Threat Identification and Alerting

Provide trending data on what threats are impacting operations and actionable advice for decision makers. Source: News, blogs, Industry reports

Identify whether a current Alert on TTPs and mechanisms Provide automated alerting on

or planned attack is

associated with known

high fidelity threat

impacting you and

threats, including implications. information and help validate

determine how to respond. Source: News, blogs,

and interpret alerts.

Source: Blogs, social media, industry reports, internal Source: News, blogs,

forums.

reports

industry reports, internal

reports

Hunting Operations

Conduct threat trend analysis for your company what you typically see- to identify when something deviates from the normal.

Information about attackers, Identify and search for new Compare large quantities of

where and how they

anomalous activity based off technical data to look for

communicate, who they of previously identified known outliers or anomalies.

target. Source: Social media,

TTPs. Source: News, blogs,

Source: News, blogs, 11 industry reports, internal

Strategic Intelligence

Operational Intelligence Tactical Intelligence

Technical Intelligence

Risk and Priority Assessment

Assess threats facing similar Assess whether ongoing

businesses.

attacks would impact

Source: DBIR, industry

business operations.

reports, annual reports

Source: News, industry

reports, internal reports

Evaluate threats have been seen in the past and how to best respond and prioritizing intel. Source: Log Data, internal reports

Identify what technologies should be in place to counter the most likely threats. Source: industry reports, internal reports

Situational Awareness Understand the implications Understand current or

Identify TTPs or indications of Technical details of threats,

of emerging or high profile planned campaigns and how a threat and determine how including exploitation of a

threats or vulnerabilities. to respond

to alert and respond.

vulnerability.

Source: News, blogs,

Source: News, blogs,

Source: News, Blogs,

Source: News, Blogs,

Industry reports

Industry reports, forums, industry reports

industry reports

social media

Threat Identification and Alerting

Provide trending data on what threats are impacting operations and actionable advice for decision makers. Source: News, blogs, Industry reports

Identify whether a current Alert on TTPs and mechanisms Provide automated alerting on

or planned attack is

associated with known

high fidelity threat

impacting you and

threats, including implications. information and help validate

determine how to respond. Source: News, blogs,

and interpret alerts.

Source: Blogs, social media, industry reports, internal Source: News, blogs,

forums.

reports

industry reports, internal

reports

Hunting Operations

Conduct threat trend analysis for your company what you typically see- to identify when something deviates from the normal.

Information about attackers, Identify and search for new Compare large quantities of

where and how they

anomalous activity based off technical data to look for

communicate, who they of previously identified known outliers or anomalies.

target. Source: Social media,

TTPs. Source: News, blogs,

Source: News, blogs, 12 industry reports, internal

Strategic Intelligence

Operational Intelligence Tactical Intelligence

Technical Intelligence

Risk and Priority Assessment

Assess threats facing similar Assess whether ongoing

businesses.

attacks would impact

Source: DBIR, industry

business operations.

reports, annual reports Source: News, industry

reports, internal reports

Evaluate threats have been seen in the past and how to best respond and prioritizing intel. Source: Log Data, internal reports

Identify what technologies should be in place to counter the most likely threats. Source: industry reports, internal reports

Situational Awareness Understand the implications Understand current or

Identify TTPs or indications of Technical details of threats,

of emerging or high profile planned campaigns and how a threat and determine how including exploitation of a

threats or vulnerabilities. to respond

to alert and respond.

vulnerability.

Source: News, blogs,

Source: News, blogs,

Source: News, Blogs,

Source: News, Blogs,

Industry reports

Industry reports, forums, industry reports

industry reports

social media

Threat Identification and Alerting

Provide trending data on what threats are impacting operations and actionable advice for decision makers. Source: News, blogs, Industry reports

Identify whether a current Alert on TTPs and mechanisms Provide automated alerting on

or planned attack is

associated with known

high fidelity threat

impacting you and

threats, including implications. information and help validate

determine how to respond. Source: News, blogs,

and interpret alerts.

Source: Blogs, social media, industry reports, internal Source: News, blogs,

forums.

reports

industry reports, internal

reports

Hunting Operations

Conduct threat trend analysis for your company what you typically see- to identify when something deviates from the normal.

Information about attackers, Identify and search for new Compare large quantities of

where and how they

anomalous activity based off technical data to look for

communicate, who they of previously identified known outliers or anomalies.

target. Source: Social media,

TTPs. Source: News, blogs,

Source: News, blogs, 13 industry reports, internal

Strategic Intel for Risk and Priority Assessment
"What threats are facing us? What can we do to prevent it?"
· Goal: Assess threats facing business similar to yours and present that
information in a digestible format
· Resources:
­ Verizon Data Breach Investigations Report ­ DBIR Industry Snapshot ­ Congressional Research Service ­ Internal resources
14

DBIR Industry Snapshot Healthcare
15

CRS Reports for Congress
· Cybersecurity Policy · Critical Infrastructure · Cybercrime and Data
Security · Cybersecurity framework · Reports by federal agency
16

Internal Resources
·Business Priorities ·Asset Management ·Third Party
Outsourcing
·Security Posture
17

Key Points:
· What are the largest threats to organizations similar to yours? · What types of threat actors target your organization? · What actions do they take? · Where do they attack? · Are we positioned to identify and defeat
an attack?
18

Tips for Reporting to the Board:
· Do not use jargon or overly technical terms · Discuss business impact of threats · Be prepared to answer questions · Tell the story · Keep it simple
19

Strategic Intelligence

Operational Intelligence Tactical Intelligence

Technical Intelligence

Risk and Priority Assessment

Assess threats facing similar Assess whether ongoing

businesses.

attacks would impact

Source: DBIR, industry

business operations.

reports, annual reports

Source: News, industry

reports, internal reports

Evaluate threats have been seen in the past and how to best respond and prioritizing intel. Source: Log Data, internal reports

Identify what technologies should be in place to counter the most likely threats. Source: industry reports, internal reports

Situational Awareness Understand the implications Understand current or

of emerging or high profile planned campaigns and

threats or vulnerabilities. how to respond

Source: News, blogs,

Source: News, blogs,

Industry reports

Industry reports, forums,

social media

Identify TTPs or indications of Technical details of threats,

a threat and determine how including exploitation of a

to alert and respond.

vulnerability.

Source: News, Blogs,

Source: News, Blogs,

industry reports

industry reports

Threat Identification and Alerting

Provide trending data on what threats are impacting operations and actionable advice for decision makers. Source: News, blogs, Industry reports

Identify whether a current Alert on TTPs and mechanisms Provide automated alerting on

or planned attack is

associated with known

high fidelity threat

impacting you and

threats, including implications. information and help validate

determine how to respond. Source: News, blogs,

and interpret alerts.

Source: Blogs, social media, industry reports, internal Source: News, blogs,

forums.

reports

industry reports, internal

reports

Hunting Operations

Conduct threat trend analysis for your company what you typically see- to identify when something deviates from the normal.

Information about attackers, Identify and search for new Compare large quantities of

where and how they

anomalous activity based off technical data to look for

communicate, who they of previously identified known outliers or anomalies.

target. Source: Social media,

TTPs. Source: News, blogs,

Source: News, blogs, 20 industry reports, internal

Operational Intel for Situational Awareness
"Is this attack that is happening going to impact us? Do we need to change anything to be prepared?"
· Goal: Understand ongoing or pending attacks and be prepared to
respond.
· Resources:
­ Social Media ­ Blog Posts ­ Government Alerts ­ Partners and peers
21

Operational Intel for Situational Awareness

Identify that there is a threat

Gather information

Make recommendations
on actions

22

Threat Identification
23

Social Mention

Google Alerts

24

Key Points:
· What is the operation? · Who is the target? · How have they attacked in the
past?
· Are we vulnerable to any of
those attacks?
· What are we seeing now that
could help us defend ourselves?
25

Tips for Reporting

· Be objective · Identify triggers · Identify constraints ­ if this is serious
what do you need to do your job?
· Provide updates

26

Strategic Intelligence

Operational Intelligence Tactical Intelligence

Technical Intelligence

Risk and Priority Assessment

Assess threats facing similar Assess whether ongoing

businesses.

attacks would impact

Source: DBIR, industry

business operations.

reports, annual reports Source: News, industry

reports, internal reports

Evaluate threats have been seen in the past and how to best respond and prioritizing intel. Source: Log Data, internal reports

Identify what technologies should be in place to counter the most likely threats. Source: industry reports, internal reports

Situational Awareness Understand the implications Understand current or

Identify TTPs or indications

of emerging or high profile planned campaigns and how of a threat and determine

threats or vulnerabilities. to respond

how to alert and respond.

Source: News, blogs,

Source: News, blogs,

Source: News, Blogs,

Industry reports

Industry reports, forums, industry reports

social media

Technical details of threats, including exploitation of a vulnerability. Source: News, Blogs, industry reports

Threat Identification and Alerting

Provide trending data on what threats are impacting operations and actionable advice for decision makers. Source: News, blogs, Industry reports

Identify whether a current Alert on TTPs and mechanisms Provide automated alerting on

or planned attack is

associated with known

high fidelity threat

impacting you and

threats, including implications. information and help validate

determine how to respond. Source: News, blogs,

and interpret alerts.

Source: Blogs, social media, industry reports, internal Source: News, blogs,

forums.

reports

industry reports, internal

reports

Hunting Operations

Conduct threat trend analysis for your company what you typically see- to identify when something deviates from the normal.

Information about attackers, Identify and search for new Compare large quantities of

where and how they

anomalous activity based off technical data to look for

communicate, who they of previously identified known outliers or anomalies.

target. Source: Social media,

TTPs. Source: News, blogs,

Source: News, blogs, 27 industry reports, internal

Tactical Intel for Situational Awareness
"Is this new tactic/tool/methodology going to impact us? How quickly do we need to respond?" Goal: Identify TTPs or indications of a threat and determine how to alert and respond. Resources:
­ News ­ Social Media ­ Blog Posts ­ Internal Resources
28

Tactical Intel for Situational Awareness

Identify threat

Identify key factors

Are you vulnerable?

Report

29

HD Moore's Law
"Casual Attacker power grows at the rate of Metasploit"
· Pay special attention to
vulnerabilities with Metasploit modules
· More attacker activity · Check your vulnerability · Identify artifacts and IOCs to
monitor
30

Metasploit Weekly Wrap Up
31

If you are vulnerable:
· Overview of the threat · Details of how it operates · What systems are at risk · How those systems fit into operations · Available remediation or workarounds
32

If you are NOT vulnerable:
· Not every threat will impact every
organization!!!
· Provide an overview of the threat · Details of how it operates · WHY it should not impact you · What to continue to look for
33

Tips for Reporting
· Technical terms are fine, but define if
you have a broad audience
· Provide links to sources · Use bullet points to call out important
details
· TIMELINESS IS KEY · Control the spin · Update as needed
34

Strategic Intelligence

Operational Intelligence Tactical Intelligence

Technical Intelligence

Risk and Priority Assessment

Assess threats facing similar Assess whether ongoing

businesses.

attacks would impact

Source: DBIR, industry

business operations.

reports, annual reports

Source: News, industry

reports, internal reports

Evaluate threats have been seen in the past and how to best respond and prioritizing intel. Source: Log Data, internal reports

Identify what technologies should be in place to counter the most likely threats. Source: industry reports, internal reports

Situational Awareness Understand the implications Understand current or

Identify TTPs or indications of Technical details of threats,

of emerging or high profile planned campaigns and how a threat and determine how including exploitation of a

threats or vulnerabilities. to respond

to alert and respond.

vulnerability.

Source: News, blogs,

Source: News, blogs,

Source: News, Blogs,

Source: News, Blogs,

Industry reports

Industry reports, forums, industry reports

industry reports

social media

Threat Identification and Alerting

Provide trending data on what threats are impacting operations and actionable advice for decision makers. Source: News, blogs, Industry reports

Identify whether a current Alert on TTPs and mechanisms Provide automated alerting on

or planned attack is

associated with known

high fidelity threat

impacting you and

threats, including implications. information and help validate

determine how to respond. Source: News, blogs,

and interpret alerts.

Source: Blogs, social media, industry reports, internal Source: News, blogs,

forums.

reports

industry reports, internal

reports

Hunting Operations

Conduct threat trend analysis for your company what you typically see- to identify when something deviates from the normal.

Information about attackers, Identify and search for new Compare large quantities of

where and how they

anomalous activity based off technical data to look for

communicate, who they of previously identified known outliers or anomalies.

target. Source: Social media,

TTPs. Source: News, blogs,

Source: News, blogs, 35 industry reports, internal

Technical Intelligence for Threat Alerting
"What is this thing??!?!" Goal: Make sense of alerts that the SOC has to deal with because of you Resources:
­ Virus Total ­ Blogs ­ Reports ­ Maltego
36

What can you do?
· You alerted on something for a reason ­ I hope · Key Details:
­ Where did the alert come from? ­ When was it flagged as malicious? ­ What activity is it associated with?
· Identify false positives
37

Passive Total
38

39

40

41

Maltego
· Passive Total · Threat Crowd · Paterva · Build your own machines · Developer Portal:
http://dev.paterva.com/developer/
42

Passive Total Transforms
43

Tips for Reporting

· Develop a process · Keep track of your findings · Provide related indicators or
behaviors
· Identify repeat offenders · Refine your block or alert lists

44

Reporting on ROI (or lack thereof)
· Make summaries · Capture the impact · What worked? · What didn't? · What needs to be changed? · Where are the pain points?
45

Building a Community
· Who needs money when you have friends? · Conferences · Summits (like this one!) · Working Groups · Your organization!
46

You've still got 98 other problems... ...but you're not alone.

Questions?

47

