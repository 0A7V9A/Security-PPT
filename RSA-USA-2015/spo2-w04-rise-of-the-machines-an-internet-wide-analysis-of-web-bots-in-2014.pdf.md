SESSION ID: SPO2-W04
Rise of the Machines: An Internet-Wide Analysis of Web Bots in 2014

John Summers
VP, Security Products Akamai

#RSAC

The Akamai Intelligent Platform

The Platform · 167,000+ Servers · 2,300+ Locations · 750+ Cities · 92 Countries · 1,227+ Networks

The Data · 2 trillion hits per day · 780 million unique IPv4 addresses seen quarterly · 13+ trillion log lines per day · 260+ terabytes of compressed daily logs

15 - 30% of all web traffic

©2014 AKAMAI | FASTER FORWARDTM

The Akamai Solution ­ Kona Site Defender + Prolexic

(Cloud) Data Centers
+

Origin Traffic
10000 1000
100
10
1

Akamai Traffic
10000 1000
100
10
1

COVERED

Avoid data theft and downtime by extending the security perimeter outside the data-center and protect from increasing frequency, scale andEnd User sophistication of web attacks.
©2014 AKAMAI | FASTER FORWARDTM

Leveraging Big Data to Understand Attackers
The following slides are based on a real events on January 5th 2014....
"Akamai, we are under attack!..."
©2014 AKAMAI | FASTER FORWARDTM

Ad-Hoc Attack Analysis
An attempt to exploit an old (2007) WordPress Remote File Inclusion vulnerability. The victim application was running ASP.NET

GET /wp-content/wordtube-button.php?wpPATH=http://www.google.com/humans.txt? HTTP/1.1 Host: www.vulnerable.site User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_4)

Attacked parameter : Malicious payload:

wpPATH http://www.google.com/humans.txt

©2014 AKAMAI | FASTER FORWARDTM

What Else Did This Attacker Do On This Site?
Same attacker Sent 2122 different RFI exploit attempts
©2014 AKAMAI | FASTER FORWARDTM

34 different sites were attacked by the same attacker with a total of 24,301 attacks
©2014 AKAMAI | FASTER FORWARDTM

Was There Similar Activity Going On At The Same Time?
Attacks originated from a botnet containing 272 attacking
machines
1696 victim applications were targeted 1,358,980 attacks were launched during the campaign The campaign lasted for 2 weeks
©2014 AKAMAI | FASTER FORWARDTM

Security Big Data at Akamai: Cloud Security Intelligence

20 Terabytes of daily attack data 2 Petabytes of security data stored Up to 90 days retention 600K log lines/sec. indexed by 30 dimensions 8000 queries daily scanning terabytes of data

Benefits
Unrivaled Web Security visibility
· Perform WAF accuracy analysis on any customer at any time
· Detect new attacks, including 0-day and quickly issue new protections
· A powerful web security research tool
· Improve WAF Accuracy
· Behavioral analytics platform

©2014 AKAMAI | FASTER FORWARDTM

Behavioral Analytics & the Akamai Intelligent Platform

DATA SOURCES
Kona WAF Triggers
Akamai Logs ­ "WAF Light"
Akamai Logs ­ Behavioral

CSI Platform
IPs

HEURISTICS
Attack Patterns Client Behavior Application Profiling NAT Detection False Positive Reduction

©2014 AKAMAI | FASTER FORWARDTM

Proactive Security using Behavioral Analytics
Cloud Security Intelligence

www.customer.site

©2014 AKAMAI | FASTER FORWARDTM

Grow revenue opportunities with fast, personalized web experiences and manage complexity from peak demand, mobile devices and data collection.
©2014 AKAMAI | FASTER FORWARDTM

Risk score decay

Grow revenue opportunities with fast, personalized web experiences and manage complexity from peak demand, mobile devices and data collection.
©2014 AKAMAI | FASTER FORWARDTM

Grow revenue opportunities with fast, personalized web experiences and manage complexity from peak demand, mobile devices and data collection.
1549 SQL injection attempts w/37 unique payloads
©2014 AKAMAI | FASTER FORWARDTM

Grow revenue opportunities with fast, personalized web experiences and manage complexity from peak demand, mobile devices and data collection.
691 SQL injection attempts w/18 unique payloads
©2014 AKAMAI | FASTER FORWARDTM

Grow revenue opportunities with fast, personalized web experiences and manage complexity from peak demand, mobile devices and data collection.
232 SQL injection attempts w/9 unique payloads
©2014 AKAMAI | FASTER FORWARDTM

Grow revenue opportunities with fast, personalized web experiences and manage complexity from peak demand, mobile devices and data collection.
©2014 AKAMAI | FASTER FORWARDTM

Bots on the Akamai Platform

Avoid data theft and downtime by extending the

How many bots does Akamai sepseeroctuIeNrcittyfOrpoemNrimEinectrDeeraAosuYintDgs?iadfrteeaqthCueeondlAclaeyptac,r-sticelce1danl-et2e,arn2adn0d15

8.01 BILLION

sophistication of web attacks.

Bot requests in 24-hours

Total Requests:

85,475,034,620

Bots were 9.4% of all requests

©2014 AKAMAI | FASTER FORWARDTM

Bots on the Akamai Platform

24%
Other Bots

42%
Crawlers, Spiders & Scrapers

Avoid data theft and downtime by extending the security perimeter outside the data-center and
8.01 protect from increasing fre6q%uency, scale and sophistication of web attacAkPsI.Engines
Billion requests
26%
Search engines & site indexers

1%
Security scanning

©2014 AKAMAI | FASTER FORWARDTM

Bots on the Akamai Platform

42%
Crawlers, Spiders & Scrapers

24%
Other Bots
Crawlers, Spiders & Scrapers:
Avoid data2t4h%eft aCndondotewnnttiSmcerbaypeexrstending the security pe7ri%meterAoduvtseirdteistihnegdata-center and
8.01 protect from3%increDasaitnagAfrge6qg%ureengcayt,osrcsale and sophisticat2io%n of wWeebbatAtarcAckPhsIi.Evnegrisnes Billion requests2% Website Monitors
1% SEO Ana2ly6z%ers
1% Social MeSdeairach engines & site indexers

1%
Security scanning

©2014 AKAMAI | FASTER FORWARDTM

Bots ­ The Akamai Viewpoint

24%
Other Bots

42%
Crawlers, Spiders & Scrapers

ComAvmoiodndabtaotthecfht aanldlednowgnetsime by extending the
security perimeter outside the data-center and
8.01 · Sptoroletnecint tferollmecitnucarleparsoipnegrtfyre6q%uency, scale and
· InscorpehaissetidcaptrioicneocfowmepbetaittitoancAkPsI.Engines ·BillAiodndirteioqnuaelsbtsandwidth costs
· IT infrastructure overhead 26%
· DDoS and application downtiSmeearch engines & site indexers

1%
Security scanning

©2014 AKAMAI | FASTER FORWARDTM

Bots ­ The Akamai Viewpoint

8.01
Billion requests

Avoid data theft and downtime by extending the
Botsmecaurnitay gpeermimeetnert onuetseiddesthe data-center and
· Bportodteectetcfrtioomn ainncdreidaesnintgificfraetqiounency, scale and · Asdovpahnicsetidcabtoiotnreosfpwoenbseasttacks.
· Report on bot activity and mitigations applied
· Policies to enable business-level protection

©2014 AKAMAI | FASTER FORWARDTM

A Year in the Life of a Botnet
In January 2014 we published a blog on a global botnet:
· https://blogs.akamai.com/2014/01/analyzing-a-malicious-botnet-attack-campaign-through-thesecurity-big-data-prism.html
Exploiting Joomla Content Editor vulnerability to install backdoors
Began as a "single event" analysis of the exploit
"Zoomed out" and discovered an entire botnet mining the web for vulnerable Joomla servers
©2014 AKAMAI | FASTER FORWARDTM

A Truly Global Botnet
Avoid data theft and downtime by extending the security perimeter outside the data-center and protect from increasing frequency, scale and sophistication of web attacks.
©2014 AKAMAI | FASTER FORWARDTM

And a Very Active Botnet
· 43,000 malicious HTTP requests seen over the month · 2008 different web applications were targeted
©2014 AKAMAI | FASTER FORWARDTM

10 months later, the Botnet lives on...
In Nov. 2014, the team began a 3 month follow on analysis
The botnet now contains 1037 members.
All members are compromised public Web servers, mostly running Joomla and WordPress CMS
The Botnet has targeted more than 7800 applications over the period
Note ­ the data is only based on Akamai customers ­ probably targeted many more applications
©2014 AKAMAI | FASTER FORWARDTM

Active Members Over Time
©2014 AKAMAI | FASTER FORWARDTM

New Botnet Members Over Time
©2014 AKAMAI | FASTER FORWARDTM

Activity Duration of Botnet Members and Evolution
On average, Joomla botnet members spurted malicious traffic over 29 days.
To compare, compromised web servers running other Web platforms, were maliciously active for 10 days on average.
· The reason for the difference between Joomla and the rest of the servers is unclear · Likely related to the massive exploitation of the Joomla vulnerability
The Botnet evolved over time to attempt to also exploit other vulnerabilities:
· Remote File Inclusion (RFI) on the TimThumb image resizer WordPress module · Remote Code Execution (RCE) on the Open Flash Chart library
©2014 AKAMAI | FASTER FORWARDTM

Longevity of Members
Comparing the active Botnet members from 9 months ago to now
· 43 of the botnet members were also maliciously active 9 months ago. · 4% of botnet members have not been "cleaned up" for 9 months
Surprising, given that:
· The botnet targets a 3-year old vulnerability. Vulnerable web servers should have been upgraded with newer software ages ago · The awareness for the usage of this vulnerability in the wild. This is not the first publication of a JCE vulnerability exploitation · The botnet activity is visible and loud, targeting many applications across the Internet, making it easy to be detected.
©2014 AKAMAI | FASTER FORWARDTM

Closing Thoughts
Simply exposing a botnet and it's tactics has little impact
Shutting down members of a Botnet only causes it to breed faster
Broad visibility across the web into these kinds of attacks is part of the solution
Effective mitigation requires a way to share actionable information about botnets and other repeat attackers
A risk scoring reputation system can provide such actionable data
©2014 AKAMAI | FASTER FORWARDTM

John Summers, VP Security Products
jsummers@akamai.com

