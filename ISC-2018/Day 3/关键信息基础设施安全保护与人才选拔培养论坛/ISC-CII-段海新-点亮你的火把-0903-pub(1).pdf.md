 


-

 

2


· 
 ·  · 

SP H h We

· GM

0

· TSQIG cd E L

ØJN

l

Ø

1A 9

Ø

a G iI

· RH h We

Ø 9 0 , , / 0, 00,

Ø

4

C/

C 9 9 A4

an

7o

·

t

0 , , 01,2

Ø g sr DkF i

Ø ,1 -2

9

t

y

Ø

iGC

y

· Ø Ø Øv

k

k

g sr

kU

srT

I i Dk
kT e

2

C

S

· 6 IN 6w

Ø

Ø E 6G

Ø

D

S

Øk

e 00

·

6

Sn

ØXc U

Ø

0

4 P5

Ø

,1

1

,

2

05


 

6

-

0

6 3
0

03

  

 % '"$ 
 # #&  !
https://github.com/mechaphish


· 
 ·  · 

, Pretty Bad Proxy, S&P 2009

· 
· Proxy's error page: e.g., 502-server-not-found, other 4xx/5xx response; · Script in error page runs in https://bank.com.

browser

PBP

https://bank.com

502:Servhettrpnso:/t/fbo<auinfnrkad.mcoemsrc= "https://bank.com">

Bank server

, Cookies Lack Integrity, USENIX'15

SCeot-oCokoikeie::UUIIDD==AMliSceae;lcSlouerceyure

Bank.com



Cookie: UID=...

HTTPS Only
HTTP Request

03

Cookies

HTTP Set-Cookie: UID=Mallory

UID=MAliaclelory

A Secure Flag doesn't protect Integrity !!!


 

Gmail
· Injecting cookies into HTTPS can cause serious attacks such as account hijacking
HTTPS HTTP
Replace your friend list in Gmail/Gtalk with hackers
16

 


51
5

 


 

As suggested in our USENIX paper, Google can investigate how frequently HTTP URLs set or overwrite secure cookies, with the hops that ... to disable this functionality.

NDSS'16 
Idea 
· % $ (
! )"# '
 &
victim.COM

CDN

attacker.COM


 Host of Trouble, CCS 2016,  

Cache/Proxy

CDN

NSA.GOV

HTTP Request:
GET http://NSA.GOV/path HTTP/1.1 Host: ATTACKER.com
Middle box Confused: NSA or ATTACKER ?

attacker.com

/
24


 NSA

98% 
 
26

/
CDN+


" (CDN))( ,.+
 -#CDN*& ! %'$" 10


 

27


 

 
CDNInternet 
CDN
29


· 
 ·  · 


 

· 
· =+>8 · =+: · "+$
· 
 
· '#+ · )+! · +
· 
· 631+ · &- · (./+@,%7

· 
· 02 ?1 · ?1!02 ;<
· 
· *954


+WD7;>(3
· ,.=(3
· MK7(3 W6%X?87*F : · G7(30.7V
· 'G)C7'
· 
SE9X&4QH · PU'!#7PU 2-;>L · (37'EG)C!#7(31 
· /N
· O3X/N · IJ7"TXB$5-@AX R<


· !' !"# 
· ! !! · !
%& · $(

!1
Ø3*$&# . Ø'&
Ø-,3+
Ø(%&%&/0 Ø2
) !"

 

