Computer Security and Forensics
Defense vs. Post-mortem 

Dr. K.P. Chow 
Computer Forensics Research Group  Center for Information Security and Cryptography  University of Hong Kong 
201311
2 CISC


3
CISC






Non-professional theft and un-

organized criminal



4

CISC



· CIA

­ (Confidentiality)

­ (Integrity)

­ (Availability and Accountability)

· Measures

­ Encryption  ­ Integrity check  ­ Authentication  ­ Audit trails  ­...
CISC

:
5


    ...
6
CISC


computer forensics before Computer Forensics
7
CISC


":
­
8
CISC



­, e.g. computer generated reports
­, e.g. log records ­...
CISC, HKU
9
CISC


 ...
 DDoS ...
10
CISC

 



Top sites to share copyright protected materials



1.  (professional) 2.  (organized crime) 3.  (lots of money)
11
CISC


? ? 
? ·...

12
CISC

"





Data Carving ()
CISC

Technology
13

" 
Mobile Phone Recovery
14
CISC





DNA

Forensic Science 




15

CISC








16
CISC

?
· What has happened ()? · Who did that ()? · When was that happened (
)? · How it was happened ()? · Why ()?

Recovery again

()

17

CISC


1. 
­  ­ 
18
CISC

Image Carving 
original image ()

Smart Carving  (Memon's Adroit)
Technology 
Data in another fragment 


2. 
­  Feb 22 2005
21
CISC



 1

 2

 3

 4

  1

 2

 2

 4

 1

 3

 3

22


3. 
 2 Jan 2004,   0000-1111-2222-3333 ,   4 Aug 2009
23
CISC



CISC

+

24

?

­ " ,
 .
?
25
CISC

?

­e.g.   ("knowledge" of the existence of the child porn images)
:,   , ...
26
CISC

?
 (Adversary system) 
­ 
 , .
27
CISC

Daubert's Rule ()
 (A rule of
evidence regarding the admissibility of expert witnesses'
testimony)
 Has the theory or technique been reliably tested ( )
 Has the theory or technique been subject to peer review ()
 What are the theories or techniques known or potential error rates ()
 Do standards and controls () exist and are they maintained
 Has the theory or techniques been generally accepted () in its scientific community 28

  IT'S NOT FOR ME ()
29
CISC

 
, 
 ·...
30
CISC

Beyond Data Recovery 
 (Data recovery  technology)
 (Event and scene reconstruction  reasoning)
 (Digital evidence handling  legal issue)
31
CISC


 
  
32
CISC

"



:

:

­ (unbiased) ­ (no. of cases handled) ­ (reports accepted by the
court) ­ (professional background) ­ (amount the client
willing to pay)



33

CISC


34
CISC





(aka )
2008127
35
CISC

Who is Edison Chen?
?
· Who else?
· Who are they? ?
36
CISC

20081
127: Edison Guillian  
128: Edison  Bobo, Edison  Guillian, 
129: 5Guillian 2 Cecilia
130: 4Cecilia
37
CISC

What are the forensics questions?
?
· Are the photos real or hoaxes? ?
· Who posted the photos on the forums? ?

Image Processing Problem



38

CISC

Are the photos real? ?

· Factors to be considered:

:

­ Lighting  ­ Eyes and positions  ­ Specular highlights  ­ Send in the clones  ­ Camera fingerprints

· Forensic photography



Not our discussion today



39
CISC

Who posted the photos on the forums?
?

User YT Chung
IP address A

Photos uploaded to a
forum outside HK 


Photos downloaded


Photos downloaded
from a forum in HK 
()

Forum B outside HK B
Photos of G
G
Forum A in HK A

How YT Chung was found? On Jan 31, first person, YT Chung, is arrested for the case YT Chung  131, YT Chung, CISC

Photos of G and C
GC

40


 · ID/...
41
· IP CISC

Investigation techniques 

· Tracing using the IP address IP

­IP

­(ISPs)  IP

IP assigned to Subscriber at Time

IPSubscriber

ISP

Time

Post by User from IP at Time
User IP Time 

Subscriber

Forum F

42
CISC

Forensics techniques 

· Digital evidence in the suspect's PC

 

User YT Chung's PC

Digital evidence in the hard disk, e.g. Internet access history, the photos  

43
CISC

The Law 
· What was the crime act? ?
­ Violates the "Control of Obscene and Indecent Articles Ordinance" (COIAO) in Hong Kong: publishing obscene articles " :  
44
CISC

Difficulties



?=

· Who was using the computer? ?
­ vs. IP ­ 

Who am I? 

User  YT Chung

Photos downloaded



45

CISC

?
 Edison!
The correct question should be: "Who was the first one `get' the copy from Edison and sharing it?" 
46
CISC

... (2008)
2242, Elite ­1 Cecilia 
24: HC Sze 
· 25: 4,  Guillian, Cecilia, BoBo Rachel
26: 209 29:237?, 
Guillian, Cecilia, BoBo  Vincy !
47
CISC

Any scientific methods?


· How the computer repair shop Elite was located? Elite?
­ Traditional investigation technique 

Source of the photos: Edison's PC

Hacking 

Hacker

 



Sharing





Friend



Repairing 



Technician

The most likely path 

48

CISC

What are the forensics questions?

· HC Sze 
­ HC Sze was charged with "access to computer with criminal or dishonest intent" HC Sze "
­ 
· Who is Kira? 
­ HC Sze? Not sure 
49
CISC

CRIME SCENE RECONSTRUCTION 
50
CISC

The beginning

Some events 

Date (2008) Jan 29
Feb 1 Feb 2 6:55am Feb 2 7:45pm Feb 2 10:10pm Feb 3 Feb 16
Feb 18
Feb 21 Feb 27 Feb 28

Event Photos of Edison and celebrities available on the Internet Mak's CD was seized Janet's CD (with "X" mark) and PCs at home were seized
Sze was arrested Sze's home PCs were seized Tse's home PC was seized (nothing relevant was found)
Yip's home PC was seized (Edison's photos from the Internet were found) Chan's home PC was seized (nothing relevant was found) Edison's home PCs were seized Store's PC was seized Elite's server was seized
51
CISC

Edison vs. Janet and Mak
Janet 52
CISC

Who were Mak and Janet? MakJanet?

Driver
Mr Wong (PW6)

belongs

Edison

Mac Book Pro

Elite Computer Shop

Computer Service

Store

Emp

Janet

Fanny (PW1)

Emp
Janet (PW2)
CISC

give to
CD "X"

Mak's CD
belongs
Mak
Loan / Return
53

The Beginning: Edison's MacBook Pro brought to Elite for service : Edison

Elite
Employer
Tse

Edison
belongs to
Mac Book Pro
Bring to service

54
CISC

When, where and how were the photos found?
Service Day to +4 days: photos inside
the MacBook Pro were found 4: 

Elite

Emp

Emp

Sze

 Tse

View together

Delete 3-4 days afterwards

Back up Profile

Folder Lifestyle

inside

External Harddisk

CISC

Mac Book Pro
inside
Harddisk

55

How the photos get out of Elite?
8 June 2008: Sze performed computer service at "Store" 200868: Sze

Elite Sze

Service

Store
belongs
Power Mac G5 Duo

Some Server (unknown)
Download To Power Mac G5

Logon / Password



Fanny

View photos

Janet

Folder

Burn to CD

give to
CD "X"

Mak's CD
belongs
Mak
 
Loan /
Return
56

 Mak's CD 
Mak's CD
???
57
CISC

Crime Scene Reconstruction
External Harddisk

Other Server
Sze's Home Server

Folder Lifestyles

Make Copy

Copy

Upload to Server

Download

knowledge
Tse

charge 1 charge 2
Sze

Elite Server
charge 3

3 charges of access to computer with criminal or dishonest intent
3
CISC

Power Mac G5
Folder
Create CD
CD "X"
58

For The Court 
· 3 charges of access to computer with criminal or dishonest intent: 3 
· digital evidence  · witness statements  · digital crime scene reconstruction 

59
CISC

?
2 Sze  CD
 2
"
60
CISC

?
1. " 2.  3.  4. 
61
CISC

The story never ends 
· Who is Kira? ?
­ YT Chung ­ very unlikely ­ HC Sze ­ probably not
· Can we trace Kira using IP address traceback? IP?
­ Some more details 
62
CISC

OUR ATTEMPT TO FIND KIRA 
63
CISC

Photos by Kira
· The photos by Kira uses Foxy peer to peer software to share: Foxy: ­  "fox (hurry on bit the fox), "  ­ ,   ­ Foxy
· Can we find the first uploader in the Foxy network? Foxy?
64
CISC

What is Foxy? Foxy?
· A Traditional Chinese peer to peer file transfer program  
· Initially published by Foxy Media, Inc. Widely used in Hong Kong and Taiwan 
· Very popular in upper primary schools and secondary schools 
65
CISC

Foxy Architecture Foxy 
1. Connecting to the Foxy network Foxy
2. Search for files on the Foxy network Foxy
­ Gnutella 2 
3. Download file from a peer peer
­ http 
66
CISC

Connecting to the Foxy network

Foxy

(2) Server returns a peer list to USER

59.39.71.220 59.39.71.217 59.39.71.219

Foxy Server

(1) USER connects to Foxy server to obtain a peer list

(5) USER now part of the Foxy network

(4) The peer returns a PONG request to the USER

(3) USER sends a PING request to each peer

67

Keyword search in Foxy Foxy

Keyword search using "confidential"

Search result indicates 40 files with "Confidential" are being shared.

There are 182,810 people online when the
search is performed.

Keyword searching in Foxy Foxy

Hey, I need a file with name ""
I don't have the file, and I don't know any of my peers have the file, I'll forward to my peers

""

Ultrapeer

""

Ultrapeer

""

· The Gnutella Query request will return a list of peers (IP addresses) that has a full copy that matches the request

""

I have that file ...

CISC

I also have that file ...

69

Downloading a file from the peer peer

Hey, I need a file with name ""

""
Ultrapeer

Ultrapeer

HTTP GET /urires/N2R?urn:sha1: ...

""

70

I have that file ...

CISC

Hey, I need a file with name ""

Some findings



peersFoxy



"Query "" peers 

Ultrapeer

IP 

peer



Ultra-

peer

""

I have that file ...

CISC

I also have that file ...

71

HOW CAN WE FIND KIRA? ?
ALL PEERS ARE IDENTICAL! WHAT CAN WE DO?
PEER 
On Jan 2005 (20051):
The first man ( Big Crooke) in the world was arrested by Hong Kong Customs and Excise officers for distributing movies using BT
(Big Crooke),BT  How can they find the Big Crooke if all peers are identical?
peers, ?
Use heuristic rule to identify "potential" first seeder "

File distribution in P2P network P2P

Confirm existence of growth period 

No. of seeders

G22 (23 hrs)@23:14
2500

2000

1500 1000
500

Estimated Total Active

0 0 2 4 6 8 10 12 14 16 18 20 22 24
Hours

Who may be the source? 
· May be able to find under the following conditions: :
­ At the slow rising period  ­ The file is large 
· Impossible after the slow rising period: unable to confirm who was the first source 
75
CISC

Rule to find the first uploader 
· On continuous monitoring  ­ If a large volume of queries about a specific name are identified, and 
Ricci Ie­oLnagrge volume of query hits are come from the s:aemWe aIPlkaedrdCreossnsulting CEO
IP
· It is very likely that IP address is the first uploader IP
If you are interested, please read our research papers.


 ,
 , 

 ,
77
CISC


" "

78
CISC


 
 
:
79
CISC

Resources
· http://en.wikipedia.org/wiki/Edison_Chen_photo_scandal
· Eastweek magazine, vol. 233, 13 Feb 2008
· P. Crowley, CD and DVD Forensics, Syngress, 2007
· R. Jones, Internet Forensics, O'Reilly, 2006
· R. Ieong, P. Lai, K.P. Chow, M. Kwan, F. Law, H. Tse & K. Tse, Forensic Investigation of Peer-to-Peer Networks, Handbook of Research on Computational Forensics, Digital Crime and Investigation: Methods and Solution, IGI Global, 2009.
· R. Ieong, P. Lai, K.P. Chow, M. Kwan & F. Law, Is it an Initial Seeder? Derived Rules that Indicate a Seeder is within the SlowRising Period, Sixth IFIP WG 11.9 International Conference on Digital Forensics, 2010.
· Frank Y.W. Law, K.P. Chow, Pierre K.Y. Lai & Hayson K.S. Tse, A Host-based Approach to BotNet Investigation, 1st International Conference on Digital Forensics and Cyber Crime, 2009.
· R. Ieong, P. Lai, K.P. Chow, F. Law, M. Kwan and K. Tse, A Heuristic Approach for Investigating the P2P Foxy Network,, Fifth Annual IFIP WG 11.9 International Conference on Digital Forensics, Orlando, Florida, USA, January 25-28, 2009
80
CISC

81
CISC


(Computer Forensics Research Group)

:

­4 + 2 

­4++ 2+

­3

­

­ 

:

­: 

­

: CISC

http://i.cs.hku.hk/~cisc/forensics/ 82



: (part time students)
­  (Police officer, customs officer, ICAC officer)
­  (Prosecutor)
­  (Clinical psychologist)
­  (IT security specialist)



CISC

­ 

83

 (some projects)

:
­ DESK () ­ ­ ­ ­ ­



­ Digital identity profiling: 

CISC



84



CISC

85

­ DESK (2005)
 (Digital Evidence Search Kit)

CISC

86

CISC

­ BTM (2006) BitTorrent Monitoring System

· BitTorrent, 



· , , 

BT

IP

· 20074, 

CISC

( I)

CISC

87
87

Auction Site Monitoring  (2011)

( II)

CISC

88

CISC

 

CISC

89

 





 
FAT 

, 
BTM, FoxyMon, DESK,  , Cloud
CISC


  DESK/QQ, BTM 2.0,
 , Mobile device
CISC



90
90

 (1)

­ Bayesian Network  ­ Time model 

­ ­ ­ Legal privileges
protection
91
CISC

 (2)
 Cyber criminal profiling
­ ­ ­

­ ­ SCADA 
92
CISC



CISC

93

- 
: DESK 
:   Cyber Security Lab, IHEP

­ 20108: IHEP  (Linda)   

­ 201011:   (Pierre, Linda and Erica)

­ 20112: (7 )

CISC

94



 CCFC ()



: 

  





CISC



95

 ­ 2011/12
  joined our PhD programme to work on data craving
· Sept 2011 ­ Mar 2012: 
· Nov 2011:  
· Dec 2011: 
· Mar 2012:  

CISC

96



· Y. Yang, K.P. Chow, L. Hui, L. Wang, L. Chen, Z. Chen & J. Chen,
·  Forensic Analysis of Popular Chinese Internet Applications, Hong
Kong, 3-6 January 2010, Advances in Digital Forensics VI, Ch.7,
 pp.95-106, Springer (2010).

· ,·11A,

2010.



· J. Fang, Z. Jiang, S.M. Yiu, K.P. Chow, L. Hui, L. Chen and X. Niu, A

Dual Cube Hashing Scheme for Solving LPP Integrity Problem, in
·  Proceedings of the sixth International Workshop on Systematic
Approaches to Digital Forensic Engineering (SADFE 2011), Oakland,
· California, USA, 2011. ,  · R. Xu, K. P. Chow, Y. Yang: Development of Domestic and
International Computer Forensics. IIH-MSP 2011: 388-394

· , · J. Fang, Z. Jiang, K.P. Chow, S.M. Yiu, L. Hui and G. Zhou, MTKbased Chinese Shanzai mobile phone forensics, Proc.8th Annual  IFIP WG 11.9 International Conference on Digital Forensics, Pretoria,

CISC

South Africa, 2012, Advances in Digital Forensics VIII (to appear). 97

 - ()
· ICDFI 2012 : The First International Conference on
Digital Forensics and Investigation ( ), Beijing , China,
21-23 Sep 2012

· ICDFI 2013: The Second International Conference on Digital Forensics and Investigation (
), Wuhan , China,
12-13 Sep 2013

CISC

98

ICDFI 2013
 Renmin University of China, Beijing
· ICDFI Forensic Challenge 2014

CISC

99


100

