Mobile Malware Madness and How to Cap the Mad Hatters
A Preliminary Look at Mitigating Mobile Malware
Gerry Eisenhaur, Michael N. Gagnon, Tufan Demir, Neil Daswani
© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Mobile Malware Madness: Recent Case Studies
· DroidDream (Android)
­ Over 50 root'ed apps uploaded to Google app marketplace
­ Conducts data theft; send credentials to attackers
· Ikee.A (iOS)
­ Experiment; changed wallpaper to Rick Astley image ­ Worm capabilities (targeted default ssh pwd) ­ Worked only on jailbroken phones with ssh installed
(could have been worse)
· Zitmo (Symbian, BlackBerry, Windows Mobile)
­ Captures mTANs from SMS messages; aimed at defeating 2-factor auth ­ Works in conjunction with Zeus botnet; sent in conjuction with user PC infection ­ Propagates via SMS; claims to install a "security certificate"

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 2

Behavioral Analysis
· What is Behavioral Analysis?
­ Run applications to see what they do ­ assess their "behavior" ­ Look at "what the code does" not "what it looks like"
· Why Behavioral Analysis? Answer questions such as:
­ What domains and/or IPs are accessed via the network at run-time, and what is the access pattern?
­ How many entries in the address book are accessed? Is each entry or some threshold number of entries accessed? Are all or some significant number of entries accessed serially, or is the access pattern random?
­ Are the accessed address book entries sent over the network? Is sensitive data or PII leaked?

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 3

Behavioral & Signature-Based Detection: Working together

· Behavioral and signature-based detection are complementary · Behavioral detection on a client will suck battery life ­ should be done "in the cloud" / on a server · Behavioral analysis can provide signatures to client-side anti-virus

Cloud-Based Behavioral Scanning

Client-Side Signature Check

Auto-generate signatures

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 4

Principles for Mobile Malware Detection

· Malware becoming ever more sophisticated and mutable  Must use behavioral detection approaches
­ Malware variations growing exponentially ­ Easy for criminals to distribute malware ­ Combination of static/signature-based and behavioral approaches needed
· Some combination of cloud-based analysis + client side protection necessary
­ Limited resources (CPU, memory) on the endpoint to analyze content (URLs) and applications in real-time
­ Problem compounded on mobile devices ­ Perform analysis in the cloud; prevent and remediate on the client (and/or edge)
· Take advantage of massive amounts of data
­ Build libraries of millions of mobile apps over time, each behaviorally analyzed for malicious behavior

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 5

Behavioral Study of 10K Android Apps

· 10K apps chosen at random from 30 different categories on Google Android Marketplace
· Analyzed in an emulator for 30 seconds
· Minimal simulated user interaction (although we could have done more)
· Found / Studied:
­ Privacy violations: IMEI / IMSI Leakage ­ Network access / Traffic patterns ­ Bandwidth usage ­ SMS activity ­ System call activity

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 6

8.4% of Android Apps Leaking Personal Information (IMEI)
Android Applications Requesting/Leaking IMEI Percent
IMEI requested but not sent
IMEI leaked (clear)
IMEI leaked (hash)
0 5 10 15 20 25
Source: Dasient (n=10,000)
© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Only requested IMEI Actually leaked IMEI
· Static analysis approaches would only identify that IMEI was requested; however, cannot tell if the IMEI was actually leaked
· Static analysis only could yield "false positives"
· Dasient has forensic evidence that the IMEI was leaked in 8.4% of the apps
Page 7

Network Behavior
Top 50 Domains Accessed by Android Apps

Source: Dasient (n=10,000)
© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 8

System Call Activity
Top System Calls Made by Android Apps

Source: Dasient (n=10,000)
© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 9

Bandwidth Usage
Bandwidth Usage of Android Apps

Source: Dasient (n=10,000)
© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 10

Ex. Behavioral Signals for Malware Detection

· Hundreds of these

· Example #1: Number of processes
­ Baseline: 58.3, Std Dev: 4.5 ­ DroidDream: 660.3 (due to "rageagainstthecage"), Std Dev: 238.8

· Example #2: Undesired SMS activity

Name Fakeplayer.A Fakeplayer.B Fakeplayer.GEN Bgserv.A Twalkupi.A

# of msgs 3 4 4 1 # of contacts

Number 3353, 3354 7132 7132 10086 contacts

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 11

Mobile Drive-bys

· No social engineering or user interaction required to compromise device; just visit a web page
· Smart phones are vulnerable, valuable, and use common software packages (e.g., Webkit)
· Prototype attack: Drive-by data ex-filtration ­ steal Skype Ims
1 User visits compromised web page 2 Exploit WebKit vuln CVE-2010-1807 3 Attacker connects to device via backdoor 4 Find Skype username 5 Exploit Skype vuln CVE-2011-1717 6 Traverse to user's Skype data directory 7 Send files to attacker's machine 8 Run SQLite locally & read user's convos

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 12

Notification: Privacy Violation

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 13

Alert: Malware (DroidDream)

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 14

Summary + Q&A
· Significant growth in mobile malware in past two years · Behavioral analysis can complement static analysis to identify mobile
malware · Studied 10K Android apps + malware
­ Identified IMEI / IMSI leaks ­ Undesired SMS ­ Identified behavioral signals of malware
· Prototyped mobile drive-by attack
· We're Hiring! Contact us at careers@dasient.com

© 2011 Dasient, Inc. CONFIDENTIAL. DO NOT DISTRIBUTE.

Page 15

