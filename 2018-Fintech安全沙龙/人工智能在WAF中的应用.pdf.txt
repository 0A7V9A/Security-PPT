WAF
Derekli 

1 WAF 2  3 

1

WAF


· http · Syslog · File
system


· flume · logstash


· Kafka · redis


· ES · mysql


· keras · tensorflow


Web app

WAF
·  ·  · CC

WAF

2



https://channel.fenqile.com/query_filter_list.json?line_type=category_id_1&category_id=327

key line_type category_id

channel.fenqile.com/product/query_filter_list.json category_id_1213 32713

 10000 uuid

 

 

 



 

  

 

 

LSTM 

 

WAF

 LSTM 

2



https://channel.fenqile.com/query_filter_list.json?line_type=category_id_1&categor y_id=3232"><script>alert(/D/)</script><"
https://channel.fenqile.com/query_filter_list.json?line_type=category_id_1&categor y_id=3232 or 1=1
https://channel.fenqile.com/90sec.php
https://channel.fenqile.com/mail_address.json?add=aaaaaaaaaaaaaaaaaaaaaaaaaa aaaaaaaaaaaaaaaaaaaaaaa@bbbbbbbbbbbbbbbbbbbbbbbbbbbb.com
......

XSS SQL Web shell ReDos

3 

category_id 327 328 390 452 522 1025
1212122222221 110 or 1=1

 3 3 3 3 3 4 13 10





     

https://channel.fenqile.com/query_filter_list.json?line_type=category_id_1&category_id=327

3 

line_type line_type category_id category_id

1 13 2 3 1

2 13 2 4 3

3 14 2 10 1

4 25 3 3 1

https://channel.fenqile.com/query_filter_list.json?line_type=category_id_1&category_id=327

4

LSTM

1.2

16×1

h0

h1

h2

h3

0.8

h62

h63

0.9

0.3

1.1

A

A

A

A

...

A

A

0.5

8×1

X0

X1

X2

X3

X62

X63

0.2 ...

256×1

I0

I1

I2

I3

s

c

r

i

I62

I63

o

n

 or


4

LSTM

----one-hot

s e i r p t a n om 1000000000



0100000000

s e i r p t a n om

0010000000

0.8 0.9 0.2 0.6 0.9 0.1 0.1 0.2 0.2 0.9

256

0001000000 0000100000

a2vec

0.9 0.2 0.9 0.7 0.9 0.9 0.7 0.9 0.9 0.2 0 0.3 0.6 0 0.6 0 0.3 0.6 0.6 0.3

0000010000

0.3 0.6 0.9 0.2 0.9 0.6 0.6 0.9 0.9 0.6

8

0000001000 0000000100

8*256 matix

0.6 0.1 0.7 0.5 0.6 0.8 0.9 0.6 0.2 0.6 0.2 0.9 0.8 0.6 0.1 0.2 0.9 0.3 0.1 0.8

0000000010

0 0.5 0.5 0.9 0.5 0.7 0.5 0.2 0.5 0.7

0000000001

0.1 0.4 0.9 0.5 0.9 0.2 0.4 0.9 0.7 0.8

0000000000

0000000000

..............................

4

LSTM

4

LSTM

16*1

h0

h1

h2

h3

h4

A

A

A

A

A

8*1

X0

X1

X2

X3

X4

s

r

i

p

t

0.8

0.6

0.2

0.9

0.1

0.9

0.7

0.9

0.9

0.9

0

0

0.6

0.6

0

0.3

0.2

0.9

0.9

0.6

0.6

0.5

0.7

0.6

0.8

0.2

0.6

0.8

0.1

0.2

0

0.9

0.5

0.5

0.7

0.1

0.5

0.9

0.9

0.2

h5

h6

h7

A

A

A

X5

X6

X7

......

h62

h63

...

A

A

X62

X63

o

n

0.2

0.2

0.9

0.9

0.6

0.6

0.9

0.9

0.2

0.6

0.1

0.3

0.5

0.2

0.7

0.9

4
h63

LSTM

0.8

w0

0.9

w1

1.1

w2

1.3

w3

0.6

w4

0.2

...

...

1.9

0.1

0.9

0.9

0.6

0.9

... 0.6
0.1

0.5

0.9

W=[1*16]



3.0

0.95





4

LSTM

5

SRC

http://security.lexinfintech.com/
SRC 

