2019
McAfee
Flash Flash
Haifei Li, Chong Xu

01
PART 01



CONTENTS

02

03

PART 02
Flash 

PART 03
FlashMicrosoft Office

04
PART 04
FlashPDF 

05
PART 05




Haifei Li.      CanSecWest ()Black Hat USA 2015 Microsoft Blue Hat 2016, Syscan360 2012 Tencent TenSec 2016Syscan360 Seattle 2017 2017Pwnie Awards

Chong Xu.   
APT, 
IPS IPS 

PART.01
CLICK ADD RELATED TITLE TEXT, AND CLICK ADD RELATED TITLE TEXT, CLICK ADD RELATED TITLE TEXT, CLICK ON ADD RELATED TITLE WORDS.




Ø Adobe Flash - 
Ø Flash Ø /flash Ø 
Ø Apple App Store/Google Play Store Ø FacebookFlash Ø flash Ø 
Ø Flash Ø Flash Ø Flash Ø 

Ø Flash ­ 

Ø 0-day - 2011flash
0-day
CVE-2011-0609 CVE-2011-0611 CVE-2011-2110 CVE-2012-0779 CVE-2012-1535 CVE-2012-5054 CVE-2013-0634 CVE-2013-5331 CVE-2014-0497 CVE-2014-0502 CVE-2014-0515 CVE-2014-8439 CVE-2014-9163 CVE-2015-0310 CVE-2015-0311 CVE-2015-0313 CVE-2015-3043 CVE-2015-3113 CVE-2015-5119 CVE-2015-5123 CVE-2015-5122 CVE-2015-7645 CVE-2015-8651 CVE-2016-0984 CVE-2016-1010 CVE-2016-1019 CVE-2016-4117 CVE-2016-4171 CVE-2016-7855 CVE-2016-7892 CVE-2017-11292 CVE-2018-4878 CVE-2018-5002
CVE-2018-15982

Ø Flash exploit
Ø Flash.swf Ø FlashMicrosoft OfficePDF

PART.02
CLICK ADD RELATED TITLE TEXT, AND CLICK ADD RELATED TITLE TEXT, CLICK ADD RELATED TITLE TEXT, CLICK ON ADD RELATED TITLE WORDS.
Flash

Flash 

Ø Flash Ø Google Chrome Ø Microsoft Edge Ø Microsoft Internet Explorer Ø Mozilla Firefox
Ø Flash Ø Click-to-play Ø sandbox

Flash - Chrome
Ø Flash"Pepper Flash Player"
Ø ChromeFlash 20156https://chrome.googleblog.com/2015/06/betterbattery-life-for-your-laptop.html Ø Flashclick-to-play ChromeFlash

Flash - Edge
Ø WindowsCOMFlash Windows 8+Flash  Ø Edge201612Flash 
Flashclick-to-play

Flash - Edge
Ø Edge Ø 201811Google P0Ivan Fratric https://bugs.chromium.org/p/project-zero/issues/detail?id=1722 Ø Flash Ø 
Ø https://www.facebook.com Ø https://apps.facebook.com Ø Ivan Fratric201812Edgeclick-to-play  https://bugs.chromium.org/p/project-zero/issues/detail?id=1747

Flash ­ Internet Explorer
Ø EdgeIEWindowsCOMFlash Ø Chrome/EdgeIEclick-to-play Flash IE
Ø  Flash

Flash ­ FireFox
Ø FirefoxFlash Ø FirefoxFlash AdobeFirefox NPAPI Flash Ø FlashFlash click-toplay

Flash 
 ­ 

Ø  - Click-to-Play



Flash  Click-to-play



Google Chrome PPAPI (Pepper Flash) Yes

Jun 2015

Microsoft Edge Windows ActiveX/COM Yes

December 2016

Internet Explorer Windows ActiveX/COM No

N/A

Mozilla Firefox NPAPI

Yes

Ø  - 

August 2017

PART.03
CLICK ADD RELATED TITLE TEXT, AND CLICK ADD RELATED TITLE TEXT, CLICK ADD RELATED TITLE TEXT, CLICK ON ADD RELATED TITLE WORDS.
FlashMicrosoft Office

Ø 20185FlashOffice(ActiveX/OLE) 

Flash

Flash

Ø Office Flash 0-day

Microsoft Office



CVE



 Flash in Office

201710 20182

CVE-2017-11292 CVE-2018-4878

Word Excel

20186

CVE-2018-5002

Excel

201812 CVE-2018-15982

Word

Flash Microsoft Office  Flash in Office

Ø 
Ø 2018514OfficeFlashblog Office 365
Ø Office 365 Monthly Channel20186 Ø Office 365 Semi Annual Targeted (SAT) Channel20189 Ø Office 365 Semi Annual (SA) Channel20191
Ø OfficeOffice 365 2018Office 2016Office 2019Flash
Ø OfficeOffice 2010Office 2013

Flash Microsoft Office  Flash in Office

Ø Adobe
Ø OfficeFlashFlash Playercontainer (Office) 2010Office 2007 Flash
Ø Flash for Officeclick-to-play Ø Office 2010
Ø 20187Flash Player 30.0.0.113 AdobeOffice Ø Adobe Office 2010Office 2013

Ø Flash in OfficeOfficeFlash



Office



Flash

Office 2010/2013

click-to-play

Microsoft Office

Office 2016/2019/365



 Flash in Office

Ø 2018Flash 0-day Ø AdobeMicrosoftFlash 0-day





Ø 

Flash 0-day

Flash Microsoft Office  Flash via Office

Ø 20182Flash via OfficeOffice Flashhttps://votiro.com/think-you-are-just-watching-a-video-thinkagain/ Ø Word""(insert online video) IEFlash 

Flash Microsoft Office  Flash via Office

Ø Flash via OfficeFlash in Office
Ø Flash via Officeclick-to-playMicrosoftAdobe 
Ø Flash via OfficeWord object
Ø Flash in OfficeFlashOfficeFlash via OfficeFlash IEIECOM
Ø Flash in OfficeFlash via OfficeFlashIE IEIE
Ø Flash via OfficeOffice 2013Office 2010

FlashMicrosoft Office Flash via Office

FlashMicrosoft Office Flash via Office
Ø Flash via OfficeFlash in Office 
Ø OfficeFlash 
Ø  Word

PART.04
CLICK ADD RELATED TITLE TEXT, AND CLICK ADD RELATED TITLE TEXT, CLICK ADD RELATED TITLE TEXT, CLICK ON ADD RELATED TITLE WORDS.
FlashPDF

FlashPDF
Ø FlashPDF Ø WindowsPDF
Ø Adobe Reader Ø Foxit Reader

FlashPDF  ­ Adobe Reader

Ø FlashPDFAdobe ReaderFlashAdobe Reader NPAPIFlash Player Ø FlashPDFFlashclick-toplay Ø Adobe ReaderFlash
Ø Adobe ReaderNPAPIFlash Firefox
Ø FirefoxFlashNPAPIFlash Ø FirefoxFirefoxFlashclick-
to-play Ø Adobe ReaderPDFFlash exploit

Ø Adobe ReaderFlashAdobe ReaderFlashclick-to-play

Ø Foxit ReaderSafe Reading Mode

Foxit ReaderFlash



FlashPDF

Ø PDFFlash 

 ­ Ø Foxit Reader

Foxit Reader Ø Adobe ReaderNPAPIFlash
Foxit ReaderWindows 8/8.1/10

COMFlash

Ø Foxit ReaderFlash

(medium integrity level)

FlashPDF ­ Foxit Reader
Ø : Foxit Reader FlashPDF

Ø Foxit Reader





FlashPDF  ­ Foxit Reader

Ø   Ø Foxit Reader PDF



Ø OK





FlashPDF  ­ Foxit Reader

Ø  Foxit Reader 
Ø Windows 9.4.1.16828Foxit Reader 


Ø 

Ø 

FlashPDF  ­ Foxit Reader

Foxit Reader20198 9.6.0.25114 




FlashPDF  ­ Foxit Reader

Ø 9.6.0.25114 Foxit Reader 

Ø 
Foxit Reader Foxit Reader Ø Foxit Reader 

FlashPDF  ­
Foxit Reader 

Ø Foxit Reader 
Ø 
Foxit Reader Ø 
Ø 
Ø PDF PDFFlash
Ø HaifeiFoxitFoxit CVE

PART.05
CLICK ADD RELATED TITLE TEXT, AND CLICK ADD RELATED TITLE TEXT, CLICK ADD RELATED TITLE TEXT, CLICK ON ADD RELATED TITLE WORDS.


Ø Flash
Ø  Ø Chrome, EdgeFirefoxFlash click-to-play Flash Ø IEFlash
Ø Microsoft Office Ø 2018MicrosoftAdobeOffice Ø 2018MicrosoftAdobeFlashFlash 0-day Ø Flash via Office
Ø PDF Ø Adobe ReaderFireFox Ø Foxit Reader

Ø 
Ø Flash Flash 0-dayIE 
Ø Microsoft OfficeFlash via OfficeOffice
Ø PDFPDFFoxit Reader 


 Haifei Li (Haifei_Li@McAfee.com) Chong Xu (Chong_Xu@McAfee.com)
 McAfee IPSBing Sun 

