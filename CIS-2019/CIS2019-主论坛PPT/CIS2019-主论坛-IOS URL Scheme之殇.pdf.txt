iOS URL Scheme 
Lilang Wu

WHO AM I
· Android/macOS/iOS CVE-2016-*, CVE-2018-*, CVE-2019-*
· Android APKsExploit · Fuzz Project
BH USA 2019, 2018, BH EU 2018, HITB, CodeBlue, VB Twitter: @Lilang_Wu

iOS URL Scheme
· App · App · App

iOS URL Scheme
· AppURL · myphotoapp:albumname?name="albumname"
· info.plist · URL SchemeHandle

iOS URL Scheme Warning
https://developer.apple.com/documentation/uikit/interprocess_communication/allowing_apps_and_websites_to_link_to_your_content/defining_a_custom_url_scheme_for_your_app

1 ­  - CVE-2016-7651

1 - 

2 ­ Repack or Fake
Bundle IDRepack

2 ­

2 ­ 
· Repack FacebookBundle ID · CVE-2016-4659 iOS 10.0CVE-***
· Repack AppOfficial App · https://support.apple.com/en-us/HT209106 iOS 12.0
Refer: https://www.fireeye.com/blog/threat-research/2014/11/masque-attack-all-your-ios-apps-belong-to-us.html

2 ­ 

2 ­ 

Compromised

Payload

· Facebook
·  PayloadFacebook Bundle ID 
· Provision 

2 ­ 

Compromised

Payload

· Facebook
·  PayloadFacebook Bundle ID 
· Provision 

3 ­  ­ 

3 ­  ­ 
· AppWeChatTokenURL Scheme
URL Scheme,APPID
· WeChatTokenURL Scheme
Authentication Code

3 ­  ­ 
· Bundle ID APPURL Scheme
· iOS 11.0 
· URL SchemeApp
· iOS 11.0
· URL Schemefirst-come-first-served

3 ­  ­ 

3 ­  ­ 

3 ­  ­ 

4 -  - 
·  · 


4 - 

4 -  ­ 

4 ­ 

4 ­ 


· 

· 574407955@qq.com · 574407955

