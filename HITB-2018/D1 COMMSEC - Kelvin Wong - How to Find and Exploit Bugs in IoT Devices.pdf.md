Digging  Deep:  How  to  Find  and   Exploit  Bugs  in  IoT  Devices  
Kelvin  WONG  
1  

Speaker@
Ø SANS  DFIR  Summit   Ø DFRWS  EU   Ø HTICA  US   Ø DefCON  20   Ø HITCON   Ø CodeBule   Ø AVTokyo   Ø APWG   Ø ISC2  APAC  Congress  

ISLA  (Asia  Pacific)     2016  Honoree  

PublicaUons
» 10  years  experience  in  Digital   Forensics  
» Facebook  Forensics  (2011)  on  Hakin9   Magazine  
» Mac  Memory  Forensics  (2014)  on   Digital  Forensics  Magazine  
» InvesUgaUon  and  Intelligence   Framework  (2015)  on  Forensics   Focus  
» Advanced  Mobile  Devices  Analysis   Using  JTAG  and  Chip--Off  (2016)  on   eForensics  Magazine  

Hacking  IoT  ?  
4  

A`ack  Vector  on  IoT  
» Ecosystem   » Device  Memory   » Device  Physical  Interfaces   » Device  Web  Interface   » Device  Firmware   » Etc...(OWASP  IoT  project)  
5  

Protocol  /  Sodware  based
» Wifi   » BLE   » Zigbee   » RF   » NFC   » HCE  
6  

Hardware  Based  ?  
7  

Cherry  Blossom  ­  Page  124,  Para  13
8  

Hardware  based  method?
» UART   » JTAG   » ISP   » Chip--off
9  

JTAG
» Joint  Test  AcUon  Group   » Communicate  with  memory  chips  
through  Test  Access  Ports(TAPs)   » Physical  data  acquisiUon   » Have  different  pins  
10  

Test  Access  Port  (TAP)  
» TCK  ­  test  clock   » TMS  ­  test  mode  state   » TDI  ­  test  data  in     » TDO  ­  test  data  out   » TRST  ­  test  reset   » NRST  ­  normal  reset   » RTCK  ­  return  clock   » GND  ­  ground  
11  

Linksys  Router  JTAG  pins
12  

UART
» serial  communicaUons  over  a   computer  or  peripheral   device  serial  port    
» Transmilng  and  receiving  serial   data  
»   See  the  output  from  console  
13  

UART  pins  
14  

15  

BusBlaster    

Alfy    

Etc.......     16  

OpenOCD  
» Open  Source   » Open  On--chip  Debugger  tool   » Provide  debugging,  in  system  
programming  and  boundary--scan  test   » Work  with  a  list  of  debug  adapter   » Support  a  list  of  router/chips  
configuraUon  
17  

18  

19  

Kill  the  watchdog  and  halt  system  
20  

Print  the  kernel  address  value  
21  

Magic  Header  of  Kernel  SecUon  
22  

Memory  Dump
» firmware--recovery  script  from  Openocd   » Image_dump(If  address  do  not  match)   » CFE  Memory:  0x9fc00000,size:0x40000  
KERNEL  Memory  :  0x9fc40000,  size: 0x1B0000   NVRAM  Memory  :  0x9fDF0000,  size: 0x10000  
23  

24  

25  

Whole  FLASH  sturture  
» Common  Firmware  Environment   (CFE)  --  bootloader  
» Kernel  --  firmware   » NVRAM  --  store  variable  informaUon  
26  

Secret  
» Plaintext  username  and  password   » No  authenUcaUon  is  required  for  
console  login   » RAM  address:  0x80000000  size:
0x01000000  
27  

ISP  ­  In  System  Circuit  Programming  
28  

Amazon  Alexa  
29  

Chip--Off  
30  

Google  Home  Mini  
31  

Chip--off  Village  by  VXRL  
32  

VXCON  on  21--22  April  in  Hong  Kong  
33  

Discount  code  for  HITB  AMS  
`hitb@ams_@vxcon2018'   h`ps://www.eventbrite.hk/e/vxcon--2018-- Uckets--43644511910   Or  www.vxcon.hk  for  agenda     
Thank  You!  
   34  

