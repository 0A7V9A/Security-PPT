
hacking java sandbox on Cloud AppEngine

About Me
·  ·  · kxlzx · QQ4700012 (&EMAIL) · BLOGhttp://www.inbreak.net · http://t.qq.com/javasecurity

· App Engine · BY PASS · 




· 
­ 
· 
­ 
· 
­ 
· 
­ 

App Engine
·  ·  · 

App Engine
WEB WEB WEB WEB WEB WEB
sandbox JAVA
App Engine (manage,monitor) server cloud

·  ·  · JAVA ·  · 




·  ·  ·  · 


· 
­  ­  ­ 
· GOOGLE

appEngine
· ACE · BAE · SAE ·  · ...... · 


·  · 


·  · 

· JAVA · JAVA

JAVA


· CLASSLOADER ·  · Class · 


· applet
­ 
· appEngine
­  ­ J2EE


· 
­ GAESAE
· getPolicy ·  · Class. getProtectionDomain.
getPermissions




· CVE20120507 applet · AnonymousFBI
­ Anonymous ­ AntiSec ­ AtomicReferenceArray ­ CVE20120507
·  · JDK


·  · crackClassLoader
­ 




·  ·  ·  ==  · == getRuntime.exec(cmd) · 
­ 


· 
­  ­  ­ 
·  ·  x=  ·  · 


·  · J2EE


· JAVA ·  · SaeSecurityManager.checkRead() · Webroot · Webroot/../../../../etc/passwd · 




· JDK · SaeSecurityManager
­ Private readPath  ­ Private writePath  ­ Private deletePath 
· suppressAccessCheck ·  · SaeSecurityManager





·  ·  ·  · 


·  · 
­ SAE
·  · java.beans.Statement
­ Private AccessControlContext acc;






· BYPASS7 · SAE10W · 



JAVA
· System.setSecurityManager · Policy.setPolicy ·...

1
· java.beans.Statement localStatement = new
java.beans.Statement(Policy.class, "setPolicy", new Object[]{new MyPolicy()});

Baidu App Engine
· createClassLoader

createClassLoader
· classLoader · ClassLoader
 · kxlzxClass
 · kxlzxClass

createClassLoader

createClassLoader

Baidu App Engine
· NEW · ProtectionDomain · Java.beans.Statement · ......

Baidu App Engine

· java.lang.String -· Com.baidu.XXXX · Net.inbreak.XXX


allPermissions --  -- 


· <%=getClass().getProtectionDomain()%>

· 

Baidu App Engine

Baidu App Engine

Baidu App Engine

GAE

GAE
·  · 0Day · Class · java1.7 · Google


· app · JETTY · bypass ·  · 

· THANKS

Q&A

