CTF
 
2021 SDC-


1 2 3 4 5


Base64 /  + 


Base64 /  + 
14 Base643  1.X1 12 


Base64 /  + 
2  a6bitsb 


AESKCTF2.  Themida Sub, ShiftRow, MixColumn, Xorhandler. handler RoundKeyAddRoundKey Xor
https://xilinx.github.io/Vitis_Libraries/security/2020.1/_images/original_flow.png


AESKCTF2.  Sub Shift, MixColumn, AddRoundKey,   AddRoundKey 
https://xilinx.github.io/Vitis_Libraries/security/2020.1/_images/original_flow.png



AESKCTF2. 

 

/

https://www.researchgate.net/profile/NicolasSklavos/publication/228656196/figure/fig2/AS:670002449494028@1 536752440629/Advanced-Encryption-Standard-AES-SchemeArchitecture.png



1 2 3 4 5




CTF  {true, false}.
  = f(username, key)
  = equal(f(username, key), )  = equal(f(username, key), g(username))


 f : A -> B f = equal fn-1 ... f3 f2 f1 T

T

f1 f2 f3 fn-1 equal

A -> A1 -> A2 -> A3 -> ... -> An -> B

B  true  Tips:  f: D -> R D = D1  D2, f1: D1 -> R1, f2: D2 -> R2, R = R1  R2


1 f(x) = y   
2 f(a, b) = y  g  g 1 g 
 f_i({x_i}) = y_i 
3 f(a, b) = y  g 
4


  
 f: D1  D2 -> R1  R2, f1: D1 -> R1, f2: D2 -> R2, I = R1  R2  I / R1.  D2   I  I D1,D2   I 





  



 bugHash


CTF crackmexA xA  xdd----d


  


A = {handler} A(x) = {?/} A1(x) = {} A2 = CFF
qA_q. x_qA_qx_qA_q 
A



  :   AST  


 /
d, x, A" d  x  A " 


AB. B
 AB
 BA != AB != BA
 CTF


 CTFCatalan
" "
  flag----


 VSdebugAES
 aes(f(username, flag), aes_key) = g(username) aes_key  aes_key = h(username)   aes_key = h(username, key) 2
aes(input) = 


aes = aes_round aes_round = AddRoundKey mss mss = MixColumns ShiftRows SubBytes  AddRoundKey 
&  MixColumns  
https://xilinx.github.io/Vitis_Libraries/security/2020.1/_images/original_flow.png

 MixColumns
(d, x, Q)1 = ()  (d, x, Q)2 = ( )   y = ax + b ()
https://xilinx.github.io/Vitis_Libraries/security/2020.1/_images/original_flow.png

 AddRoundKey
 key expansion
 -> NAND, NOR, IMPLY----  ->  ----  ->  ----
NOR Vmp VmpvAdd

VMP
(d, x, Q) = ()  -------- --------
(d, x, Q) = (/windbg r)  context 
CTF

handler 
Themidahandler
handler handler /  handlerhandlerhandler handler
Tipshandlerhandler AES


"" 
 patch  
 

CFF
CFF(Control Flow Flattening)  if  while 

while (loop){ switch (state){ case INIT: state = select_S1_S2(...); break; case S1: do job1; state = W; break; case S2: do job2; state = W; break; ... case END: loop = false;
break; }
}

while (loop){ switch (state){ ... case W: do job3; state = select_W_WNEXT(...); break; case WNEXT: ... ... }
}

CFF
CFF AST  /
https://blog.jscrambler.com/jscrambler-101-control-flow-flattening


 () ->  () ->  () ->  () -> 
 CFF    


  =()   
    


 256 global counter = 0; SelfCheckBasicBlock_X(data){
data[counter] = data[counter] xor X; counter++; } AddRoundKey. 


NAND, NOR, IMPLY / NIMPLY   ()   


 -> NAND/NOR or   ->   ->   -> 
Tips:  ->  /   -> /CTF  ->  &   -> 


 Reversible Gate RGX (Reversible Gate XRUG) ABCPQRRGX+  xor P=AB+!A!C Q=AB+BC+CA R=B!C+!BC
SOP (Sum of Products)   SOP  or  xor  = non-cannonical SOP = cannonical SOP Q = AB+BC+CA = ABC + !ABC + A!BC+ AB!C


SOP  RGX SOP RGSOP
RGXIDA RGX  IDA


Barrington andnot is_zero01 



GGH CTF

ABC P=(AB)^(!A!C)

000

1

001

0

010

1

011

0

100

0

101

0

110

1

111

1




     Barrington handlerhandler 


ID: 

