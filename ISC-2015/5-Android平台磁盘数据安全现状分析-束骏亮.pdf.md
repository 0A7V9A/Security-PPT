 @ LoCCS GoSSIP

Android 



· GoSSIP
· Android
· 0ops
· Androidsteganographyforensicsmisc
http://weibo.com/u/3659841663

ANDROID


ANDROID
·  · 

ANDROID
· 90%Android · App


ANDROID
·  ·  · Android

ANDROID

· Android · Android ·  ·  ·  · 

ANDROID

 (Android)
 (yaffs2 & ext4)
 (FTL)
 (Flash memory)

ANDROID
Android----
Flash Memory() ·  

ANDROID
Android----
: ·  (block)/ · 10^4~10^5

Android----FTL
Flash Translation Layer(FTL): ·  Flash Memory 

Android----FTL
FTL: ·     · (GC)  ·  

Android----
YAFFS2ext4: · YAFFS2(Yet Another Flash File System) · Ext4(The fourth extended file system) · (Log-structured File System)

Android----
: ·   ·    

Android----
·  
·  · 


Android----


200MB 1GB 2GB

()



>95%

41.5±2.6

46.2±0.5

163.1±7.1

169.7±7.8

349.4±11.2

370.3±5.9

Android----
·  

Android
· API ·  · Recovery · Fastboot

Android
-API

Android
-API
· File.delete()
/libcore/luni/src/main/java/java/io/File.java/delete() -->/libcore/luni/src/main/java/libcore/io/Posix.java/remove() -->/libcore/.../libcore_io_Posix.cpp/Posix_remove() -->remove()
· Linux syscallunlink(2) rmdir(2) · 

Android
-

Android
-

Android
-
deletePackage() ->deletePackageAsUser() ->deletePackageX() ->deletePackageLI() ->removeDataDirsLI() ->remove() ->uninstall() ->_delete_dir_contents()
· Linux syscall: unlinkat(2) · 

Android
-

Android
-
· Android4.0 · Android4.0GoogleRecovery
make_ext4fs userdata · 

Android
-
· Recovery SD(SDuserdata )rm ­rfuserdata 
· CWM RecoveryTWRP 
· 

Android
-fastboot

Android
-fastboot
· Fastbootuserdata make_ext4fs
·  · 

Android
-
· (FDE) · FDEAndroid 5.0
FDE · Android 5.0
Android 7%Android 5.0

Android
-
· Android · 
 · 


·  · 



-

· log
· Extundeleterecuvaufs 
· 



-file carving

·  · (block)
· binwalkforemost 
· (SQLite)



-cell carving

· (block) ·  · SQLite
carving


·  ·  · 


· API
 85.64MB 150.63MB 400.30MB

 100% 100% 100%


· 

/   

 86/100 79/79 80/80

QQ 184/190 160/160 149/156

 64/79 73/78 40/69

Facebook Snapchat

65/70

23/25

66/70

13/15

66/70

15/15


     

()
Samsung Galaxy S3 (Android 4.2.2)
Sony Lt28H (Android 4.4.2)
ASUS Nexus7 (Android 4.4.2)
LG Nexus4 (Android 4.4.2)

Recovery
TWRP 2.7.0.0
CWM 6.0.4.6
TWRP 2.6.3.0
CWM 6.0.3.0
TWRP 2.6.3.1
CWM 6.0.4.3
TWRP 2.6.3.3
CWM 6.0.4.7

/ 

11.5GB /
3022848

98.03% 84.86%

2.00GB /
524288

0.48% 0.00%

3.84GB /
1007616

89.06% 93.26%

13.1GB /
3449600

95.41% 94.21%


· 15Android


·  · 100MB/GB · 350/GB · apkdex
 · 


·  · 100MB/GB · 350/GB · apkdex
 · 


· dex


· token


·   


· IM


· /ROM · Recovery · API (BLKSECDISCARD)


· App ·  ·  


·  · // Recovery · fastboot 


·  ·  · 

thx Q&A

