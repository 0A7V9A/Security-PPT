Exploit  PLC  on  the  internet
Z--0ne

PLC 


PLC
· Programmable  Logic  Controller
­  ­ CPU ­  ­ I/O ­ 

· PLC
­  ­ 

PLC

· PLC
­  ­ 

· PLC
­ Codesys ­ ProConos
· 
­ Linux ­ Vxworks ­ WinCE
· 
­ 
· Modbus
­ 
· S7 · Omron F  INS



· 
­ RS232/485
· 
­ MPI
· 
­ TCP/IP ­ UDP

PLC


· Stuxnet PLC
­  ­ 

(1)
· PLCSCADA 
­  ­  ­ 

(2)

· PLCSCADA 

­ 



ERP

­ 

­ 

APPLICATION MES





P L

P L

P L

P L




· /
­  ­  ­ 

(1)

(2)

(2)

PLC PLC S7  
PLC  ON  THE  INTERNET

S7--1200

S7--300

PLC  CPU(1)
· S7(TCP/102)
­ http://www.zoomeye.org/search?q=port%3A102 ­ https://www.shodan.io/search?query=Module+po
rt%3A102
·  ()
­ ZoomEye à 1446   ­ Shodan à 2749 ­ Plcscan.org  à 2215

PLC  CPU(2)
· S7(TCP/102)
­ Nmap à s7--enumerate.nse(TSAP:0102) ­ PG  mode ­ Rack:0  Slot:2

PLC  CPU(3)
· 
­  350 ­  255 ­  179 ­  146 ­  124 ­  113 ­  108 ­  74 ­  67 ­  64

PLC  CPU(4)

· 

­ 6ES7  214--1AG31--0XB0 145

­ 6ES7  214--1AE30--0XB0

142

­ 6ES7  212--1HE31--0XB0

129

­ 6ES7  315--2AG10--0AB0 129

­ 6ES7  151--8AB01--0AB0 121

­ 6ES7  315--2EH14--0AB0 120

­ 6ES7  315--2AH14--0AB0 88

­ 6ES7  214--1BG31--0XB0

74

­ 6ES7  314--6EH04--0AB0 74

­ 6ES7  313--5BF03--0AB0

73

PLC  CPU(5)

· 

­ Version: 3  .0.2

472

­ Version: 2  .2.0

142

­ Version: 2  .6.0

113

­ Version: 4  .0.0

96

­ Version: 2  .6.11

76

­ Version: 3  .2.10

76

­ Version: 3  .2.6

69

­ Version: 3  .3.8

59

­ Version: 3  .2.3

59

­ Version: 3  .2.8

55

PLC  CP(1)
· S7(TCP/102)
­ Nmap à s7--enumerate.nse(TSAP:0100) ­ Rack:0  Slot:0
· ()
­ Plcscan.org    à 486

PLC  CP(2)
· S7(TCP/102)
­ Nmap à s7--enumerate.nse(TSAP:0100) ­ PG  mode ­ Rack:0  Slot:0

PLC  CP(3)
· 
­  91 ­  76 ­  32 ­  29 ­  26 ­  25 ­  23 ­  18 ­  14 ­  14

PLC  CP(4)

· 

­ 6GK7  343--1CX10--0XE0 305

­ 6GK7  343--1EX30--0XE0

70

­ 6GK7  343--1CX00--0XE0 19

­ 6GK7  343--1EX11--0XE0

18

­ 6GK7  443--1EX20--0XE0

16

­ 6GK7  443--1EX11--0XE0

14

­ 6GK7  343--1EX21--0XE0

14

­ 6GK7  343--1EX20--0XE0

13

­ Unknown

4

­ 6GK7  343--1GX21--0XE0 3

PLC  CP(5)

· 

­ Version: 3  .0.23

104

­ Version: 2  .3.2

79

­ Version: 2  .0.16

60

­ Version: 2  .6.0

56

­ Version: 2  .1.14

31

­ Version: 2  .2.20

22

­ Version: 1  .1.5

15

­ Version: 2  .5.0

14

­ Version: 1  .2.3

9

­ Version: 1  .0.26

8

PLC

PLC  (1)
· Conpot
­  ­ 
· S7(TCP/102)
­ Serial  number  of  module:  88111222
· 
­ ZoomEye à 48 ­ Shodan à 61 ­ Plcscan.org  à 30

PLC  (2)

S7 (1)
· TCP/102S7 
­ IP ­  ­ 

S7 (2)
2015--07--09  09:27:20  [71.6.167.142] C  lient  added 2015--07--09  09:27:20  [71.6.167.142] T  he  client  requires   a P  DU  size  of  480  bytes 2015--07--09  09:27:20  [71.6.167.142] C  lient  added 2015--07--09  09:27:21  [71.6.167.142] T  he  client  requires   a P  DU  size  of  480  bytes 2015--07--09  09:27:21  [71.6.167.142] R  ead S  ZL  request,  ID:0x0011  INDEX:0x0001  ----> O  K 2015--07--09  09:27:21  [71.6.167.142] R  ead S  ZL  request,  ID:0x001c  INDEX:0x0001 - ---> O  K 2015--07--09  09:27:21  [71.6.167.142] C  lient  disconnected   by  peer 2015--07--09  09:27:25  [71.6.167.142] C  lient  disconnected   by  peer C:\Users\Administrator>nslookup   71.6.167.142 :    google--public--dns--a.google.com Address:    8.8.8.8
:        census9.shodan.io Address:    71.6.167.142

S7 (3)
2015--05--06  19:53:49  [5.61.38.11] C  lient  added 2015--05--06  19:53:55  [5.61.38.11] C  lient  added 2015--05--06  19:53:58  [5.61.38.11] T  he c  lient   requires   a  PDU  size  of  480 b  ytes 2015--05--06  19:53:58  [5.61.38.11] C  lient  disconnected  by  peer 2015--05--06  19:53:59  [5.61.38.11] R  ead S  ZL  request,  ID:0x0011 I  NDEX:0x0000 - --->  OK 2015--05--06  19:53:59  [5.61.38.11] R  ead S  ZL  request,  ID:0x001c  INDEX:0x0000 - --->  OK 2015--05--06  19:54:00  [5.61.38.11] R  ead S  ZL  request,  ID:0x0132 I  NDEX:0x0004 - --->  OK 2015--05--06  19:54:02  [5.61.38.11] B  lock o  f  type  OB  list  requested  (start  sequence)  ---->  NOT  AVAILABLE 2015--05--06  19:54:03  [5.61.38.11] B  lock o  f  type  FB  list  requested  (start  sequence)  ---->  NOT  AVAILABLE 2015--05--06  19:54:03  [5.61.38.11] B  lock o  f  type  FC  list  requested  (start  sequence)  ---->  NOT  AVAILABLE 2015--05--06  19:54:03  [5.61.38.11] B  lock o  f  type  DB  list  requested  (start  sequence)  ---->  OK 2015--05--06  19:54:04  [5.61.38.11] B  lock i  nfo  requested  DB  1  ---->  OK 2015--05--06  19:54:04  [5.61.38.11] B  lock i  nfo  requested  DB  2  ---->  OK 2015--05--06  19:54:05  [5.61.38.11] B  lock i  nfo  requested  DB  3  ---->  OK

(1)

(2)

(3)

(4)

(5)

(6)

S7--300  PLC S7--300  PLC S7 S7--300  PLC TCP/UDP Socket
EXPLOITS  S7  PLC

S7--300(1)
· 
­ Step7
· "CPU( ) "
· "() " · ""

S7--300(2)
· 

S7--300
· 
­ " "/"  "
· ""
­ LV2/LV3CPU

S7(1)

S7(2)
· HydraS7

S7--300  MC7

MC7  (1)
· 
­ S7kafapx.exePLC 
­ S7 
­ Stuxnet
· 

MC7  (2)
· S7--300  PLC
­ OBFC ­ DB ­ FC ­ FB ­ SFC ­ SFB
 ­ SDB
PLC

MC7  (3)
· 70  70  //MC7 · 01  01   · 02  // hex:0x02  LAD  (KOP) · 08  // hex:0x08  OB · 00  01  // hex:0x00,0x01   · 00  00  00  96  // · 00  00  00  00  // · 03  22  C8  2E  2C  20  // · 03  9D  CB  0C  11  4C  // · 00  1C  // · 00  30   · 00  14  // · 00  02  //MC7

STL: A          M            8.0 AN        T            6 L          S5T#3S SD        T            0 NOP      0 NOP      0 NOP      0 NOP      0 STL: A          T            0 =          L          20.0 A          L          20.0 BLD      102 =          Q        124.0 A          L          20.0 L          S5T#3S SD        T            1 NOP      0 NOP      0 NOP      0 NOP      0

MC7  (1)

MC7  (2)

MC7  (3)

MC7  (4)
·  1

S7  300  PLC
· 
­ S7 ­ S7 ­  ­ FMS ­ FDL ­ ISO ­ ISO  on  TCP ­ TCP ­ UDP ­ 

S7  300  PLC
· 
­ PLC  CPUPLC  CPU ­ PLC  CPUPLC  CPU ­ PLC ­ PLC

S7  300  CPFC5/6
· 
­ FC5à "AG_SEND" ­ FC6à "AG_RECV"
·  · Socket
­ SEND ­ RECV

CPSocket
· 
­ S7 ­ TCP/UDP ­ 
· FC5/FC6
­ FC
· DB
­ 

Socket(1)

Socket(2)

· FC5  STL:   CALL    "AG_SEND"
ACT      :=L20.0 ID        :=1 LADDR  :=W#16#100 SEND    :=P#DB99.DBX0.0   BYTE  38 LEN      :=38 DONE    :=M99.1 ERROR  :=M99.2 STATUS:=MW100

· FC6  STL: CALL    "AG_RECV"
ID        :=1 LADDR  :=W#16#100
RECV    :=P#DB199.DBX0.0   BYTE  1024
NDR      :=M99.3 ERROR  :=M99.4 STATUS:=MW102 LEN      :=DB99.DBW38

Socket(3)

Socket(4)

Socket(5)

Socket(6)
· Black  Hat  USA  2015
­ INTERNET--FACING  PLCS  -- A  NEW  BACK  ORIFICE
· FB65  "TCON" · FB63  "TSEND" · FB64  "TRCV" · S7--300  PLCSocks5 · 

S7  PLC 
RELEASED  EXPLOITS  TOOLS

S7  PLC
·  · 
­ FC  1   ­ SDB  1001
· 
­ M0.0àbit  0000 ­ M0.1àbit  0001 ­ DB1.DBX1~  
· 
­ For  i in  range(000000,001234)


· 
­ Rack ­ Slot
· S7
­ PG ­ OP ­ S7


· S7  Fuzz  Tools
­ Get  Module  info ­ Set  CPU  Run/Stop ­ Fuzz  Set  Value ­ Fuzz  DB  Data ­ Fuzz  Block

S7  Fuzz  Tools  (1)
· 
­ CPU:  6ES7  313--5BG04--0AB0 ­ CP:  6GK7  343--1CX10--0XE0
·  · 
­ Rack:0  Slot:2
· 

S7  Fuzz  Tools  (2)
· 
­ CPU:  6ES7  313--5BG04--0AB0 ­ CP:  6GK7  343--1CX10--0XE0
·  · 
­ Rack:0  Slot:2
· 

MC7Code  Inject(1)
· 
­ CPU:  6ES7  313--5BG04--0AB0 ­ CP:  6GK7  343--1CX10--0XE0
·  ·  · 



· site:
­ plcscan.org

About

