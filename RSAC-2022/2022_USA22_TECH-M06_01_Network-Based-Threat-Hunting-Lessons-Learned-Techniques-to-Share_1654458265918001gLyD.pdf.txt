#RSAC

SESSION ID: TECH-M06
Network Based Threat Hunting: Lessons Learned, Techniques to Share

Tal Darsan
Manager, Managed Cybersecurity Services Cato Networks

Etay Maor
Sr Director Security Strategy Cato Networks

#RSAC
Disclaimer
Presentations are intended for educational purposes only and do not replace independent professional judgment. Statements of fact and opinions expressed are those of the presenters individually and, unless expressly stated to the contrary, are not the opinion or position of RSA Conference LLC or any other cosponsors. RSA Conference does not endorse or approve, and assumes no responsibility for, the content, accuracy or completeness of the information presented. Attendees should note that sessions may be audio- or video-recorded and may be published in various media, including print, audio and video formats without further notice. The presentation template and any media capture are subject to copyright protection.
©2022 RSA Conference LLC or its affiliates. The RSA Conference logo and other trademarks are proprietary. All rights reserved.
2

#RSAC
Agenda & Intro

#RSAC
Agenda
Quick Intro Case Studies
­ Phishing + demo ­ Malware deep dive ­ Ransomware + live demo
Take-aways

#RSAC
The Single Point Of Failure Fallacy

The Attacker Needs To Be Right Just Once, The Defenders Need To Be Right All The Time?

#RSAC

You are here!

So, What Are We Missing?

#RSAC

#RSAC
More Point Solutions Means Better Security (?)

Did We Add Fat Or Muscle?

#RSAC

Click to add text

Why Is This Happening?

#RSAC

#RSAC
Case Study 1
Phishing

Office365 Phishing Attack Chain

Targeted Phishing Attack launched

Attacker compromises Phishing email sent partner's mailbox

FUD in intel. feeds

#RSAC
compromised "OneNote", "ClickUp", and "Glitch" web services
 Submission of data into a potential risky Web forms
 ML models trained on different page elements

#RSAC

#RSAC
Case Study 2
Malware

Houdini Remote Access Trojan (RAT)

VBS based RAT (Remote Access Trojan)

Spreads via USB drive

Receives and executes commands from its C&C server

Fully take over a remote computer

Exfiltrate data over user-agent header

#RSAC

 Periodic traffic to suspicious domains  Device attributes were found in the HTTP user-agent header
<hostname> <username>
Threat dwell-time lasted for days Existing external NGAV didn't detect it

ChaChi Backdoor
Characteristics: · Golang based backdoor, first observed in 2019 · Cross Platform · Stealing device attributes · Data exfiltration via DNS Tunneling/Fallback over HTTP · Dropping PYSA Ransomware

#RSAC

#RSAC
ChaChi Backdoor ­ DNS Tunneling

For attackers, DNS tunneling provides a convenient way to exfiltrate data and to gain access to a network because DNS communications are often unblocked

 DNS record detection heuristics  ML models trained on DNS traffic/Domain squatting

#RSAC
Case Study 3
Ransomware

#RSAC
Ransomware Propagation and Encryption
Characteristics:
· Ransomware typically encrypts files and renames them too, usually by changing their file extension
· Ransomware determines what data to encrypt by iterating through files on local systems and SMB network shares

#RSAC
20

#RSAC
Summary

Combating cyber threats using AI & ML

Jan 1 6:22am

Jan 2 6:22am

Jan 3 Jan 3 6:22am 7:12am

Jan 4 6:22am

Jan 1 2:00pm

Jan 2 Jan 2 Jan 2 3:10pm 4:00pm 10:22pm

Jan 3 10:22pm

Jan 4 8:02pm

Jan 4 9:33pm

IOC Fired

Jan 1 6:22am

Jan 2 6:22am

Jan 3 Jan 3 6:22am 7:12am

Jan 4 6:22am

Jan 1 2:00pm

Jan 2 Jan 2 Jan 2 3:10pm 4:00pm 10:22pm

Jan 3 10:22pm

Jan 4 8:02pm

Jan 4 9:33pm

100TB Daily Raw Flows

#RSAC

Src IP

Application

Rich Flow Context

Dest IP

Protocol

Target

OS

URI

URL

TLS signature

DNS resolving

Client type

User agent

DGA

Port

Request body

HTTP header

Header order

First packet

AI and ML Algorithms

~20 Flows For verification, containment, and communication

#RSAC
Malware Network Activity

To This

#RSAC
You Want To BE Here

#RSAC
It's Only Good As Your Intel

Actionable

Old News

Reliable

Security

False Positives

Just A Feed

Timely

A Converged Solution
Policy
· Bandwidth Management · Quality of Service · Risk-based Access Control · Application Acceleration · Threat Prevention · Data Protection
Context
· Account · Device · Authentication · Identity · Network · Application · Data
Flows
· Branches · Users · Applications · Clouds · Systems · IoT

#RSAC

Native Cloud Solution

Access
· Zero Trust Network Access · Single Sign-On · Multi Factor Authentication · Risk-Based Application Access

Network
· Traffic Shaping · Global Route Optimization · WAN & SaaS Acceleration · Multi-Cloud Networking

Security
· Next Generation Firewall · Secure Web Gateway · Next Generation Anti Malware · Intrusion Prevention System · Cloud Access Security Broker · Data Loss Prevention · Remote Browser Isolation

#RSAC
Apply
· Start looking for those blind spots in your security people, processes and technology · Asses the threats your organization is likely to experience and financial losses · Define a protection strategy that will reduce costs and friction for your clients · Select a seamless omnichannel solution that is based on AI, ML with a combination of customized
heuristics/rules security protections · Continue to assess the ever-changing threat landscape and associated risks

