#RSAC

SESSION ID: HTA-R02
Code Blue! Medical Devices Under Attack

Douglas McKee
Principal Engineer Dir. Vulnerability Research Trellix Threat Labs @fulmetalpackets

Philippe Laulheret
Sr. Security Researcher Trellix Threat Labs @phlaul

#RSAC
Disclaimer
Presentations are intended for educational purposes only and do not replace independent professional judgment. Statements of fact and opinions expressed are those of the presenters individually and, unless expressly stated to the contrary, are not the opinion or position of RSA Conference LLC or any other cosponsors. RSA Conference does not endorse or approve, and assumes no responsibility for, the content, accuracy or completeness of the information presented.
Attendees should note that sessions may be audio- or video-recorded and may be published in various media, including print, audio and video formats without further notice. The presentation template and any media capture are subject to copyright protection.
©2022 RSA Conference LLC or its affiliates. The RSA Conference logo and other trademarks are proprietary. All rights reserved.
Trellix conducts research in accordance with our public Vulnerability Reasonable Disclosure Policy https://www.trellix.com/en-us/threat-center/advanced-threat-research/disclosure.html. Trellix is not responsible in anyway for the third party-products discussed. The information contained in this document is for informational purposes only, does not constitute legal advice, and should not be deemed an offer by Trellix, create obligations for Trellix, or create expectations of future releases. Trellix reserves the right to modify, discontinue, add or subtract features or functionality to its existing products and planned future releases at any time at its sole discretion.
2

#RSAC
Who Are We?

Douglas McKee @fulmetalpackets

Philippe Laulheret @phLaul
3

#RSAC
Today's Connected Medical Space

500K
MEDICAL TECHNOLOGIES AVAILABLE IN THE MARKET PLACE
(DELOITTE)
10B
IOMT DEVICES CONNECTED WORLDWIDE
(IOT-NOW)

15M
IOMT DEVICES OPERATING IN US HOSPITALS
(ZINGBOX)
50B
IOMT DEVICES CONNECTED BY 2028
(DELOITTE)

4

#RSAC
Agenda
What's happening now?
­ Attacks in Healthcare
What's being overlooked?
­ Medical Research Case studies
What's the next threat?
­ A vulnerability's lifespan
How can we be ready?
­ Common pitfalls and mitigations
What can we learn outside of healthcare?
­ Suggested industry wide improvements

#RSAC
Attacks in Healthcare

#RSAC
Underground Market
7

#RSAC
Conti's Perspective
https://therecord.media/conti-leaks-the-panama-papers-of-ransomware
8

#RSAC
Ransomware in the Medical Industry

$61M
RANSOMS PAID 21-MONTHS TIMESPAN
(FBI)
TOP 3
TARGETED SECTOR Q3 2021
(COVEWARE)

>850
ATTACKS ON HOSPITALS JAN-SEPT 21 (NBC)
HIGHEST
COST OF BREACH 11 CONSECUTIVE YEARS
(IBM)

9

Springhill Medical Center
July 16th, 2019

"Tasks that were previously automated, such as recording
vital signs, were suddenly arduous and unfamiliar, particularly for younger nursing staff who had never worked without modern technology, according to two workers at
the time."
--The Wall Street Journal

https://en.wikipedia.org/wiki/Springhill_Medical_Center#/media/File:Springhill_Medical_Center_2018.jpg (CC BY-SA 4.0)

#RSAC
10

#RSAC
University of Vermont Medical Center
October 28th, 2020
"To look someone in the eye, and tell them they cannot have their life-extending or lifesaving treatment, it was horrible, and totally heartwrenching" --Colleen Cargill, Nurse
https://www.nytimes.com/2020/11/26/us/hospital-cyber-attack.html
11

#RSAC
University of Vermont Medical Center
October 28th, 2020
Cancer Care in the Wake of a Cyberattack: How to Prepare and What to Expect https://ascopubs.org/doi/pdf/10.1200/OP.21.00116
12

#RSAC
Ransomware Impact on Healthcare
Difficulties to communicate about the on-going attack:
­ For the staff: mental toll, miscalculation of risk ­ F}Z]vW]lv[}uuv]Wv]v(}uZ}] ­ F}Z]v]]}vW(]o]vP}]v(}uv}W]vo]]o]X
Going back to pre-computerization process during the attack:
­ Junior staff unaware of the old ways ­ Loss of redundancy, safety nets & the recent advances in computerization ­ Increased risk of harm, death.
Weeks to months to recover from the attack.
13

#RSAC
Industry Perspective

Disruption of
communication was at the
heart of the damage induced by the cyberattack and highlighted the
multiple nonredundant ways
used by physicians and staff to provide high-level multidisciplinary
cancer care.

[T]he immediate need for updated standardized processes to
address the host of challenges that we faced with loss of EMR and
communication systems and the
realization that IT cannot be our only solution in the face of a
cyberattack.

Cancer Care in the Wake of a Cyberattack: How to Prepare and What to Expect (JCO Oncology Practice)
https://ascopubs.org/doi/pdf/10.1200/OP.21.00116
14

#RSAC
Other Threats
How to Hack Medical Imaging Applications via DICOM (2020) CT-GAN: Malicious Tampering of 3D Medical Imagery using Deep Learning (Jan 2019) Orangeworm (2015 - 2018?) Triple Extortion (e.g., Vastaamo clinic attack (2020))
15

#RSAC
The Need of Planning against Future Threats
Cyber security is working on preventing Ransomware attacks... ... but threat actors will try to stay a step ahead. Non-standard solutions might become their next target:
­ Custom protocols ­ Embedded devices difficult to integrate to an EDR/XDR ecosystem ­ Legacy systems
Highlight & address threats now to stop attackers in their track!
16

#RSAC
Medical Case Studies
Hacking a Patient Vitals

#RSAC
GE Dash 3000 Patient Monitor
Bedside monitor Monitors patient's vitals ­ Heartrate, Blood pressure, O2 levels, etc Has wired and wireless (optional) networking Contains Personal Identifiable Information (PII) Sends data to a central monitoring station
18

#RSAC
Testing Setup
19

Improved Testing setup

RWHAT Protocol

ECG Simulator

GE Dash 3000

#RSAC
Central Monitoring

20

#RSAC
Observations
UDP Packets Broadcast address Counters Incrementing Ports Unencrypted Identifiable Data
21

#RSAC
Demo Video
22

#RSAC
Impact scenario

· Power of misinformation · Smaller changes, larger impact · Unconscious patient · Reliance on technology · Inside Job?

"Fictitious cardiac rhythms, even intermittent, could lead to extended hospitalization, additional testing, and side effects from medications to control heart rhythm and/or prevent clots. The hospital could also suffer resource
consumption."
--Dr. Shaun Nordeck

23

Arrhythmia Management Guidelines
Amer. Heart assoc. & Amer. College of cardiology
Fictitious intermittent cardiac rhythms
Blood Pressure Normal?
Medications Administered

#RSAC
If monitor was
modified
24

#RSAC
It's critical to understand ALL traffic
25

#RSAC
Medical Case Studies
Overmedicated: Hacking an Infusion Pump

#RSAC
Strategic context
Infusion market
­ 200M IV infusion per year ­ $13.2B US sales in 2020 ­ $54B in sales worldwide
27

#RSAC
Target Device
B. Braun Infusomat Large Volume Pump SpaceStation with SpaceCom Released in 2017
28

#RSAC
System Architecture
29

#RSAC
30

#RSAC
Format string exploitation

#RSAC
... a couple of CVEs later ...
32

#RSAC
We got Root! Are we done yet?
Previous reports: "root access cannot cause patient harm" ...can't it? How do we control the pump's critical OS having root access on SpaceCom?
33

#RSAC

#RSAC
GETTING THE FIRMWARE OUT

#RSAC
...many months of reversing later...

#RSAC
Critical data
Tube sizes
­ ]B PPWu}PZ squeeze
­ W}vP]WuP}}} slow/fast
Can be altered by an attacker from SpaceCom May lead to an overdose
37

#RSAC

#RSAC
"Something as routine as correcting a person's high blood sugar or sodium level too quickly can cause the brain to swell or damage the nerves which can lead to permanent disability or even
death." --Dr. Shaun Nordeck
39

#RSAC
Never trust data from an unverified source!
40

#RSAC
No ransomware, why should I care?

#RSAC
Industry Perspective

"We have an implicit trust in these types of technologies," Tully says.
"We don't ever get any cybersecurity training in medical school. It's not something that ever
comes up in our literature."
--Dr. Jeff Tully

"The ability to manipulate medical equipment in a way that is
potentially harmful to patients, without end-user detection, is effectively weaponizing the device and something only previously conceived by Hollywood yet, Trellix has confirmed it is plausible."

"32% of healthcare leaders admit to never auditing their medical devices." --Sensato

--Dr. Shaun Nordeck

https://www.hpe.com/us/en/insights/articles/medical-device-security-hacking-prevention-measures-1806.html https://www.sensato.co/post/will-recent-iot-medical-device-concerns-make-a-change-in-healthcare-in-2020

42

#RSAC
Vulnerability lifespan in an organization

Source: What Is the Lifespan of a Vulnerability? - Blog | Tenable®

43

Do they exist?
6.9 yrs
Average lifespan of Zero Day
(RAND Corp)
7-10 yrs
Medical device lifecycle
(CyberMDX)

#RSAC
26%
Vulnerabilities found never patched (All industries)
(Tenable)
2,270
Medical Devices near EOL in use per hospital
(CyberMDX)
44

#RSAC
Medical Industry Pitfalls & Solutions
Apply This!

#RSAC
Medical Industry Common Pitfalls

OLDER TECHNOLOGY

EXPENSIVE PATCHING

EXCESSIVE TRUST
46

#RSAC
How to Overcome these Hurdles? (Medical IoT Vendors)
Use secure coding practices and modernize existing architecture
­ Authentication ­ Encryption of DaR/DiM ­ Security Audits
Embrace security researchers providing deep vuln research Improve "patchability" of the devices
­ Zero-patch ­ Virtual-patch
47

#RSAC
How to Overcome these Hurdles? (Medical Organizations) Network Segmentation and Monitoring (risk mitigation/minimization) Follow vendor and FDA/CISA guidelines Maintain constant awareness of potentials threats
48

#RSAC
What US institutions recommend to Healthcare
CISA's ransomware Best Practices
­ Read and follow the advices p18-19
­ https://www.cisa.gov/uscert/sites/default/files/publications/AA20302A_Ransomware%20_Activity_Targeting_the_Healthcare_and_Public_Health_Sector.pdf
FDA recommendations
­ Read the whitepapers/playbooks/guidance that apply to your situation
­ https://www.fda.gov/medical-devices/digital-health-center-excellence/cybersecurity
Keep a pulse on HC3 Threats briefs
­ https://www.hhs.gov/about/agencies/asa/ocio/hc3/products/index.html#threat-briefs
49

#RSAC
Beyond Healthcare
Apply This!

#RSAC
How Does It Matter Beyond Healthcare?

TECH STACK BLINDSPOT

UNITENDED FEATURES

CUSTOMER IMPACT
51

#RSAC
Actionable Items for You!

IDENTIFY
TODAY TODAY

AUGMENT

EMBRACE

3 MONTHS 3 MONTHS

6 MONTHS 6 MONTHS

REVIEW & REPEAT
1 YEAR 1 YEAR

52

#RSAC
Actionable Items for You!
Identify key shareholders in your organization responsible for mitigation & recovery plan Augment this plan with an analysis of potential blind spots within legacy systems. Embrace offensive security testing in all forms Review and feed results to the shareholders and act upon it. Rinse &Repeat
53

#RSAC
Summary
Ransomware can hit hard if you're not ready... ...and less obvious vectors can still get you when you are. A patch is meaningless if it is too hard/costly for your customers to deploy. EMERGENT PROPERTIES Think RED / Act BLUE
54

