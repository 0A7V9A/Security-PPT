#RSAC

SESSION ID: CSCS-T02
Security Industry Call-to-Action: We Need a Cloud Vulnerability Database

Ami Luttwak
CTO & CO-FOUNDER WIZ @amiluttwak

John Yeoh
EVP, Global Research CSA @YoTheShow

Pete Chronis
SVP, CISO Paramount (ViacomCBS) @chronis

#RSAC
Disclaimer
Presentations are intended for educational purposes only and do not replace independent professional judgment. Statements of fact and opinions expressed are those of the presenters individually and, unless expressly stated to the contrary, are not the opinion or position of RSA Conference LLC or any other cosponsors. RSA Conference does not endorse or approve, and assumes no responsibility for, the content, accuracy or completeness of the information presented. Attendees should note that sessions may be audio- or video-recorded and may be published in various media, including print, audio and video formats without further notice. The presentation template and any media capture are subject to copyright protection.
©2022 RSA Conference LLC or its affiliates. The RSA Conference logo and other trademarks are proprietary. All rights reserved.
2

#RSAC
Outline
· Vulnerabilities in the pre-cloud era · A new type of cloud vulnerabilities · Examples / Use cases 2 · Solution proposal 3 · What can we do as a community to solve the cloud
vulnerabilities issue?
4
5

Who are we?
Ami Luttwak
CTO & CO-FOUNDER WIZ

John Yeoh
Global VP, Research Cloud Security Alliance

Wiz Research: Breaking the cloud
· Experienced cloud researchers · Identified the most influential
cloud vulnerabilities in recent months : #CHAOSDB, #OMIGOD, #ExtraReplica

Recent Publications

#RSAC
Pete Chronis
SVP, CISO Paramount (ViacomCBS)

#RSAC

#RSAC
Introduction: A day in a CISO's life
· How do you ensure your organization is protected from software vulnerabilities?
· How do you ensure your organization is protected from cloud vulnerabilities?

#RSAC
Introduction: Security in the pre-cloud era
Users are fully responsible for their security:
· Hardware · Network · Servers · Identities · And everything else...

Introduction: Security in the cloud
Cloud vendors: · Physical Security · Servers · Network · Hardware · Managed Services · Storage

#RSAC
Cloud users: · Application (CVEs) · Configuration · Identities · Data

Introduction: the Shared Responsibility Model

Cloud vendors

Physical Security

Network Hardware Managed Services

Cloud users
Configuration Application Identities Data

#RSAC

#RSAC
The Problem: Cloud vulnerabilities are different
· New types of vulnerabilities: (not software) - Configuration vulnerabilities - Identity vulnerabilities
· Software owned by the cloud provider - No software version - No defined patching process
· Complex remediation steps

#RSAC
Cracks in the Shared Responsibility Model

Cloud vendors

New cloud issues

Cloud users

Physical Security

Network Hardware Managed Services

Configuration Application Identities Data

#RSAC
Example #1: Vulnerable Configuration
The issue
· Multiple AWS services found vulnerable · Read/Write to cross-tenant resources · Default access policies were vulnerable
Serverless Repo AWS CloudTrail
AWS Config AWS Guard Duty

#RSAC
Example #1: Vulnerable Configuration
The issue

{ "Effect": "Allow",

CCliclikcktotoaaddddtetextxt

"Principal": {"Service": "serverlessrepo.amazonaws.com"},

"Action": "s3:GetObject",

"Resource": "arn:aws:s3:::bucketname/*"

}

#RSAC
Mitigations:
Cloud Provider Remediation
· AWS added scoping conditions to their policies · Updated the documentation
But what about vulnerable customers? · Alerted vulnerable customers via email · Alerted vulnerable customers on the AWS Personal
Health Dashboard

#RSAC
Mitigations:
Vulnerable AWS Configurations

#RSAC
Example #1: Vulnerable Configuration
Users own the remediation

· 90% of orgs were still vulnerable 5 months after the notification

· AWS cannot update users' policies

· Users must do it themselves

Serverless Repo

AWS CloudTrail

AWS Config

AWS Guard Duty

#RSAC
Takeaways
Breaking the isolation: cross-account AWS vulnerabilities
· No standard notification channel · No identification of the issue · No tracking system · No Severity scoring · Mitigating cloud vulnerabilities process does not
exist! · The result: Most cloud user are still vulnerable!

#RSAC
Example #2: Cloud middleware
The issue
· OMI is a cloud middleware used by many Azure services · Silently installed on customers virtual machines! · Wiz found 4 vulnerabilities in OMI (dubbed OMIGOD) enabling a remote
attacker to execute code with root privileges · Thousands of customer are at risk

#RSAC
Example #2: Cloud middleware
CSP Remediation
· Microsoft published it on September `21 Patch Tuesday · 1 Remote Code Execution, 3 Local Privilege Escalation · Critical/High severity · Provided guidance to customers on updating the agent · Customers should apply the patch themselves, even though they are not
aware of it.

#RSAC
Example #2: Cloud middleware
CSP Remediation
· Microsoft published it on September `21 Patch Tuesday · 1 Remote Code Execution, 3 Local Privilege Escalation · Critical/High severity · Provided guidance to customers on updating the agent · Customers should apply the patch themselves, even though they are not
aware of it.

#RSAC
Example #2: Cloud middleware
CSP remediation gaps
· The software vulnerability impacted multiple services LogAnalytics, Azure Automation, Azure Sentinel..
· Insufficient notification : The CVE was issued for OMI, customers are not aware of OMI (undocumented)

#RSAC
Key Takeaways:
OMIGOD! Multiple Vulnerabilities In Azure's OMI Agent
· Vulnerabilities can be found in pre-installed middleware · No identification -It's not only a software vulnerability; multiple
Azure services were affected · Lack of transparency- customers didnt know which Azure
services use the agent · No tracking system · No remediation ­ Microsoft shared details on the affected
Azure services remediation 2 days after Patch Tuesday

#RSAC
Example #3: Key Leak The issue
· On August 2021, unprecedented cloud cross-account vulnerability in Azure Cosmos DB
· Access keys were leaked, and risked thousands of customers

#RSAC
Example #3: Key Leak
CSP Remediation
· Access keys must be regenerated by Cosmos DB customers · Microsoft emailed selected customers and later published a blog post · The service vulnerability timeframe isn't clear

#RSAC
Key Takeaways:
ChaosDB : Cross-account vulnerability in Azure Cosmos DB
· Vulnerability fix can be both CSP and customer responsibility · No identification ­No unique id to the issue · No tracking system ­ notification was sent only in mail · Lack of transparency - Microsoft didn't plan to publish its blog,
vulnerability timeframe is missing

#RSAC
Summary
The Shared Responsibility Model is broken
· No standard notification channel · Issues cannot be tracked easily · No severity scoring ­ how should we prioritize? · Lack of transparency

#RSAC
Conclusions
· Vulnerabilities are not only in code / software We lack for cloud vulnerabilities: · Identification · Tracking system · Transparency · Severity Standardization · Remediation steps

#RSAC
Reporting & enumeration for Cloud Vulnerabilities
What's missing?
· Centralized database · Public, used by cloud users and security vendors · Vulnerabilities should be reported by cloud service providers

#RSAC
Example ChaosDB:
Identification
· Identifier: Cloud Vulnerability 2021-1337

#RSAC

Example ChaosDB:
Severity

· Identifier: Cloud Vulnerability 2021-1337

· Severity: Critical

Click to add text

#RSAC
Example ChaosDB:
Transparency
· Identifier: Cloud Vulnerability 2021-1337 · Severity: Critical · Product/Platform: Azure Cosmos DB · Time affected: 02/01/2021 ­ 08/12/2021 · Risk: The vulnerability could allow a user to gain access to another
customer's resources by using the account's primary read-write key

#RSAC
Example ChaosDB:
Remediation
· Identifier: Cloud Vulnerability 2021-1337 · Product/Platform: Azure Cosmos DB · Severity: Critical · Time affected: 02/01/2021 ­ 08/12/2021 · Risk: The vulnerability could allow a user to gain access to another customer's
resources by using the account's primary read-write key · Required Action: Regenerate the primary read-write key for each of the
impacted Azure Cosmos DB

#RSAC
Example ChaosDB:
Tracking
· Identifier: Cloud Vulnerability 2021-1337
· Product/Platform: Azure Cosmos DB
· Severity: Critical
· Time affected: 02/01/2021 ­ 08/12/2021
· Risk: The vulnerability could allow a user to gain access to another customer's resources by using the account's primary read-write key
· Required Action: Regenerate the primary read-write key for each of the impacted Azure Cosmos DB
· Detection: See attached Rego rule

#RSAC
Example ChaosDB:

#RSAC
Auditing Your Environment with the New Cloud Database

#RSAC
Tracking Vulnerabilities
History and evolution
· Bug hunting in mailing lists to CVE and CERT ­ pre-1999 · OSV, NVD, and other vendor platforms ­ a lot more today

#RSAC
Technology
Continues to grown and evolve faster than vulnerability identification
· The use of Cloud · The use of 3rd party services · Build vs. Buy is being challenged · Outpacing how we identify · Difficult to disclose · Too much is unseen

#RSAC
Keeping Pace
Current limitations
· CVE identification trends

#RSAC
What is Needed
· Speed to identify, protect, recover · Automate and consolidate
· Inclusivity for today's IT · IT environment - software, hardware,
services (cloud), configurations, documentation
· Customer and third-party owned · IT stakeholders - researchers,
providers, customers, authorities, etc.
· Examples · Where are the vulnerabilities · Areas of impact · Mitigate and remediate

#RSAC
A day in CISO's life
and now with the Cloud Vulneraility DB
· How would a new CISO day look like:
Click to add text

#RSAC
A day in CISO's life
and now with the Cloud Vulneraility DB
· Unified Risk Management View
Click to add text

#RSAC
What's next?

#RSAC
Solutions
· Community-driven · Inclusive of all stakeholders · Community over committee
· Database · Built for speed; automation,
community-driven
· Centralized and inclusive · Template for all existing identifiers; CVE, NVD, CWE, vendors
· Discoverable · Scrape the internet; social

#RSAC
CSA Initiative: Global Security Database

#RSAC
Global Security Database
globalsecuritydatabase.org
· Open Source · Community, not committee · Common place, multiple
viewpoints · Machine-first, automation · Using existing formats where
possible · Ingest other databases

#RSAC
Cloud CVE Database: Our community
· A group of people that want to create a better future for all cloud users and providers
· 130+ members · From different companies, including Fortune500 · 12 different time zones · Diverse backgrounds as finance, security, data, compliance · Join us: bit.ly/cloudVuln

#RSAC
A new DB to centralize all cloud security issues
· A central location for all cloud security issues from all CSPs
· Moderated by the community

#RSAC
Other community projects & partners
· The Cloud Security Notification Framework (CSNF) · MITRE's CVE

#RSAC
How can we make the change happen?
· Industry action - call the CSPs to provide for each new cloud vulnerability:
· Identification · Tracking system · Transparency · Severity Standardization · Remediation steps

#RSAC
Call for action:
The shared responsibility model is broken
The power is in your hands!

#RSAC
Thank you

Read more on: https://globalsecuritydatabase.org/
wiz.io/blog

Join our slack group:
bit.ly/cloud Vuln

Follow us
@amiluttwakK @chronis
@yotheshow

