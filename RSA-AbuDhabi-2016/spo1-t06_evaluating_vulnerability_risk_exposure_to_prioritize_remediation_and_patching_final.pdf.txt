SESSION ID: SPO1-T06
Evaluating Vulnerability Risk Exposure to Prioritize Remediation and Patching in Heterogeneous Environments
#RSAC

Hadi Jaafarawi
Managing Director Qualys Middle East @hjaafarawi

#RSAC
Constant stream of vulnerability disclosures
... plug into the fire hose of external vulnerability disclosures, so you're aware of the latest threats out in the wild.
2

#RSAC
Vulnerabilities: Year Over Year

8,000 7,000 6,000 5,000 4,000 3,000 2,000 1,000
0

4,150
2011

5,288

5,186

2012

2013
3

7,937
2014

6,488
2015

#RSAC
Notice, React, Remediate
Where do I start?
4

Exploit vs Vulnerabilities

8000 6000 4000 2000
0

Exploits Vulnerabilities
5

#RSAC
Only 7% of Vulnerabilities had Exploits

#RSAC
Exploit Kits
http://www.microsoft.com/security/portal/mmpc/threat/exploits.aspx
6

#RSAC
Exploit Kits
7

#RSAC
Exploit Kit Examples
8

#RSAC
Vulnerabilities With Exploit Kit

CVE CVE-2015-0313 CVE-2015-0311 CVE-2015-2419 CVE-2015-0312 CVE-2015-0359 CVE-2015-0310 CVE-2015-0336 CVE-2015-5560 CVE-2015-2426 CVE-2015-5122 CVE-2015-5119 CVE-2015-1671 CVE-2015-3113
CVE-2015-3104/5
CVE-2015-3090 CVE-2015-0336

VULNERABILITY Adobe Flash Player RCE Vulnerability (APSB15-04) Adobe Flash Player RCE Vulnerability (APSB15-03) Microsoft Internet Explorer Security Update (MS15-065) Adobe Flash Player RCE Vulnerability (APSB15-03) Adobe Flash Player Multiple RCE Vulnerabilities (APSB15-06) Adobe Flash Player Security Update (APSB15-02) Adobe Flash Player RCE Vulnerability (APSB15-05) Adobe Flash Player and AIR Multiple Vulnerabilities (APSB15-19)
Microsoft Font Driver RCE Vulnerability (MS15-078) Adobe Flash Player Multiple Vulnerabilities (APSB15-18) Adobe Flash Player Multiple Vulnerabilities (APSA15-03,B15-16) Microsoft Font Drivers RCE Vulnerabilities (MS15-044) Adobe Flash Player Buffer Overflow Vulnerability (APSB15-14)
Adobe Flash Player and AIR Multiple Vulnerabilities (APSB15-11)
Adobe Flash Player and AIR Multiple Vulnerabilities (APSB15-09) Adobe Flash Player RCE Vulnerability (APSB15-05)

9

EXPLOIT KIT Hanjuan, Angler, SweetOrange, Rig, Fiesta, Nuclear, Nutrino, Angler RIG,Nuclear Pack, Neutrino, Hunter,Angler Magniture, Angler Fiesta,Angler, Nuclear, Neutrino, Rig, Magnitude Angler Angler Nuclear Pack Magnitude Hacking Team, Nutrino, Angler, Magnitude, Nuclear Neutrino, Angler, Magnitude, Hanjuan, NullHole Angler Magnitude, Angler, Rig, Neutrino
Magnitude, Angler, Nuclear
Angler, Nuclear, Rig, Magnitude Nuclear,Angler, Neutrino, Magnitude

Exploit Kits vs. Vulnerabilities

8000 6000 4000 2000
0

ExploitKits Exploits Vulnerabilities

10

#RSAC
Only 1% of Vulnerabilities are supported by Exploit Kits

#RSAC
Exploit Trends 2015 - 2016

Most Affected Vendors

Microsoft 21% Adobe 20%

#RSAC

microsoft joomla elasticsearch symantec cmsjunkie metalgenix web-dorado akronymmanager_project betster_project cs-cart elegant_themes h5ai_project kcodes milw0rm_project palosanto

adobe pixabay_images_project fortinet wpml dell novius-os x2engine apache bisonware cups endian_firewall horde libmimedir_project moodle pcman%27s_ftp_server_project

apple redhat foxitsoftware ajsquare emc refbase xceedium arubanetworks boxautomation cybernetikz ericsson hp linux npds persistent_systems

Apple 3% Oracle 2%

oracle ansible igniterealtime apport_project etouch samsung yuba atlassian centreon e107 feedwordpress_project insanevisions maarch ntop pfsense

ferretcms_project citrix jakweb apptha f5 sefrengo zohocorp auto-exchanger clip-bucket easy2map_project fork-cms ipass magic_hills nvidia photocati_media

goautodial debian mozilla bitrix genixcms simple_ads_manager_project accunetix avinu cloudbees ecommercemajor_project freereprintables isc manageengine oxwall php

google d-link novell cisco magmi thecartpress adb beehive_forum crea8social ektron gsm job_manager mcafee palo_alto_networks phpmybackuppro

12

#RSAC
Applications vs Operating Systems
Applications 3x more frequent
26% 74%
Operating System Applications
13

#RSAC
Remote vs Local Exploits
80% can be compromised Remotely
20%
80%
Remote Local 14

#RSAC
Remote vs Local Exploits

REMOTE CVE-2015-0349: Adobe Flash Player APSB15-06 Multiple Remote Code Execution Vulnerabilities

LOCAL CVE-2015-2789: Foxit Reader CVE-2015-2789 Local Privilege Escalation Vulnerability

CVE-2015-2545: Microsoft Office CVE-2015-2545 Remote Code Execution Vulnerability

CVE-2015-2219: Lenovo System Update 'SUService.exe' CVE-2015-2219 Local Privilege Escalation

CVE-2015-0014: Microsoft Windows CVE-2015-0014 Telnet Service Buffer Overflow Vulnerability CVE-2015-0002: Microsoft Windows CVE-2015-0002 Local Privilege Escalation Vulnerability

CVE-2015-1635: Microsoft Windows HTTP Protocol Stack CVE-2015-1635 Remote Code Execution CVE-2015-0003: Microsoft Windows Kernel 'Win32k.sys' CVE-2015-0003 Local Privilege Escalation

CVE-2015-0273: PHP CVE-2015-0273 Use After Free Remote Code Execution Vulnerability

CVE-2015-1515: SoftSphere DefenseWall Personal Firewall 'dwall.sys' Local Privilege Escalation

CVE-2015-5477: ISC BIND CVE-2015-5477 Remote Denial of Service Vulnerability CVE-2015-2590: Oracle Java SE CVE-2015-2590 Remote Security Vulnerability CVE-2015-2350: MikroTik RouterOS Cross Site Request Forgery Vulnerability CVE-2015-0802: Mozilla Firefox CVE-2015-0802 Security Bypass Vulnerability CVE-2015-1487: Symantec Endpoint Protection Manager CVE-2015-1487 Arbitrary File Write

CVE-2015-1328: Ubuntu Linux CVE-2015-1328 Local Privilege Escalation Vulnerability
CVE-2015-1701: Microsoft Windows CVE-2015-1701 Local Privilege Escalation Vulnerability
CVE-2015-3246: libuser CVE-2015-3246 Local Privilege Escalation Vulnerability
CVE-2015-1724: Microsoft Windows Kernel Use After Free CVE-2015-1724 Local Privilege Escalation Vulnerability CVE-2015-2360: Microsoft Windows Kernel 'Win32k.sys' CVE-2015-2360 Local Privilege Escalation

CVE-2015-4455: WordPress Aviary Image Editor Add-on For Gravity Forms Plugin Arbitrary File

CVE-2015-5737: FortiClient CVE-2015-5737 Multiple Local Information Disclosure Vulnerabilities

15

#RSAC
Remote vs Local Exploits

Remotely Exploitable

Requires Local Access

200 180 160 140 120 100
80 60 40 20
0 Microsoft

Adobe

Apple

Others

50 45 40 35 30 25 20 15 10
5 0
Microsoft

Adobe

Apple

Others

16

#RSAC
Lateral Movement
http://about-threats.trendmicro.com/cloud-content/us/ent-primers/pdf/tlp_lateral_movement.pdf
17

#RSAC
Lateral Movement

HIGH LATERAL MOVEMENT
CVE-2015-0117: IBM Domino CVE-2015-0117 Arbitrary Code Execution Vulnerability
CVE-2015-2545: Microsoft Office CVE-2015-2545 Remote Code Execution Vulnerability
CVE-2015-1635: Microsoft Windows HTTP Protocol Stack CVE-2015-1635 Remote Code Execution Vulnerability
CVE-2015-2590: Oracle Java SE CVE-2015-2590 Remote Security Vulnerability
CVE-2015-0240: Samba 'TALLOC_FREE()' Function Remote Code Execution Vulnerability
CVE-2015-2342: VMware vCenter Server CVE-2015-2342 Remote Code Execution Vulnerability
CVE-2015-2219: Lenovo System Update 'SUService.exe' CVE2015-2219 Local Privilege Escalation Vulnerability

LOW LATERAL MOVEMENT
CVE-2015-1155: Apple Safari CVE-2015-1155 Information Disclosure Vulnerability
CVE-2015-5737: FortiClient CVE-2015-5737 Multiple Local Information Disclosure Vulnerabilities
CVE-2015-1830: Apache ActiveMQ CVE-2015-1830 Directory Traversal Vulnerability
CVE-2015-1427: Elasticsearch Groovy Scripting Engine Sandbox Security Bypass Vulnerability
CVE-2015-1479: ManageEngine ServiceDesk Plus 'CreateReportTable.jsp' SQL Injection Vulnerability
CVE-2015-1592: Movable Type CVE-2015-1592 Unspecified Local File Include Vulnerability
CVE-2015-2560: ManageEngine Desktop Central CVE-20152560 Password Reset Security Bypass Vulnerability

18

Almost ½ of Vulnerabilities had High Lateral

#RSAC

Movement

Examples:
CVE-2015-0117

Remote + High Lateral Movement
IBM Domino CVE-2015-0117 Arbitrary Code Execution Vulnerability

CVE-2015-2545 Microsoft Office CVE-2015-2545 Remote Code Execution Vulnerability

CVE-2015-1635 CVE-2015-2426 CVE-2015-2590

Microsoft Windows HTTP Protocol Stack CVE-2015-1635 Remote Code Execution Vulnerability
Microsoft Windows OpenType Font Driver CVE-2015-2426 Remote Code Execution Vulnerability
Oracle Java SE CVE-2015-2590 Remote Security Vulnerability

19

#RSAC
Exploits of EOL Applications
20

5 Key Elements for Successfully

#RSAC

Prioritizing Vulnerability Remediation

A comprehensive and continuously updated view of all your IT assets.
Knowledge of the constant stream of vulnerability disclosures.
The ability to correlate external threat information with your vulnerability gaps.
Dashboard tools to visualize your threat landscape.
Precise assessments of your organization's threat scenarios.

21

#RSAC
Applying Exploit Knowledge
Next Week: Create inventory of:
Applications with weaponized Exploit pack. EOL Applications and EOL Operating Systems. Vulnerabilities with working exploits. Vulnerabilities that can be remotely compromised.
22

#RSAC
Applying Exploit Knowledge
Next Month:
Upgrade EOL applications. Patching all vulnerabilities with Exploit packs and exploits.
23

#RSAC
Applying Exploit Knowledge
Next Quarter:
Automatic inventory and alerting. Debate if most exploited applications, like Flash, are required for business.
24

#RSAC
Thank you
hjaafarawi@qualys.com

