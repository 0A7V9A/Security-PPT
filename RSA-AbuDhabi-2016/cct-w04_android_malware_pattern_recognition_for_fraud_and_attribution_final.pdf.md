SESSION ID: CCT-W04
Android Malware Pattern Recognition for Fraud and Attribution
#RSAC

Nikos Tsouroulas
Head of Cybersecurity Telefonica 11Paths nikolaos.tsouroulas@telefonica.com
Ahmed Alketbi
Senior Manager Security Solutions Marketing Etisalat

#RSAC
Index
Introducing Mobile App Singularities Case Study 1: Who is behind FOBUS aka "PODEC"? Case Study 2: SHUABANG. How we discovered one of the most ingenious ways of fooling Google Play. Conclusions
2

Some thoughts...
"83 % of the top 400 Mobile android Apps come from few unique developers"

#RSAC
The same applies for malware

Android App Developers, Leaders Matrix

#RSAC
Some thoughts...
The entire ecosystem is potentially insecure even by using "trusted" markets
Malware slips through, it is imposible to review in all the
detail req"uTirReUd SalTl t"heisanppost a security control
Cyber criminals find ways to trick the controls (i.e. Gremlin aps)

#RSAC
Android Malware is coming...

#RSAC
Is Google Play (un)safe?

Android and Google Play, they do indeed have great security measures and are getting better.
But what if... malware (ok, PHA) do not need to break them?
· Adware · RATs · Trojans · mRansomware ·...

...all with a significant install rate. At least enough to keep production... why would attackers invest time in creating them otherwise?

#RSAC
Big Data, intelligence & malware
With almost 1.5M apps in each Google Play and App Store, with 2-3k new apps every day, traditional approaches are condemned to always be one step behind the attackers.
Modern Cybersecurity is about leveraging Big Data Analytics & Intelligence to become proactive.
Can we apply similar techniques in order to change the pace in mobile app security?

App Singularities for mobile malware

#RSAC

detection and analysis

Creating malware professionally is very demanding.
Attackers repeat patterns and make mistakes like any other SW developers, thus introducing Singularities.
Having tools to easily crawl for such Singularities at the moment of submission and at scale greatly enhances detection and attribution capabilities.

Apps with more votes than downloads

#RSAC
Attribution: Who is behind FOBUS aka "PODEC"?
CASE Study 1

#RSAC
Knowing the enemy
Fobus (aka "podec") is a very hard to uninstall malware. It spies on the phone and is able to make calls, steal data, etc. And it is incredibly hard to remove.
We started the analysis with a sample, shown in blog of Avast.

#RSAC
Narrowing the scope - reusing files
Files inside the original APK are reused among malicious apps: x.app & notification.png seems to be very uncommon.

#RSAC
Narrowing the scope - Analyzing permissions
Comparing both apps, they have a lot of permissions (basically full control of the device) and exactly the same.

#RSAC
Narrowing the scope - Dates & digital certificate
· Same update, uploaded and signing dates  Singularity
· Different developers and digital certificates
· We already have a name `Yan Datsuk' and a company `Fuzzle Pun'
· Both apps are in Russian · A deeper analysis confirms
that both apps are Fobus.

HUMINT ­ Profiling the bad guy
· Location · Company profile (VK) · Personal profile (VK, Facebook, Google+) · Professional profile (LinkedIn) · HackerOne profile · Email · Relationship between company & developer

#RSAC

#RSAC
SHUABANG: How we discovered one of the most ingenious ways of fooling Google Play
CASE 2

#RSAC
Black ASO {App Store Optimization}
Black App Store Optimization
Positioning apps in markets Spam Download rate Reviews
Goal
Build up an automated infrastructure Infrastructure for sale to third parties To extend the botnet

#RSAC
What is Shuabang?
Shuabang is a technique, quite common in China. It is the BlackHat App Store Optimization.
There are companies that charge you to "rise up" your app in stores, voting them, or adding fake downloads.
To get that in Google Play, they need registered users in Google Play, that means, basically, Gmail accounts (users and passwords) associated with a telephone (a real deviceID). How to get them?
You can buy them. You can create them. You can steal them. Or you can create your own botnet...

Botnet scheme

#RSAC
1. The attacker recovers a Google Security Token and links it to a fake Google user account and a specific device.
2. From the malware app the Google check-in process is done using that token
3. If the token is valid, the attacker provides a user name and a password to the malware app
4. From the malware app on the device, credentials and device config are uploaded.
5. If the credentials are valid, Google Play returns a new Security token as a response.
6. With this new token, the malware app is able to execute several tasks and actions, ordered by the attacker in the background

#RSAC
We found something that looked very suspicious...
We were looking for Wallpapers that connected to PHP sites (title:*wallpaper* links:*.php permissionName:*ACCOUNT* permissionName:*BOOT*). That simple. And we found this...

#RSAC
Stolen users

#RSAC
Shuaban Botnet: Control Panel

#RSAC
And this is what it was...

#RSAC
Singularity, Let's find more apps like this
These applications had several points in common that could be used as the developer's "fingerprint". The apps were created with Java version 1.8.0_05 (Oracle Corporation). The certificates, although different, were valid for 271 years. certificateSubjectCommonNameis normally formed by a combination of several words. Images were also useful to find similar applications. For example, if a search was made for similar images, a different developer may be found: yu jinhui.
And finally we found this in common:
http://apptools.myappblog.net/selfpush/selfpush/gameframe/www/test/getcontent.php (links:*myappblog*) The number of different developers took a huge bump.
shengzls, feng wenjie, tong ronghai, shui hongli, yan dongba, tang xiaocan, wan lichun, jie libao, wen xiaojian, yuan junrong, wen xiaojian...

#RSAC
Finally it got baptized...

#RSAC
Shuabang Botnet: Facts

Stolen 12.567
Google accounts

Expert understanding of internals (unpublished) of the
device registration system with.

100 malicious apps available in Google Play

Permissions apparently harmless

Complex tasking system managed effectively

Fraud-per-click managed in a smart way

Resources usage without using Google original account in the
infected device

Building up a development framework

#RSAC
Conclusions

#RSAC
How high where those groups in the food chain?

Yan Datsyuk - Fobus-

Shuabang

#RSAC
What should we do about all this?

Mobile apps are pervasive in our digital world. They represent a huge opportunity for criminal activity and they are already being exploited by criminal organizations.
Official ecosystems to distribute apps have helped to increase security but have been demonstrated to not be totally failsafe.
Don't use unofficial stores unless you know what you are doing.

Do not implicitly trust mobile apps.

Employ both traditional signature-based

Depending on your security requirements techniques and complement with Big-Data

the risk by not be acceptable.

Analytics

Apply adequate policies through MDM solutions.
Consider anti-malware solutions.

Leverage singularities to hunt down malware as soon as they appear on the app store. We don't have to wait for them to be installed and do harm

Monitor your own apps. Educate your employees.

Combine this with OSINT source to huntdown the authors, contact the appropriate LEA

28

#RSAC
Thank you

